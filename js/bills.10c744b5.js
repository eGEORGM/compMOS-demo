(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{300:function(e,t,i){var a=i(18),n=i(318);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},301:function(e,t,i){var a=i(18),n=i(320);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},302:function(e,t,i){var a=i(18),n=i(322);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},303:function(e,t,i){var a=i(18),n=i(324);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},304:function(e,t,i){var a=i(18),n=i(326);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},305:function(e,t,i){var a=i(18),n=i(328);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},307:function(e,t,i){var a=i(18),n=i(330);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},308:function(e,t,i){var a=i(18),n=i(332);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},312:function(e,t,i){var a=i(18),n=i(340);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);e.exports=n.locals||{}},317:function(e,t,i){"use strict";i(300)},318:function(e,t,i){(t=i(19)(!1)).push([e.i,".bill-list-page[data-v-2ff261ab] {\n  padding: 24px;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n.bill-list-page .page-header[data-v-2ff261ab] {\n  background: #ffffff;\n  padding: 24px 32px;\n  border-radius: 4px;\n  margin-bottom: 16px;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.08);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.bill-list-page .page-header .page-title[data-v-2ff261ab] {\n  font-size: 24px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.bill-list-page .page-header .company-info[data-v-2ff261ab] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 14px;\n}\n.bill-list-page .page-header .company-info .company-name[data-v-2ff261ab] {\n  color: #303133;\n  font-weight: 500;\n}\n.bill-list-page .page-header .company-info .company-divider[data-v-2ff261ab] {\n  color: #c0c4cc;\n}\n.bill-list-page .page-header .company-info .company-id[data-v-2ff261ab] {\n  color: #909399;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] {\n  margin-bottom: 16px;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] .el-card__body {\n  padding: 16px 24px;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] .el-form-item {\n  margin-bottom: 0;\n  margin-right: 16px;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] .el-date-editor {\n  width: 240px;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] .el-select {\n  width: 150px;\n}\n.bill-list-page .filter-card[data-v-2ff261ab] .el-input {\n  width: 200px;\n}\n.bill-list-page .table-card[data-v-2ff261ab] .el-card__body {\n  padding: 24px;\n}\n.bill-list-page .table-card .table-header[data-v-2ff261ab] {\n  margin-bottom: 16px;\n}\n.bill-list-page .table-card .table-header .result-info[data-v-2ff261ab] {\n  font-size: 14px;\n  color: #909399;\n}\n.bill-list-page .table-card .table-header .result-info .highlight[data-v-2ff261ab] {\n  color: #2555FF;\n  font-weight: 600;\n  font-size: 16px;\n}\n.bill-list-page .table-card .bill-table[data-v-2ff261ab] .el-table__row {\n  cursor: pointer;\n}\n.bill-list-page .table-card .bill-table[data-v-2ff261ab] .el-table__row:hover {\n  background-color: #f5f7fa;\n}\n.bill-list-page .table-card .bill-table .amount-text[data-v-2ff261ab] {\n  font-weight: 500;\n  color: #303133;\n}\n.bill-list-page .table-card .bill-table[data-v-2ff261ab] .el-button--text {\n  font-size: 14px;\n  font-weight: normal;\n}\n.bill-list-page .table-card .empty-state[data-v-2ff261ab] {\n  text-align: center;\n  padding: 48px 0;\n}\n.bill-list-page .table-card .empty-state i[data-v-2ff261ab] {\n  font-size: 64px;\n  color: #c0c4cc;\n  margin-bottom: 24px;\n}\n.bill-list-page .table-card .empty-state p[data-v-2ff261ab] {\n  font-size: 16px;\n  color: #909399;\n  margin: 8px 0;\n}\n.bill-list-page .table-card .empty-state p.empty-hint[data-v-2ff261ab] {\n  font-size: 14px;\n  color: #c0c4cc;\n}\n.bill-list-page .table-card .pagination-wrapper[data-v-2ff261ab] {\n  margin-top: 24px;\n  display: flex;\n  justify-content: flex-end;\n}\n",""]),e.exports=t},319:function(e,t,i){"use strict";i(301)},320:function(e,t,i){(t=i(19)(!1)).push([e.i,".detail-settings-content .settings-description[data-v-4b8d54f2] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #909399;\n  font-size: 13px;\n}\n.detail-settings-content .settings-description i[data-v-4b8d54f2] {\n  color: #2555FF;\n  font-size: 16px;\n}\n.detail-settings-content .settings-form[data-v-4b8d54f2] {\n  margin-bottom: 24px;\n}\n.detail-settings-content .settings-form .form-hint[data-v-4b8d54f2] {\n  color: #c0c4cc;\n  font-size: 13px;\n  margin-top: 4px;\n}\n.detail-settings-content .settings-form .dimension-order[data-v-4b8d54f2] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  min-height: 32px;\n  align-items: center;\n}\n.detail-settings-content .settings-form .dimension-order .el-tag[data-v-4b8d54f2] {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n.detail-settings-content .settings-form .dimension-order .el-tag .order-number[data-v-4b8d54f2] {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  background: #2555FF;\n  color: #ffffff;\n  border-radius: 50%;\n  font-size: 13px;\n  margin-left: 4px;\n}\n.detail-settings-content .settings-form .dimension-order .empty-hint[data-v-4b8d54f2] {\n  color: #c0c4cc;\n  font-size: 13px;\n}\n.detail-settings-content .settings-preview[data-v-4b8d54f2] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n}\n.detail-settings-content .settings-preview .preview-title[data-v-4b8d54f2] {\n  font-weight: 600;\n  color: #303133;\n  margin-bottom: 16px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node[data-v-4b8d54f2] {\n  padding: 8px 16px;\n  margin-bottom: 4px;\n  background: #ffffff;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node i[data-v-4b8d54f2] {\n  color: #2555FF;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-0[data-v-4b8d54f2] {\n  font-weight: 600;\n  color: #303133;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-1[data-v-4b8d54f2] {\n  margin-left: 24px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-2[data-v-4b8d54f2] {\n  margin-left: 32px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-3[data-v-4b8d54f2] {\n  margin-left: 48px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-4[data-v-4b8d54f2] {\n  margin-left: calc(48px + 24px);\n}\n.detail-settings-content .settings-preview .preview-content .preview-empty[data-v-4b8d54f2] {\n  text-align: center;\n  padding: 32px;\n  color: #c0c4cc;\n}\n",""]),e.exports=t},321:function(e,t,i){"use strict";i(302)},322:function(e,t,i){(t=i(19)(!1)).push([e.i,'.bill-summary-content .amount-header[data-v-2ae2ccd6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #2555FF 0%, #5580FF 100%);\n  color: #ffffff;\n  border-radius: 8px;\n  margin-bottom: 24px;\n}\n.bill-summary-content .amount-header .amount-info[data-v-2ae2ccd6] {\n  display: flex;\n  align-items: baseline;\n  gap: 8px;\n}\n.bill-summary-content .amount-header .amount-info .amount-label[data-v-2ae2ccd6] {\n  font-size: 14px;\n  opacity: 0.95;\n}\n.bill-summary-content .amount-header .amount-info .amount-value[data-v-2ae2ccd6] {\n  font-size: 20px;\n  font-weight: 600;\n  letter-spacing: 0.5px;\n}\n.bill-summary-content .amount-header[data-v-2ae2ccd6] .el-button--text {\n  color: #ffffff;\n  font-size: 14px;\n}\n.bill-summary-content .amount-header[data-v-2ae2ccd6] .el-button--text:hover {\n  color: #ffffff;\n  opacity: 0.9;\n}\n.bill-summary-content .detail-section[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section[data-v-2ae2ccd6] {\n  margin-bottom: 24px;\n}\n.bill-summary-content .detail-section .detail-header[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .detail-header[data-v-2ae2ccd6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.bill-summary-content .detail-section .detail-header .section-title[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .detail-header .section-title[data-v-2ae2ccd6] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #333333;\n  margin: 0;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] {\n  background: #ffffff;\n  border: 1px solid #e8e8e8;\n  border-radius: 8px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree {\n  background: #ffffff;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__content {\n  height: 48px;\n  border-bottom: 1px solid #f0f0f0;\n  padding-right: 16px;\n  background: #ffffff;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__content:hover,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__content:hover {\n  background: #fafafa;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__expand-icon,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__expand-icon {\n  color: #999999;\n  font-size: 12px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__expand-icon.is-leaf,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node__expand-icon.is-leaf {\n  visibility: hidden;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node {\n  flex: 1;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-label,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-label .node-name,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-label .node-name {\n  font-weight: 400;\n  color: #333333;\n  font-size: 14px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats {\n  display: flex;\n  align-items: center;\n  gap: 24px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats .node-amount,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats .node-amount {\n  font-weight: 500;\n  color: #333333;\n  font-size: 14px;\n  min-width: 120px;\n  text-align: right;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats .node-count,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .custom-tree-node .node-stats .node-count {\n  color: #999999;\n  font-size: 12px;\n  min-width: 60px;\n  text-align: right;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="2"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="2"] > .el-tree-node__content {\n  padding-left: 32px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="3"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="3"] > .el-tree-node__content {\n  padding-left: 64px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="4"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="4"] > .el-tree-node__content {\n  padding-left: 96px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="5"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-2ae2ccd6] .custom-tree .el-tree-node[aria-level="5"] > .el-tree-node__content {\n  padding-left: 128px !important;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card[data-v-2ae2ccd6] {\n  background: #ffffff;\n  border: 1px solid #e8e8e8;\n  border-radius: 8px;\n  padding: 16px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-header[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-header[data-v-2ae2ccd6] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-header .stat-name[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-header .stat-name[data-v-2ae2ccd6] {\n  font-size: 14px;\n  color: #666666;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-amount[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-amount[data-v-2ae2ccd6] {\n  font-size: 20px;\n  font-weight: 600;\n  color: #333333;\n  margin-bottom: 4px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-count[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-count[data-v-2ae2ccd6] {\n  font-size: 12px;\n  color: #999999;\n}\n.bill-summary-content .detail-section .section-title[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .section-title[data-v-2ae2ccd6] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #333333;\n  margin-bottom: 16px;\n  padding-bottom: 8px;\n  border-bottom: 2px solid #e8e8e8;\n}\n.bill-summary-content .detail-section .stat-item[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .stat-item[data-v-2ae2ccd6] {\n  background: #fafafa;\n  padding: 16px;\n  border-radius: 8px;\n  text-align: center;\n}\n.bill-summary-content .detail-section .stat-item .stat-label[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .stat-item .stat-label[data-v-2ae2ccd6] {\n  font-size: 12px;\n  color: #666666;\n  margin-bottom: 4px;\n}\n.bill-summary-content .detail-section .stat-item .stat-number[data-v-2ae2ccd6],\n.bill-summary-content .order-stats-section .stat-item .stat-number[data-v-2ae2ccd6] {\n  font-size: 24px;\n  font-weight: 600;\n  color: #2555FF;\n}\n',""]),e.exports=t},323:function(e,t,i){"use strict";i(303)},324:function(e,t,i){(t=i(19)(!1)).push([e.i,".field-config-content .config-section[data-v-4ee905b2] {\n  padding: 16px 0;\n}\n.field-config-content .config-section .section-description[data-v-4ee905b2] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  margin-bottom: 24px;\n  color: #909399;\n  font-size: 13px;\n}\n.field-config-content .config-section .section-description i[data-v-4ee905b2] {\n  font-size: 16px;\n}\n.field-config-content .config-section .section-description i.el-icon-info[data-v-4ee905b2] {\n  color: #2555FF;\n}\n.field-config-content .config-section .section-description i.el-icon-warning[data-v-4ee905b2] {\n  color: #e6a23c;\n}\n.field-config-content .config-section[data-v-4ee905b2] .el-transfer {\n  display: flex;\n  justify-content: center;\n}\n.field-config-content .config-section[data-v-4ee905b2] .el-transfer .el-transfer-panel {\n  width: 300px;\n}\n.field-config-content .config-section .error-hint[data-v-4ee905b2] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-top: 16px;\n  padding: 8px 16px;\n  background: #fef0f0;\n  border: 1px solid #fde2e2;\n  border-radius: 4px;\n  color: #f56c6c;\n  font-size: 13px;\n}\n.field-config-content .config-section .error-hint i[data-v-4ee905b2] {\n  font-size: 16px;\n}\n",""]),e.exports=t},325:function(e,t,i){"use strict";i(304)},326:function(e,t,i){(t=i(19)(!1)).push([e.i,".order-list-content .filter-section[data-v-2886b62e] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 16px;\n}\n.order-list-content .filter-section[data-v-2886b62e] .el-form-item {\n  margin-bottom: 0;\n}\n.order-list-content .toolbar-section[data-v-2886b62e] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.order-list-content .toolbar-section .toolbar-left[data-v-2886b62e] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.order-list-content .toolbar-section .toolbar-left .selection-info[data-v-2886b62e] {\n  color: #909399;\n  font-size: 13px;\n}\n.order-list-content .toolbar-section .toolbar-actions[data-v-2886b62e] {\n  display: flex;\n  gap: 8px;\n}\n.order-list-content .toolbar-section .toolbar-actions[data-v-2886b62e] .el-button.is-disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.order-list-content[data-v-2886b62e] .el-table {\n  border: none;\n}\n.order-list-content[data-v-2886b62e] .el-table::before {\n  display: none;\n}\n.order-list-content[data-v-2886b62e] .el-table::after {\n  display: none;\n}\n.order-list-content[data-v-2886b62e] .el-table th,\n.order-list-content[data-v-2886b62e] .el-table td {\n  border-right: none;\n}\n.order-list-content[data-v-2886b62e] .el-table th.el-table__cell {\n  background: #fafafa;\n  color: #303133;\n  font-weight: 600;\n  border-bottom: 1px solid #e8e8e8;\n}\n.order-list-content[data-v-2886b62e] .el-table .el-table__body tr:hover > td {\n  background-color: #f5f7fa;\n}\n.order-list-content[data-v-2886b62e] .el-table .el-table__body td {\n  border-bottom: 1px solid #f0f0f0;\n}\n.order-list-content[data-v-2886b62e] .el-table .el-table__row--striped td {\n  background: #fafafa;\n}\n.order-list-content .summary-footer[data-v-2886b62e] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-top: 16px;\n}\n.order-list-content .summary-footer .summary-item[data-v-2886b62e] {\n  text-align: center;\n}\n.order-list-content .summary-footer .summary-item .label[data-v-2886b62e] {\n  font-size: 13px;\n  color: #909399;\n  margin-right: 4px;\n}\n.order-list-content .summary-footer .summary-item .value[data-v-2886b62e] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n}\n.order-list-content .summary-footer .summary-item .value.primary[data-v-2886b62e] {\n  color: #2555FF;\n}\n.order-list-content .summary-footer .summary-item .value.success[data-v-2886b62e] {\n  color: #67c23a;\n}\n.order-list-content .summary-footer .summary-item .value.warning[data-v-2886b62e] {\n  color: #e6a23c;\n}\n.order-list-content .dialog-content .info-message[data-v-2886b62e] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border: 1px solid #dcdfe6;\n  border-radius: 4px;\n  color: #2555FF;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.order-list-content .dialog-content .info-message i[data-v-2886b62e] {\n  font-size: 18px;\n}\n.order-list-content .dialog-content .el-upload__tip[data-v-2886b62e] {\n  color: #c0c4cc;\n  font-size: 13px;\n  margin-top: 4px;\n}\n",""]),e.exports=t},327:function(e,t,i){"use strict";i(305)},328:function(e,t,i){(t=i(19)(!1)).push([e.i,".bill-orders-tab[data-v-040b150f] .el-tabs__header {\n  margin-bottom: 24px;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header {\n  border-bottom: 1px solid #dcdfe6;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item {\n  border-left: 1px solid #dcdfe6;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item:first-child {\n  border-left: none;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item.is-active {\n  color: #2555FF;\n  background-color: #ffffff;\n}\n.bill-orders-tab .empty-state[data-v-040b150f] {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  min-height: 400px;\n  color: #909399;\n}\n.bill-orders-tab .empty-state i[data-v-040b150f] {\n  font-size: 64px;\n  margin-bottom: 16px;\n  color: #c0c4cc;\n}\n.bill-orders-tab .empty-state p[data-v-040b150f] {\n  font-size: 14px;\n  margin: 0;\n}\n",""]),e.exports=t},329:function(e,t,i){"use strict";i(307)},330:function(e,t,i){(t=i(19)(!1)).push([e.i,".invoice-record-table .table-header[data-v-e0a3c4da] {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.invoice-record-table .table-header .header-actions[data-v-e0a3c4da] {\n  display: flex;\n  gap: 8px;\n}\n.invoice-record-table .pagination-container[data-v-e0a3c4da] {\n  margin-top: 16px;\n  display: flex;\n  justify-content: flex-end;\n}\n.invoice-record-table[data-v-e0a3c4da] .el-table .el-link {\n  font-size: 14px;\n  font-weight: normal;\n}\n.invoice-record-table .text-ellipsis[data-v-e0a3c4da] {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.invoice-record-table .dialog-content .warning-message[data-v-e0a3c4da],\n.invoice-record-table .dialog-content .info-message[data-v-e0a3c4da] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n  font-size: 14px;\n}\n.invoice-record-table .dialog-content .warning-message i[data-v-e0a3c4da],\n.invoice-record-table .dialog-content .info-message i[data-v-e0a3c4da] {\n  font-size: 18px;\n}\n.invoice-record-table .dialog-content .warning-message[data-v-e0a3c4da] {\n  background: #fef0f0;\n  border: 1px solid #fde2e2;\n  color: #f56c6c;\n}\n.invoice-record-table .dialog-content .info-message[data-v-e0a3c4da] {\n  background: #f5f7fa;\n  border: 1px solid #dcdfe6;\n  color: #2555FF;\n}\n.invoice-record-table .dialog-content .record-info[data-v-e0a3c4da] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n}\n.invoice-record-table .dialog-content .record-info .info-row[data-v-e0a3c4da] {\n  display: flex;\n  padding: 4px 0;\n}\n.invoice-record-table .dialog-content .record-info .info-row .label[data-v-e0a3c4da] {\n  color: #909399;\n  min-width: 90px;\n}\n.invoice-record-table .dialog-content .record-info .info-row .value[data-v-e0a3c4da] {\n  flex: 1;\n  color: #303133;\n  font-weight: 500;\n}\n.invoice-record-table .dialog-content .hint-message[data-v-e0a3c4da] {\n  color: #c0c4cc;\n  font-size: 13px;\n  margin: 16px 0 0;\n  text-align: center;\n}\n",""]),e.exports=t},331:function(e,t,i){"use strict";i(308)},332:function(e,t,i){(t=i(19)(!1)).push([e.i,".invoice-summary-content .summary-header[data-v-d059509a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .summary-header .page-title[data-v-d059509a] {\n  font-size: 18px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.invoice-summary-content .invoice-amount-summary[data-v-d059509a] {\n  background: #ffffff;\n  border-radius: 4px;\n  padding: 24px;\n  margin-bottom: 32px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards[data-v-d059509a] {\n  display: flex;\n  align-items: center;\n  gap: 24px;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card[data-v-d059509a] {\n  flex: 1;\n  padding: 24px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  text-align: center;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card .amount-label[data-v-d059509a] {\n  font-size: 14px;\n  color: #909399;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card .amount-value[data-v-d059509a] {\n  font-size: 28px;\n  font-weight: 600;\n  color: #303133;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card[data-v-d059509a] {\n  background: #2555FF;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card .amount-label[data-v-d059509a] {\n  color: #ffffff;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card .amount-value[data-v-d059509a] {\n  color: #ffffff;\n}\n.invoice-summary-content .invoice-amount-summary .amount-details-table[data-v-d059509a] {\n  margin-top: 24px;\n}\n.invoice-summary-content .invoice-applications[data-v-d059509a] {\n  background: #ffffff;\n  border-radius: 4px;\n  padding: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invoice-summary-content .invoice-applications .applications-header[data-v-d059509a] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .invoice-applications .applications-header .section-title[data-v-d059509a] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.invoice-summary-content .invoice-applications .applications-header .header-actions[data-v-d059509a] {\n  display: flex;\n  gap: 8px;\n}\n.invoice-summary-content .dialog-content .info-message[data-v-d059509a] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border: 1px solid #dcdfe6;\n  border-radius: 4px;\n  color: #2555FF;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .dialog-content .info-message i[data-v-d059509a] {\n  font-size: 18px;\n}\n.invoice-summary-content .dialog-content .filter-preview[data-v-d059509a] {\n  margin-top: 24px;\n  padding: 16px;\n  background: #E8EEFF;\n  border: 1px solid #B3C5FF;\n  border-radius: 4px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-title[data-v-d059509a] {\n  font-size: 13px;\n  color: #909399;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-content p[data-v-d059509a] {\n  margin: 0;\n  color: #303133;\n  font-size: 14px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-content p strong[data-v-d059509a] {\n  color: #2555FF;\n  font-weight: 600;\n  font-size: 16px;\n}\n",""]),e.exports=t},339:function(e,t,i){"use strict";i(312)},340:function(e,t,i){(t=i(19)(!1)).push([e.i,".bill-detail-page[data-v-c1442712] {\n  padding: 24px;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n.bill-detail-page .breadcrumb-container[data-v-c1442712] {\n  margin-bottom: 16px;\n  font-size: 14px;\n  color: #909399;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item[data-v-c1442712] {\n  cursor: pointer;\n  transition: color 0.3s;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item[data-v-c1442712]:hover {\n  color: #2555FF;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item.active[data-v-c1442712] {\n  color: #303133;\n  cursor: default;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-separator[data-v-c1442712] {\n  margin: 0 8px;\n}\n.bill-detail-page .loading-container[data-v-c1442712] {\n  background: #ffffff;\n  padding: 32px;\n  border-radius: 4px;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] {\n  margin-bottom: 16px;\n}\n.bill-detail-page .bill-content .steps-card .step-description[data-v-c1442712] {\n  color: #e6a23c;\n  font-size: 13px;\n  margin-top: 4px;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-process .el-step__icon {\n  background-color: #2555FF;\n  border-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-process .el-step__icon .el-step__icon-inner {\n  color: #ffffff;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-process .el-step__line {\n  background-color: #e4e7ed;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-wait .el-step__icon {\n  background-color: #ffffff;\n  border-color: #c0c4cc;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-wait .el-step__icon .el-step__icon-inner {\n  color: #c0c4cc;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-wait .el-step__line {\n  background-color: #e4e7ed;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-success .el-step__icon,\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-finish .el-step__icon {\n  background-color: #2555FF;\n  border-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-success .el-step__icon .el-step__icon-inner,\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-finish .el-step__icon .el-step__icon-inner {\n  color: #ffffff;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-success .el-step__line,\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__head.is-finish .el-step__line {\n  background-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__title.is-process {\n  color: #303133;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__title.is-wait {\n  color: #c0c4cc;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__title.is-success,\n.bill-detail-page .bill-content .steps-card[data-v-c1442712] .el-steps .el-step__title.is-finish {\n  color: #303133;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .action-card[data-v-c1442712] {\n  margin-bottom: 16px;\n}\n.bill-detail-page .bill-content .action-card .action-header[data-v-c1442712] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.bill-detail-page .bill-content .action-card .action-header .date-range[data-v-c1442712] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n}\n.bill-detail-page .bill-content .action-card .action-header .date-range i[data-v-c1442712] {\n  margin-right: 8px;\n  color: #2555FF;\n}\n.bill-detail-page .bill-content .action-card .action-header .action-buttons[data-v-c1442712] {\n  display: flex;\n  gap: 8px;\n}\n.bill-detail-page .bill-content .tabs-card[data-v-c1442712] {\n  min-height: 500px;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-header[data-v-c1442712] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #dcdfe6;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-header .section-title[data-v-c1442712] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-content .action-section[data-v-c1442712] {\n  margin-bottom: 24px;\n}\n.bill-detail-page .confirm-dialog-content .confirm-message[data-v-c1442712] {\n  font-size: 16px;\n  color: #303133;\n  margin-bottom: 24px;\n  text-align: center;\n}\n.bill-detail-page .confirm-dialog-content .confirm-message strong[data-v-c1442712] {\n  color: #2555FF;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount[data-v-c1442712] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item[data-v-c1442712] {\n  display: flex;\n  justify-content: space-between;\n  padding: 8px 0;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item .label[data-v-c1442712] {\n  color: #909399;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item .value[data-v-c1442712] {\n  font-weight: 600;\n  color: #303133;\n}\n.bill-detail-page .confirm-dialog-content .confirm-hint[data-v-c1442712] {\n  font-size: 13px;\n  color: #c0c4cc;\n  text-align: center;\n  margin: 0;\n}\n.bill-detail-page .confirm-dialog-content .confirm-hint.warn[data-v-c1442712] {\n  color: #e6a23c;\n}\n.bill-detail-page .split-config-banner[data-v-c1442712] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 8px;\n  background: #fff8e1;\n  border: 1px solid #ffe0a3;\n  color: #8a6d1b;\n  padding: 8px 12px;\n  border-radius: 8px;\n  margin: 8px 0 12px 0;\n}\n",""]),e.exports=t},343:function(e,t,i){"use strict";i.r(t);var a=i(33),n=i(0),l=i(160),s=i(161),o={name:"BillDetailSettings",props:{visible:{type:Boolean,default:!1},currentSettings:{type:Object,default:()=>({dimensions:[]})},billTotal:{type:Number,default:0}},data:()=>({dialogVisible:!1,saving:!1,form:{dimensions:[]},dimensionNames:{businessLine:"业务线",legalEntity:"法人实体",paymentAccount:"支付账户",department:"部门"}}),computed:{previewTotal(){return this.billTotal}},watch:{visible:{immediate:!0,handler(e){this.dialogVisible=e,e&&this.initForm()}}},methods:{initForm(){this.form.dimensions=[...this.currentSettings.dimensions||[]]},getDimensionName(e){return this.dimensionNames[e]||e},removeDimension(e){const t=this.form.dimensions.indexOf(e);t>-1&&this.form.dimensions.splice(t,1)},formatAmount:e=>Object(l.a)(e),handleClose(){this.dialogVisible=!1,this.$emit("update:visible",!1)},async handleSave(){if(this.form.dimensions.length>4)this.$message.warning("最多只能选择4个拆分维度");else{this.saving=!0;try{await this.$emit("save",{dimensions:this.form.dimensions}),this.$message.success("明细设置保存成功"),this.handleClose()}catch(e){this.$message.error("保存失败："+e.message)}finally{this.saving=!1}}}}},r=(i(319),i(12)),c={name:"BillSummaryContent",components:{BillDetailSettings:Object(r.a)(o,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"明细设置",visible:e.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[t("div",{staticClass:"detail-settings-content"},[t("div",{staticClass:"settings-description"},[t("i",{staticClass:"el-icon-info"}),e._v(" "),t("span",[e._v("选择拆分维度后，账单汇总将按照所选维度进行多层级展示")])]),e._v(" "),t("div",{staticClass:"settings-form"},[t("el-form",{attrs:{model:e.form,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"拆分维度"}},[t("el-checkbox-group",{model:{value:e.form.dimensions,callback:function(t){e.$set(e.form,"dimensions",t)},expression:"form.dimensions"}},[t("el-checkbox",{attrs:{label:"businessLine"}},[e._v("业务线")]),e._v(" "),t("el-checkbox",{attrs:{label:"legalEntity"}},[e._v("法人实体")]),e._v(" "),t("el-checkbox",{attrs:{label:"paymentAccount"}},[e._v("支付账户")]),e._v(" "),t("el-checkbox",{attrs:{label:"department"}},[e._v("部门")])],1),e._v(" "),t("div",{staticClass:"form-hint"},[e._v("\n            可选择0-4个维度，将按选择顺序进行多层级拆分（选择0个则不拆分）\n          ")])],1),e._v(" "),t("el-form-item",{attrs:{label:"拆分顺序"}},[t("div",{staticClass:"dimension-order"},[e._l(e.form.dimensions,(function(i,a){return t("el-tag",{key:i,attrs:{closable:""},on:{close:function(t){return e.removeDimension(i)}}},[e._v("\n              "+e._s(e.getDimensionName(i))+"\n              "),t("span",{staticClass:"order-number"},[e._v(e._s(a+1))])])})),e._v(" "),0===e.form.dimensions.length?t("div",{staticClass:"empty-hint"},[e._v("\n              请勾选拆分维度\n            ")]):e._e()],2)])],1)],1),e._v(" "),t("div",{staticClass:"settings-preview"},[t("div",{staticClass:"preview-title"},[e._v("预览效果")]),e._v(" "),t("div",{staticClass:"preview-content"},[e.form.dimensions.length>0?t("div",{staticClass:"preview-tree"},[t("div",{staticClass:"tree-node level-0"},[t("i",{staticClass:"el-icon-folder"}),e._v(" "),t("span",[e._v("总计：¥"+e._s(e.formatAmount(e.previewTotal)))])]),e._v(" "),e._l(e.form.dimensions,(function(i,a){return t("div",{key:i,staticClass:"tree-node",class:"level-"+(a+1)},[t("i",{staticClass:"el-icon-folder-opened"}),e._v(" "),t("span",[e._v(e._s(e.getDimensionName(i))+" - 示例值")])])}))],2):t("div",{staticClass:"preview-empty"},[e._v("\n          选择拆分维度后将显示预览效果\n        ")])])])]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSave}},[e._v("保存")])],1)])}),[],!1,null,"4b8d54f2",null).exports},props:{bill:{type:Object,required:!0}},data:()=>({settingsVisible:!1,treeProps:{children:"children",label:"name"}}),computed:{...Object(a.c)("config",["detailSettings"]),...Object(a.c)("order",["orderList"]),billSummary(){return this.bill.summary||{}},businessLineSummary(){return this.billSummary.businessLineSummary||[]},averageOrderAmount(){return(this.bill.totalAmount||0)/(this.billSummary.totalCount||1)},checkedOrderCount(){return this.orderList&&0!==this.orderList.length?this.orderList.filter(e=>1===e.checkStatus).length:0},treeData(){return this.detailSettings&&this.detailSettings.dimensions&&0!==this.detailSettings.dimensions.length?this.buildTreeData():[]}},methods:{...Object(a.b)("config",["updateDetailSettings"]),formatAmount:e=>Object(l.a)(e),formatCycle:e=>Object(l.b)(e),formatDateRange:(e,t)=>Object(l.d)(e,t),calculatePercent:(e,t)=>t?(e/t*100).toFixed(1)+"%":"0%",handleDetailSettings(){this.settingsVisible=!0},async handleSaveSettings(e){try{await this.updateDetailSettings(e),this.$message.success("明细设置已保存")}catch(e){throw this.$message.error("保存失败："+e.message),e}},getNodeIcon:e=>0===e.level?"el-icon-folder":"el-icon-folder-opened",buildTreeData(){const e=this.detailSettings.dimensions,t=this.orderList||[],i={id:"root",name:"本期结算周期主汇总",amount:this.bill.totalAmount||0,count:t.length,level:0,children:[]};return this.buildTreeLevel(i,t,e,0),[i]},buildTreeLevel(e,t,i,a){if(a>=i.length||0===t.length)return;const n=i[a],l=this.groupBy(t,n);e.children=Object.keys(l).map((t,s)=>{const o=l[t],r=a===i.length-1,c={id:`${e.id}-${n}-${t}`,name:this.getDimensionValueName(n,t),amount:o.reduce((e,t)=>e+(t.amount||0),0),count:o.length,level:a+1};if(r||(c.children=[]),r&&o.length>0){const e=o[0];c.department=e.department||"首页-机酒住宿部"}return this.buildTreeLevel(c,o,i,a+1),c})},groupBy(e,t){const i={};return e.forEach(e=>{let a;switch(t){case"businessLine":a=e.businessType||"未知";break;case"legalEntity":a=e.legalEntity||"未知";break;case"paymentAccount":a=e.paymentAccount||"未知";break;case"department":a=e.department||"未知";break;default:a="未知"}i[a]||(i[a]=[]),i[a].push(e)}),i},getDimensionValueName:(e,t)=>"businessLine"===e&&n.BUSINESS_TYPE_NAMES[t]||t}},d=(i(321),Object(r.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bill-summary-content"},[t("div",{staticClass:"amount-header"},[t("div",{staticClass:"amount-info"},[t("span",{staticClass:"amount-label"},[e._v("消费金额：")]),e._v(" "),t("span",{staticClass:"amount-value"},[e._v(e._s(e.formatAmount(e.bill.totalAmount)))])]),e._v(" "),t("el-button",{attrs:{size:"small",type:"text"},on:{click:e.handleDetailSettings}},[e._v("\n      明细设置\n    ")])],1),e._v(" "),t("div",{staticClass:"detail-section"},[e.detailSettings&&e.detailSettings.dimensions.length>0?t("div",{staticClass:"detail-tree"},[t("el-tree",{staticClass:"custom-tree",attrs:{data:e.treeData,props:e.treeProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function({node:i,data:a}){return t("span",{staticClass:"custom-tree-node"},[t("span",{staticClass:"node-label"},[t("span",{staticClass:"node-name"},[e._v(e._s(a.name))])]),e._v(" "),t("span",{staticClass:"node-stats"},[t("span",{staticClass:"node-amount"},[e._v(e._s(e.formatAmount(a.amount)))]),e._v(" "),t("span",{staticClass:"node-count"},[e._v(e._s(a.count)+"笔")])])])}}],null,!1,1745745915)})],1):t("div",{staticClass:"business-stats-default"},[t("el-row",{attrs:{gutter:16}},e._l(e.businessLineSummary,(function(i){return t("el-col",{key:i.businessType,attrs:{span:6}},[t("div",{staticClass:"stat-card"},[t("div",{staticClass:"stat-header"},[t("span",{staticClass:"stat-name"},[e._v(e._s(i.businessTypeName))]),e._v(" "),t("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.calculatePercent(i.totalAmount,e.bill.totalAmount)))])],1),e._v(" "),t("div",{staticClass:"stat-amount"},[e._v(e._s(e.formatAmount(i.totalAmount)))]),e._v(" "),t("div",{staticClass:"stat-count"},[e._v(e._s(i.count)+"笔订单")])])])})),1)],1)]),e._v(" "),t("div",{staticClass:"order-stats-section"},[t("h4",{staticClass:"section-title"},[e._v("订单统计")]),e._v(" "),t("el-row",{attrs:{gutter:16}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"stat-item"},[t("div",{staticClass:"stat-label"},[e._v("总订单数")]),e._v(" "),t("div",{staticClass:"stat-number"},[e._v(e._s(e.billSummary.totalCount))])])]),e._v(" "),t("el-col",{attrs:{span:8}},[t("div",{staticClass:"stat-item"},[t("div",{staticClass:"stat-label"},[e._v("平均订单金额")]),e._v(" "),t("div",{staticClass:"stat-number"},[e._v(e._s(e.formatAmount(e.averageOrderAmount)))])])]),e._v(" "),t("el-col",{attrs:{span:8}},[t("div",{staticClass:"stat-item"},[t("div",{staticClass:"stat-label"},[e._v("已核对订单")]),e._v(" "),t("div",{staticClass:"stat-number"},[e._v(e._s(e.checkedOrderCount))])])])],1)],1),e._v(" "),t("bill-detail-settings",{attrs:{visible:e.settingsVisible,"current-settings":e.detailSettings,"bill-total":e.bill.totalAmount},on:{"update:visible":function(t){e.settingsVisible=t},save:e.handleSaveSettings}})],1)}),[],!1,null,"2ae2ccd6",null).exports);function m(){try{return i(162),!0}catch(e){return!1}}const u={orderNo:"订单号",bookingTime:"预订日期",departDate:"出行日期",bookingPerson:"预订人",travelerName:"出行人/入住人",amount:"支付金额",checkStatus:"核对状态",flightNo:"航班号",route:"航线",departTime:"起飞时间",cabin:"舱位等级",ticketNo:"电子客票号",hotelName:"酒店名称",checkInDate:"入住日期",checkOutDate:"离店日期",nights:"房间数量",roomType:"房型",trainNo:"车次",seatType:"座位等级",idCardLast4:"身份证后四位",useTime:"用车时间",startLocation:"起点",endLocation:"终点",carType:"车型",mileage:"行驶里程",legalEntity:"法人实体",paymentAccount:"支付账户",costCenter:"成本中心",department:"项目部门",expenseType:"费用类型"};function p(e,t,i){if(null==t)return"";switch(e){case"bookingTime":case"departTime":case"useTime":return Object(l.c)(t,"YYYY-MM-DD HH:mm");case"departDate":case"checkInDate":case"checkOutDate":return Object(l.c)(t,"YYYY-MM-DD");case"amount":return Object(l.a)(t);case"checkStatus":return n.CHECK_STATUS_NAMES[t]||t;case"businessType":return n.BUSINESS_TYPE_NAMES[t]||t;default:return t}}function b(e){const{data:t=[],fields:a=[],fileName:n="导出数据",sheetName:s="Sheet1"}=e;if(!m())throw new Error("Excel导出功能需要安装xlsx库。\n请运行以下命令安装：\nnpm install xlsx --save");const o=i(162);if(!t||0===t.length)throw new Error("没有可导出的数据");if(!a||0===a.length)throw new Error("请先配置导出字段");const r=[a.map(e=>u[e]||e),...t.map(e=>a.map(t=>p(t,e[t])))],c=o.utils.aoa_to_sheet(r),d=a.map(e=>{const t=u[e]||e,i=Math.max(2*t.length,10);return"orderNo"===e?{wch:20}:"bookingTime"===e||"departTime"===e?{wch:18}:"amount"===e?{wch:12}:"route"===e?{wch:20}:"hotelName"===e?{wch:25}:{wch:i}});c["!cols"]=d;const b=o.utils.book_new();o.utils.book_append_sheet(b,c,s);const f=`${n}_${Object(l.c)(new Date,"YYYYMMDD_HHmmss")}.xlsx`;return o.writeFile(b,f),{fileName:f,rowCount:t.length,fieldCount:a.length}}function f(e){const{orders:t=[],fields:i=[],businessType:a="",billNo:l=""}=e,s=n.BUSINESS_TYPE_NAMES[a]||"订单";return b({data:t,fields:i,fileName:`账单${l}_${s}明细`,sheetName:s})}var v={name:"FieldConfigDialog",props:{visible:{type:Boolean,default:!1},currentConfig:{type:Object,default:()=>({display:[],excelExport:[],pdfExport:[]})}},data:()=>({dialogVisible:!1,activeConfigTab:"display",saving:!1,localConfig:{display:[],excelExport:[],pdfExport:[]},availableFields:[{label:"订单号",value:"orderNo"},{label:"预订日期",value:"bookingTime"},{label:"出行日期",value:"departDate"},{label:"预订人",value:"bookingPerson"},{label:"出行人/入住人",value:"travelerName"},{label:"支付金额",value:"amount"},{label:"核对状态",value:"checkStatus"},{label:"航班号",value:"flightNo"},{label:"航线",value:"route"},{label:"起飞时间",value:"departTime"},{label:"舱位等级",value:"cabin"},{label:"电子客票号",value:"ticketNo"},{label:"酒店名称",value:"hotelName"},{label:"入住日期",value:"checkInDate"},{label:"离店日期",value:"checkOutDate"},{label:"房间数量",value:"nights"},{label:"房型",value:"roomType"},{label:"车次",value:"trainNo"},{label:"出发时间",value:"departTime"},{label:"座位等级",value:"seatType"},{label:"身份证后四位",value:"idCardLast4"},{label:"用车时间",value:"useTime"},{label:"起点",value:"startLocation"},{label:"终点",value:"endLocation"},{label:"车型",value:"carType"},{label:"行驶里程",value:"mileage"},{label:"法人实体",value:"legalEntity"},{label:"支付账户",value:"paymentAccount"},{label:"成本中心",value:"costCenter"},{label:"项目部门",value:"department"},{label:"费用类型",value:"expenseType"}]}),watch:{visible:{immediate:!0,handler(e){this.dialogVisible=e,e&&this.initForm()}}},methods:{initForm(){this.localConfig={display:[...this.currentConfig.display||[]],excelExport:[...this.currentConfig.excelExport||[]],pdfExport:[...this.currentConfig.pdfExport||[]]},0===this.localConfig.display.length&&(this.localConfig.display=["orderNo","bookingTime","departDate","bookingPerson","travelerName","amount","checkStatus"]),0===this.localConfig.excelExport.length&&(this.localConfig.excelExport=[...this.localConfig.display]),0===this.localConfig.pdfExport.length&&(this.localConfig.pdfExport=[...this.localConfig.display].slice(0,20))},handlePdfFieldChange(){this.localConfig.pdfExport.length>20&&this.$message.warning("PDF字段数量已达到上限（20个）")},handleClose(){this.dialogVisible=!1,this.$emit("update:visible",!1)},async handleSave(){if(this.localConfig.pdfExport.length>20)this.$message.error("PDF导出字段不能超过20个，请调整后再保存");else if(0!==this.localConfig.display.length){this.saving=!0;try{await this.$emit("save",this.localConfig),this.$message.success("字段配置保存成功"),this.handleClose()}catch(e){this.$message.error("保存失败："+e.message)}finally{this.saving=!1}}else this.$message.warning("请至少选择一个显示字段")}}},h=(i(323),{name:"OrderListContent",components:{FieldConfigDialog:Object(r.a)(v,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"对账单字段配置",visible:e.dialogVisible,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[t("div",{staticClass:"field-config-content"},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeConfigTab,callback:function(t){e.activeConfigTab=t},expression:"activeConfigTab"}},[t("el-tab-pane",{attrs:{label:"显示字段",name:"display"}},[t("div",{staticClass:"config-section"},[t("div",{staticClass:"section-description"},[t("i",{staticClass:"el-icon-info"}),e._v(" "),t("span",[e._v("配置在订单列表中显示的字段")])]),e._v(" "),t("el-transfer",{attrs:{data:e.availableFields,titles:["可选字段","已选字段"],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},model:{value:e.localConfig.display,callback:function(t){e.$set(e.localConfig,"display",t)},expression:"localConfig.display"}})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:"Excel导出字段",name:"excel"}},[t("div",{staticClass:"config-section"},[t("div",{staticClass:"section-description"},[t("i",{staticClass:"el-icon-info"}),e._v(" "),t("span",[e._v("配置导出Excel时包含的字段")])]),e._v(" "),t("el-transfer",{attrs:{data:e.availableFields,titles:["可选字段","已选字段"],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},model:{value:e.localConfig.excelExport,callback:function(t){e.$set(e.localConfig,"excelExport",t)},expression:"localConfig.excelExport"}})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:"PDF导出字段",name:"pdf"}},[t("div",{staticClass:"config-section"},[t("div",{staticClass:"section-description"},[t("i",{staticClass:"el-icon-warning"}),e._v(" "),t("span",[e._v("配置导出PDF时包含的字段（最多20个字段，受PDF宽度限制）")])]),e._v(" "),t("el-transfer",{attrs:{data:e.availableFields,titles:["可选字段",`已选字段 (${e.localConfig.pdfExport.length}/20)`],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},on:{change:e.handlePdfFieldChange},model:{value:e.localConfig.pdfExport,callback:function(t){e.$set(e.localConfig,"pdfExport",t)},expression:"localConfig.pdfExport"}}),e._v(" "),e.localConfig.pdfExport.length>20?t("div",{staticClass:"error-hint"},[t("i",{staticClass:"el-icon-warning"}),e._v("\n            PDF字段数量超过限制，请调整至20个以内\n          ")]):e._e()],1)])],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSave}},[e._v("保存配置")])],1)])}),[],!1,null,"4ee905b2",null).exports},props:{billNo:{type:String,required:!0},businessType:{type:String,required:!0},billStatus:{type:Number,default:0}},data:()=>({filterForm:{orderNo:"",checkStatus:null,travelerName:"",legalEntity:null,bookingDateRange:null,businessType:null,paymentAccount:null,costCenter:null,project:null},legalEntityOptions:n.LEGAL_ENTITY_OPTIONS,departmentOptions:n.DEPARTMENT_OPTIONS||[],projectOptions:n.PROJECT_OPTIONS||[],businessTypeOptions:n.BUSINESS_TYPE_NAMES,paymentAccountOptions:n.PAYMENT_ACCOUNT_OPTIONS,costCenterOptions:n.COST_CENTER_OPTIONS,fieldConfigVisible:!1,exporting:!1,selectedOrders:[],allSelected:!1,batchUpdateVisible:!1,batchUpdateForm:{legalEntity:null,department:null,project:null},batchModifyVisible:!1,batchModifyForm:{},batchModifyFileList:[],batchModifying:!1}),computed:{isOperationsDisabled(){return this.billStatus>=n.BILL_STATUS.PENDING_INVOICE},...Object(a.c)("order",["orderList","loading"]),...Object(a.c)("config",["fieldConfig"]),filteredOrders(){let e=this.orderList.filter(e=>e.businessType===this.businessType);if(this.filterForm.orderNo&&(e=e.filter(e=>e.orderNo.includes(this.filterForm.orderNo))),null!==this.filterForm.checkStatus&&void 0!==this.filterForm.checkStatus&&(e=e.filter(e=>e.checkStatus===this.filterForm.checkStatus)),this.filterForm.travelerName&&(e=e.filter(e=>e.travelerName&&e.travelerName.includes(this.filterForm.travelerName))),this.filterForm.legalEntity&&(e=e.filter(e=>e.legalEntity===this.filterForm.legalEntity)),this.filterForm.bookingDateRange&&2===this.filterForm.bookingDateRange.length){const[t,i]=this.filterForm.bookingDateRange;e=e.filter(e=>{if(!e.bookingTime)return!1;const a=e.bookingTime.split(" ")[0];return a>=t&&a<=i})}return this.filterForm.businessType&&(e=e.filter(e=>e.businessType===this.filterForm.businessType)),this.filterForm.paymentAccount&&(e=e.filter(e=>e.paymentAccount===this.filterForm.paymentAccount)),this.filterForm.costCenter&&(e=e.filter(e=>e.costCenter===this.filterForm.costCenter)),this.filterForm.project&&(e=e.filter(e=>e.project===this.filterForm.project)),e},totalAmount(){return this.filteredOrders.reduce((e,t)=>e+(t.amount||0),0)},checkedCount(){return this.filteredOrders.filter(e=>1===e.checkStatus).length},uncheckedCount(){return this.filteredOrders.filter(e=>0===e.checkStatus).length},totalOrderCount(){return this.orderList.filter(e=>e.businessType===this.businessType).length}},methods:{...Object(a.b)("config",["updateFieldConfig"]),...Object(a.b)("order",["updateOrderCheckStatus","batchUpdateOrders"]),formatAmount:e=>Object(l.a)(e),formatDate:(e,t="YYYY-MM-DD HH:mm")=>Object(l.c)(e,t),getCheckStatusName:e=>n.CHECK_STATUS_NAMES[e]||"-",getCheckStatusType:e=>n.CHECK_STATUS_COLORS[e]||"",isFieldVisible(e){return!this.fieldConfig||!this.fieldConfig.display||0===this.fieldConfig.display.length||this.fieldConfig.display.includes(e)},handleSelectionChange(e){this.selectedOrders=e},handleSelectAll(){const e=this.orderList.filter(e=>e.businessType===this.businessType);this.$nextTick(()=>{e.forEach(e=>{this.$refs.orderTable.toggleRowSelection(e,!0)})}),Object(s.b)(`已选中全部 ${e.length} 笔订单`)},handleBatchUpdate(){0!==this.selectedOrders.length?(this.batchUpdateForm={legalEntity:null,department:null,project:null},this.batchUpdateVisible=!0):Object(s.c)("请先选择要更新的订单")},async confirmBatchUpdate(){const{legalEntity:e,department:t,project:i}=this.batchUpdateForm;if(e||t||i)try{const a={};e&&(a.legalEntity=e),t&&(a.department=t),i&&(a.project=i);const n=this.selectedOrders.map(e=>e.orderNo);await this.batchUpdateOrders({orderNos:n,updateData:a}),Object(s.b)(`成功更新 ${n.length} 笔订单数据`),this.batchUpdateVisible=!1,this.$refs.orderTable.clearSelection()}catch(e){Object(s.a)(e,{customMessage:"批量更新失败"})}else Object(s.c)("请至少选择一个字段进行更新")},handleBatchModify(){this.batchModifyForm={},this.batchModifyFileList=[],this.batchModifyVisible=!0},handleBatchModifyFileChange(e,t){if(!(e.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.batchModifyFileList=t.filter(t=>t.uid!==e.uid));const i=e.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.batchModifyFileList=t.filter(t=>t.uid!==e.uid));this.batchModifyFileList=t},handleBatchModifyFileRemove(e,t){this.batchModifyFileList=t},async confirmBatchModify(){if(this.batchModifyFileList&&0!==this.batchModifyFileList.length){this.batchModifying=!0;try{const e=this.batchModifyFileList[0].raw;console.log("批量修改文件:",e),console.log("可修改字段: 法人实体、部门、项目"),await new Promise(e=>setTimeout(e,1e3)),Object(s.b)("批量修改数据成功"),this.batchModifyVisible=!1,this.batchModifyFileList=[],this.batchModifyForm={},await this.$store.dispatch("order/fetchOrderList",this.billNo)}catch(e){Object(s.a)(e,{customMessage:"批量修改数据失败"})}finally{this.batchModifying=!1}}else Object(s.c)("请上传Excel文件")},async handleMarkAsChecked(){if(0!==this.selectedOrders.length)try{const e=this.selectedOrders.map(e=>e.orderNo);await this.updateOrderCheckStatus({orderNos:e,checkStatus:1}),Object(s.b)(`成功标记 ${e.length} 笔订单为已核对`),this.$refs.orderTable.clearSelection()}catch(e){Object(s.a)(e,{customMessage:"标记已核对失败"})}else Object(s.c)("请先选择要标记的订单")},async handleUnmarkChecked(){if(0!==this.selectedOrders.length)try{const e=this.selectedOrders.map(e=>e.orderNo);await this.updateOrderCheckStatus({orderNos:e,checkStatus:0}),Object(s.b)(`成功取消 ${e.length} 笔订单的已核对标记`),this.$refs.orderTable.clearSelection()}catch(e){Object(s.a)(e,{customMessage:"取消已核对标记失败"})}else Object(s.c)("请先选择要取消标记的订单")},handleSearch(){},handleReset(){this.filterForm={orderNo:"",checkStatus:null,travelerName:"",legalEntity:null,bookingDateRange:null,businessType:null,paymentAccount:null,costCenter:null,project:null}},handleFieldConfig(){this.fieldConfigVisible=!0},async handleSaveFieldConfig(e){try{await this.updateFieldConfig(e),Object(s.b)("字段配置已保存")}catch(e){throw Object(s.a)(e,{customMessage:"保存字段配置失败"}),e}},async handleExportExcel(){if(this.fieldConfig.excelExport&&0!==this.fieldConfig.excelExport.length)if(0!==this.filteredOrders.length){this.exporting=!0;try{const e=f({orders:this.filteredOrders,fields:this.fieldConfig.excelExport,businessType:this.businessType,billNo:this.billNo});Object(s.b)(`Excel导出成功！\n文件名：${e.fileName}\n导出数据：${e.rowCount}行`)}catch(e){e.message.includes("xlsx库")?this.$alert(e.message,"提示",{confirmButtonText:"知道了",type:"warning"}):Object(s.a)(e,{customMessage:"Excel导出失败"})}finally{this.exporting=!1}}else Object(s.c)("当前没有可导出的订单数据");else Object(s.c)("请先配置Excel导出字段")},async handleExportPDF(){if(this.fieldConfig.pdfExport&&0!==this.fieldConfig.pdfExport.length)if(this.fieldConfig.pdfExport.length>20)this.$message.error("PDF导出字段不能超过20个，请在字段配置中调整");else if(0!==this.filteredOrders.length){this.exporting=!0;try{const e=i(2).default,t=await e.exportBillToPDF({billNo:this.billNo,businessType:this.businessType,fields:this.fieldConfig.pdfExport,orderIds:this.filteredOrders.map(e=>e.orderId)});t.data&&t.data.pdfUrl&&(Object(s.b)(`PDF导出请求已提交！\n文件将在生成后自动下载\n导出数据：${this.filteredOrders.length}行`),this.$message.info({message:"Demo环境：PDF生成功能需要后端服务支持。在实际环境中，PDF将自动下载到本地。",duration:5e3}))}catch(e){Object(s.a)(e,{customMessage:"PDF导出失败"})}finally{this.exporting=!1}}else Object(s.c)("当前没有可导出的订单数据");else Object(s.c)("请先配置PDF导出字段")}}}),g=(i(325),{name:"BillOrdersTab",components:{OrderListContent:Object(r.a)(h,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"order-list-content"},[t("div",{staticClass:"filter-section"},[t("el-form",{attrs:{inline:!0,model:e.filterForm,size:"small"}},[t("el-form-item",{attrs:{label:"订单号"}},[t("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入订单号",clearable:""},model:{value:e.filterForm.orderNo,callback:function(t){e.$set(e.filterForm,"orderNo",t)},expression:"filterForm.orderNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"核对状态"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:e.filterForm.checkStatus,callback:function(t){e.$set(e.filterForm,"checkStatus",t)},expression:"filterForm.checkStatus"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),t("el-option",{attrs:{label:"未核对",value:0}}),e._v(" "),t("el-option",{attrs:{label:"已核对",value:1}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"出行人/入住人"}},[t("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入姓名",clearable:""},model:{value:e.filterForm.travelerName,callback:function(t){e.$set(e.filterForm,"travelerName",t)},expression:"filterForm.travelerName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"法人实体"}},[t("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:e.filterForm.legalEntity,callback:function(t){e.$set(e.filterForm,"legalEntity",t)},expression:"filterForm.legalEntity"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),e._l(e.legalEntityOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}))],2)],1),e._v(" "),t("el-form-item",{attrs:{label:"下单日期"}},[t("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.filterForm.bookingDateRange,callback:function(t){e.$set(e.filterForm,"bookingDateRange",t)},expression:"filterForm.bookingDateRange"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"业务类型"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:e.filterForm.businessType,callback:function(t){e.$set(e.filterForm,"businessType",t)},expression:"filterForm.businessType"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),e._l(e.businessTypeOptions,(function(e,i){return t("el-option",{key:i,attrs:{label:e,value:i}})}))],2)],1),e._v(" "),t("el-form-item",{attrs:{label:"支付方式"}},[t("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:e.filterForm.paymentAccount,callback:function(t){e.$set(e.filterForm,"paymentAccount",t)},expression:"filterForm.paymentAccount"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),e._l(e.paymentAccountOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}))],2)],1),e._v(" "),t("el-form-item",{attrs:{label:"费用归属"}},[t("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:e.filterForm.costCenter,callback:function(t){e.$set(e.filterForm,"costCenter",t)},expression:"filterForm.costCenter"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),e._l(e.costCenterOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}))],2)],1),e._v(" "),t("el-form-item",{attrs:{label:"项目名称"}},[t("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:"",filterable:""},model:{value:e.filterForm.project,callback:function(t){e.$set(e.filterForm,"project",t)},expression:"filterForm.project"}},[t("el-option",{attrs:{label:"全部",value:null}}),e._v(" "),e._l(e.projectOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}))],2)],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("查询")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),e._v(" "),t("div",{staticClass:"toolbar-section"},[t("div",{staticClass:"toolbar-left"},[t("el-button",{attrs:{size:"small",type:"primary",disabled:e.isOperationsDisabled||0===e.totalOrderCount},on:{click:e.handleSelectAll}},[e._v("\n        选中全部列表 ("+e._s(e.totalOrderCount)+"笔)\n      ")]),e._v(" "),e.selectedOrders.length>0?t("span",{staticClass:"selection-info"},[e._v("\n        已选择 "+e._s(e.selectedOrders.length)+" 笔订单\n      ")]):e._e()],1),e._v(" "),t("div",{staticClass:"toolbar-actions"},[t("el-button",{attrs:{size:"small",icon:"el-icon-edit",disabled:e.isOperationsDisabled||0===e.selectedOrders.length},on:{click:e.handleBatchUpdate}},[e._v("\n        更新数据\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-check",type:"success",disabled:e.isOperationsDisabled||0===e.selectedOrders.length},on:{click:e.handleMarkAsChecked}},[e._v("\n        标记为已核对\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-close",disabled:e.isOperationsDisabled||0===e.selectedOrders.length},on:{click:e.handleUnmarkChecked}},[e._v("\n        取消已核对标记\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-upload",disabled:e.isOperationsDisabled},on:{click:e.handleBatchModify}},[e._v("\n        批量修改数据\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-setting"},on:{click:e.handleFieldConfig}},[e._v("\n        对账单字段配置\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:e.handleExportExcel}},[e._v("\n        导出Excel\n      ")]),e._v(" "),t("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:e.handleExportPDF}},[e._v("\n        导出PDF\n      ")])],1)]),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"orderTable",staticStyle:{width:"100%"},attrs:{data:e.filteredOrders,stripe:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left",selectable:()=>!e.isOperationsDisabled}}),e._v(" "),e.isFieldVisible("checkStatus")?t("el-table-column",{attrs:{prop:"checkStatus",label:"核对状态",width:"100",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tag",{attrs:{type:e.getCheckStatusType(i.checkStatus),size:"small"}},[e._v("\n          "+e._s(e.getCheckStatusName(i.checkStatus))+"\n        ")])]}}],null,!1,2804614141)}):e._e(),e._v(" "),e.isFieldVisible("orderNo")?t("el-table-column",{attrs:{prop:"orderNo",label:"订单号",width:"170",fixed:"left"}}):e._e(),e._v(" "),e.isFieldVisible("bookingTime")?t("el-table-column",{attrs:{prop:"bookingTime",label:"预订日期",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(e.formatDate(t.bookingTime))+"\n      ")]}}],null,!1,2700849525)}):e._e(),e._v(" "),e.isFieldVisible("departDate")?t("el-table-column",{attrs:{prop:"departDate",label:"出行日期",width:"110"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(e.formatDate(t.departDate,"YYYY-MM-DD"))+"\n      ")]}}],null,!1,2576457223)}):e._e(),e._v(" "),e.isFieldVisible("bookingPerson")?t("el-table-column",{attrs:{prop:"bookingPerson",label:"预订人",width:"90"}}):e._e(),e._v(" "),e.isFieldVisible("travelerName")?t("el-table-column",{attrs:{prop:"travelerName",label:"出行人",width:"90"}}):e._e(),e._v(" "),"001"===e.businessType?[e.isFieldVisible("flightNo")?t("el-table-column",{attrs:{prop:"flightNo",label:"航班号",width:"100"}}):e._e(),e._v(" "),e.isFieldVisible("route")?t("el-table-column",{attrs:{prop:"route",label:"航线",width:"140"}}):e._e(),e._v(" "),e.isFieldVisible("cabin")?t("el-table-column",{attrs:{prop:"cabin",label:"舱位",width:"90"}}):e._e()]:"002"===e.businessType?[e.isFieldVisible("hotelName")?t("el-table-column",{attrs:{prop:"hotelName",label:"酒店名称",width:"180"}}):e._e(),e._v(" "),e.isFieldVisible("checkInDate")?t("el-table-column",{attrs:{prop:"checkInDate",label:"入住日期",width:"110"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n          "+e._s(e.formatDate(t.checkInDate,"YYYY-MM-DD"))+"\n        ")]}}],null,!1,1379708624)}):e._e(),e._v(" "),e.isFieldVisible("checkOutDate")?t("el-table-column",{attrs:{prop:"checkOutDate",label:"离店日期",width:"110"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n          "+e._s(e.formatDate(t.checkOutDate,"YYYY-MM-DD"))+"\n        ")]}}],null,!1,2477558585)}):e._e(),e._v(" "),e.isFieldVisible("nights")?t("el-table-column",{attrs:{prop:"nights",label:"房间数",width:"80"}}):e._e(),e._v(" "),e.isFieldVisible("roomType")?t("el-table-column",{attrs:{prop:"roomType",label:"房型",width:"100"}}):e._e()]:"003"===e.businessType?[e.isFieldVisible("trainNo")?t("el-table-column",{attrs:{prop:"trainNo",label:"车次",width:"90"}}):e._e(),e._v(" "),e.isFieldVisible("route")?t("el-table-column",{attrs:{prop:"route",label:"线路",width:"140"}}):e._e(),e._v(" "),e.isFieldVisible("seatType")?t("el-table-column",{attrs:{prop:"seatType",label:"座位等级",width:"100"}}):e._e()]:"004"===e.businessType?[e.isFieldVisible("route")?t("el-table-column",{attrs:{prop:"route",label:"起终点",width:"160"}}):e._e()]:e._e(),e._v(" "),e.isFieldVisible("legalEntity")?t("el-table-column",{attrs:{prop:"legalEntity",label:"法人实体",width:"160"}}):e._e(),e._v(" "),e.isFieldVisible("paymentAccount")?t("el-table-column",{attrs:{prop:"paymentAccount",label:"支付账户",width:"110"}}):e._e(),e._v(" "),e.isFieldVisible("costCenter")?t("el-table-column",{attrs:{prop:"costCenter",label:"成本中心",width:"90"}}):e._e(),e._v(" "),e.isFieldVisible("department")?t("el-table-column",{attrs:{prop:"department",label:"部门",width:"120"}}):e._e(),e._v(" "),e.isFieldVisible("project")?t("el-table-column",{attrs:{prop:"project",label:"项目",width:"120"}}):e._e(),e._v(" "),e.isFieldVisible("amount")?t("el-table-column",{attrs:{prop:"amount",label:"支付金额",width:"110",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(e.formatAmount(t.amount))+"\n      ")]}}],null,!1,1666599005)}):e._e()],2),e._v(" "),e.filteredOrders.length>0?t("div",{staticClass:"summary-footer"},[t("el-row",{attrs:{gutter:16}},[t("el-col",{attrs:{span:6}},[t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("当前查看：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.filteredOrders.length)+"笔")])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("总金额：")]),e._v(" "),t("span",{staticClass:"value primary"},[e._v(e._s(e.formatAmount(e.totalAmount)))])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("已核对：")]),e._v(" "),t("span",{staticClass:"value success"},[e._v(e._s(e.checkedCount)+"笔")])])]),e._v(" "),t("el-col",{attrs:{span:6}},[t("div",{staticClass:"summary-item"},[t("span",{staticClass:"label"},[e._v("未核对：")]),e._v(" "),t("span",{staticClass:"value warning"},[e._v(e._s(e.uncheckedCount)+"笔")])])])],1)],1):e._e(),e._v(" "),t("field-config-dialog",{attrs:{visible:e.fieldConfigVisible,"current-config":e.fieldConfig},on:{"update:visible":function(t){e.fieldConfigVisible=t},save:e.handleSaveFieldConfig}}),e._v(" "),t("el-dialog",{attrs:{title:"更新数据",visible:e.batchUpdateVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.batchUpdateVisible=t}}},[t("el-form",{attrs:{model:e.batchUpdateForm,"label-width":"100px"}},[t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"批量更新提示",description:`即将更新 ${e.selectedOrders.length} 笔订单的数据，请选择要修改的字段`,type:"info",closable:!1}}),e._v(" "),t("el-form-item",{attrs:{label:"法人实体"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择法人实体",clearable:""},model:{value:e.batchUpdateForm.legalEntity,callback:function(t){e.$set(e.batchUpdateForm,"legalEntity",t)},expression:"batchUpdateForm.legalEntity"}},e._l(e.legalEntityOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"部门"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门",clearable:"",filterable:""},model:{value:e.batchUpdateForm.department,callback:function(t){e.$set(e.batchUpdateForm,"department",t)},expression:"batchUpdateForm.department"}},e._l(e.departmentOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"项目"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目",clearable:"",filterable:""},model:{value:e.batchUpdateForm.project,callback:function(t){e.$set(e.batchUpdateForm,"project",t)},expression:"batchUpdateForm.project"}},e._l(e.projectOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),t("el-alert",{attrs:{title:"只会更新您选择的字段，未选择的字段不会被修改",type:"warning",closable:!1}})],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.batchUpdateVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.confirmBatchUpdate}},[e._v("确定更新")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"批量修改数据",visible:e.batchModifyVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.batchModifyVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"info-message"},[t("i",{staticClass:"el-icon-info"}),e._v("\n        请上传包含修改数据的Excel文件（.xlsx格式），可修改字段：法人实体、部门、项目\n      ")]),e._v(" "),t("el-form",{attrs:{model:e.batchModifyForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"上传文件",required:""}},[t("el-upload",{ref:"batchModifyFileUpload",attrs:{"auto-upload":!1,"on-change":e.handleBatchModifyFileChange,"on-remove":e.handleBatchModifyFileRemove,limit:1,accept:".xlsx,.xls","file-list":e.batchModifyFileList}},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[e._v("选择文件")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx/xls文件，且不超过10MB。文件需包含订单号和要修改的字段列")])],1)],1)],1),e._v(" "),t("el-alert",{staticStyle:{"margin-top":"20px"},attrs:{title:"提示",description:"文件需包含订单号列，以及要修改的字段列（法人实体、部门、项目）。只会更新文件中指定的字段，未指定的字段不会被修改。",type:"info",closable:!1}})],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.batchModifyVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.batchModifying},on:{click:e.confirmBatchModify}},[e._v("确定修改")])],1)])],1)}),[],!1,null,"2886b62e",null).exports},props:{billNo:{type:String,required:!0},billStatus:{type:Number,default:0}},data:()=>({activeBusinessType:""}),computed:{...Object(a.c)("order",["orderList"]),availableBusinessTypes(){if(!this.orderList||0===this.orderList.length)return[];const e=new Set;return this.orderList.forEach(t=>{t.businessType&&e.add(t.businessType)}),Array.from(e).sort()}},watch:{availableBusinessTypes:{immediate:!0,handler(e){e.length>0?this.activeBusinessType&&e.includes(this.activeBusinessType)||(this.activeBusinessType=e[0]):this.activeBusinessType=""}}},methods:{getBusinessTypeName:e=>n.BUSINESS_TYPE_NAMES[e]||"未知"}}),_=(i(327),Object(r.a)(g,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bill-orders-tab"},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeBusinessType,callback:function(t){e.activeBusinessType=t},expression:"activeBusinessType"}},[e._l(e.availableBusinessTypes,(function(i){return t("el-tab-pane",{key:i,attrs:{label:e.getBusinessTypeName(i),name:i}},[t("order-list-content",{attrs:{"bill-no":e.billNo,"business-type":i,"bill-status":e.billStatus}})],1)})),e._v(" "),0===e.availableBusinessTypes.length?t("div",{staticClass:"empty-state"},[t("i",{staticClass:"el-icon-document"}),e._v(" "),t("p",[e._v("暂无订单数据")])]):e._e()],2)],1)}),[],!1,null,"040b150f",null).exports),y=i(306),x={name:"InvoiceRecordTable",props:{records:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},data(){return{selectedRecords:[],currentRecord:null,operating:!1,currentPage:1,pageSize:10,redFlushDialogVisible:!1,redFlushForm:{reason:""},reissueDialogVisible:!1,reissueForm:{titleName:"",taxNumber:"",address:"",bankName:"",bankAccount:""},reissueRules:{titleName:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],taxNumber:[{required:!0,message:"请输入税号",trigger:"blur"},{validator:this.validateTaxNumberRule,trigger:"blur"}]},partialRedFlushDialogVisible:!1,partialRedFlushForm:{reason:""},fileList:[],itineraryRedFlushDialogVisible:!1,itineraryRedFlushForm:{reason:""},itineraryFileList:[],statusMap:{pending:"待处理",processing:"处理中",completed:"已开票",failed:"失败",flushed:"已红冲"},statusColorMap:{pending:"info",processing:"primary",completed:"success",failed:"danger",flushed:"warning"}}},computed:{total(){return this.records.length},paginatedRecords(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.records.slice(e,t)}},methods:{formatAmount:e=>Object(l.a)(e),formatDate:e=>Object(l.c)(e,"YYYY-MM-DD HH:mm"),getInvoiceTypeColor:e=>e.includes("专用")?"warning":e.includes("行程单")?"primary":"",getStatusName(e){return this.statusMap[e]||e},getStatusType(e){return this.statusColorMap[e]||""},handleSelectionChange(e){this.selectedRecords=e},handleBatchDownload(){0!==this.selectedRecords.length?Object(s.c)(`批量下载功能开发中，已选择 ${this.selectedRecords.length} 条记录`):Object(s.c)("请选择要下载的发票")},handleDownload(e){this.$emit("download",e)},handleRedFlush(e){this.currentRecord=e,this.isItineraryInvoice(e)?(this.itineraryRedFlushForm.reason="",this.itineraryFileList=[],this.itineraryRedFlushDialogVisible=!0):(this.redFlushForm.reason="",this.redFlushDialogVisible=!0)},async confirmRedFlush(){if(this.redFlushForm.reason&&""!==this.redFlushForm.reason.trim()){this.operating=!0;try{await this.$emit("red-flush",{record:this.currentRecord,reason:this.redFlushForm.reason}),Object(s.b)("红冲操作成功"),this.redFlushDialogVisible=!1}catch(e){}finally{this.operating=!1}}else Object(s.c)("请输入红冲原因")},handleReissue(e){this.currentRecord=e,this.reissueForm={titleName:"",taxNumber:"",address:"",bankName:"",bankAccount:""},this.reissueDialogVisible=!0},async confirmReissue(){try{await this.$refs.reissueForm.validate()}catch(e){return}this.operating=!0;try{await this.$emit("reissue",{record:this.currentRecord,newTitle:this.reissueForm}),Object(s.b)("换开操作成功"),this.reissueDialogVisible=!1}catch(e){}finally{this.operating=!1}},validateTaxNumberRule(e,t,i){t?Object(y.c)(t)?i():i(new Error("请输入正确的税号格式")):i(new Error("请输入税号"))},handleSizeChange(e){this.pageSize=e,this.currentPage=1},handleCurrentChange(e){this.currentPage=e},isVATInvoice(e){if(!e||!e.invoiceType)return!1;const t=String(e.invoiceType);return t.includes("增值税")&&!t.includes("行程单")},isItineraryInvoice(e){if(!e||!e.invoiceType)return!1;const t=String(e.invoiceType);return t.includes("行程单")||t.includes("火车票")},getItineraryRedFlushTitle(){if(!this.currentRecord)return"红冲";const e=String(this.currentRecord.invoiceType);return e.includes("机票")?"机票行程单红冲":e.includes("火车票")?"火车票行程单红冲":"行程单红冲"},handlePartialRedFlush(e){this.currentRecord=e,this.partialRedFlushForm.reason="",this.fileList=[],this.partialRedFlushDialogVisible=!0},handleFileChange(e,t){if(!(e.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.fileList=t.filter(t=>t.uid!==e.uid));const i=e.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.fileList=t.filter(t=>t.uid!==e.uid));this.fileList=t},handleFileRemove(e,t){this.fileList=t},async confirmPartialRedFlush(){if(this.fileList&&0!==this.fileList.length)if(this.partialRedFlushForm.reason&&""!==this.partialRedFlushForm.reason.trim()){this.operating=!0;try{const e=this.fileList[0].raw;console.log("部分红冲文件:",e),console.log("部分红冲原因:",this.partialRedFlushForm.reason),console.log("申请编号:",this.currentRecord.applicationNo),await new Promise(e=>setTimeout(e,1e3)),Object(s.b)("部分红冲操作成功"),this.partialRedFlushDialogVisible=!1,this.fileList=[],this.partialRedFlushForm.reason="",this.$emit("refresh")}catch(e){Object(s.a)(e,{customMessage:"部分红冲操作失败"})}finally{this.operating=!1}}else Object(s.c)("请输入部分红冲原因");else Object(s.c)("请上传Excel文件")},handleItineraryFileChange(e,t){if(!(e.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.itineraryFileList=t.filter(t=>t.uid!==e.uid));const i=e.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.itineraryFileList=t.filter(t=>t.uid!==e.uid));this.itineraryFileList=t},handleItineraryFileRemove(e,t){this.itineraryFileList=t},async confirmItineraryRedFlush(){if(this.itineraryFileList&&0!==this.itineraryFileList.length)if(this.itineraryRedFlushForm.reason&&""!==this.itineraryRedFlushForm.reason.trim()){this.operating=!0;try{const e=this.itineraryFileList[0].raw;console.log("行程单/火车票红冲文件:",e),console.log("红冲原因:",this.itineraryRedFlushForm.reason),console.log("申请编号:",this.currentRecord.applicationNo),console.log("发票类型:",this.currentRecord.invoiceType),await new Promise(e=>setTimeout(e,1e3)),Object(s.b)("红冲操作成功"),this.itineraryRedFlushDialogVisible=!1,this.itineraryFileList=[],this.itineraryRedFlushForm.reason="",this.$emit("refresh")}catch(e){Object(s.a)(e,{customMessage:"红冲操作失败"})}finally{this.operating=!1}}else Object(s.c)("请输入红冲原因");else Object(s.c)("请上传包含票号/订单信息的Excel文件")}}},w=(i(329),{name:"InvoiceSummaryContent",components:{InvoiceRecordTable:Object(r.a)(x,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"invoice-record-table"},[t("div",{staticClass:"table-header"},[t("div",{staticClass:"header-actions"},[e.selectedRecords.length>0?t("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:e.handleBatchDownload}},[e._v("\n        批量下载\n      ")]):e._e()],1)]),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.paginatedRecords,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),t("el-table-column",{attrs:{prop:"invoiceType",label:"发票类型",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(t.invoiceType)+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"content",label:"发票内容","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tooltip",{attrs:{content:i.content,placement:"top"}},[t("div",{staticClass:"text-ellipsis"},[e._v(e._s(i.content))])])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"amount",label:"开票金额",width:"120",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(e.formatAmount(t.amount))+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"titleName",label:"发票抬头",width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tooltip",{attrs:{content:"税号："+i.taxNumber,placement:"top"}},[t("div",{staticClass:"text-ellipsis"},[e._v(e._s(i.titleName))])])]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"submitter",label:"提交人",width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(t.submitter)+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"applyTime",label:"申请时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n        "+e._s(e.formatDate(t.applyTime))+"\n      ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tag",{attrs:{size:"small",type:e.getStatusType(i.status||(i.isFlushed?"flushed":"completed"))}},[e._v("\n          "+e._s(e.getStatusName(i.status||(i.isFlushed?"flushed":"completed")))+"\n        ")])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return["completed"===i.status||"flushed"===i.status?t("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(t){return e.handleDownload(i)}}},[e._v("\n          下载\n        ")]):e._e(),e._v(" "),"completed"!==i.status||i.isFlushed?e._e():t("el-link",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",underline:!1},on:{click:function(t){return e.handleRedFlush(i)}}},[e._v("\n          红冲\n        ")]),e._v(" "),e.isVATInvoice(i)&&"completed"===i.status&&!i.isFlushed?t("el-link",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",underline:!1},on:{click:function(t){return e.handlePartialRedFlush(i)}}},[e._v("\n          部分红冲\n        ")]):e._e()]}}])})],1),e._v(" "),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),t("el-dialog",{attrs:{title:"确认红冲",visible:e.redFlushDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.redFlushDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"warning-message"},[t("i",{staticClass:"el-icon-warning"}),e._v("\n        确认要对以下发票进行红冲操作吗？\n      ")]),e._v(" "),e.currentRecord?t("div",{staticClass:"record-info"},[t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("申请编号：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.applicationNo))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("发票类型：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.invoiceType))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("开票金额：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.formatAmount(e.currentRecord.amount)))])])]):e._e(),e._v(" "),t("el-form",{attrs:{model:e.redFlushForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"红冲原因"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入红冲原因"},model:{value:e.redFlushForm.reason,callback:function(t){e.$set(e.redFlushForm,"reason",t)},expression:"redFlushForm.reason"}})],1)],1),e._v(" "),t("p",{staticClass:"hint-message"},[e._v("红冲后该发票将作废，可以进行换开操作。")])],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.redFlushDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"warning",loading:e.operating},on:{click:e.confirmRedFlush}},[e._v("确定红冲")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:"换开发票",visible:e.reissueDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.reissueDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"info-message"},[t("i",{staticClass:"el-icon-info"}),e._v("\n        请填写新的发票抬头信息\n      ")]),e._v(" "),t("el-form",{ref:"reissueForm",attrs:{model:e.reissueForm,rules:e.reissueRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"发票抬头",prop:"titleName"}},[t("el-input",{attrs:{placeholder:"请输入发票抬头"},model:{value:e.reissueForm.titleName,callback:function(t){e.$set(e.reissueForm,"titleName",t)},expression:"reissueForm.titleName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"税号",prop:"taxNumber"}},[t("el-input",{attrs:{placeholder:"请输入税号"},model:{value:e.reissueForm.taxNumber,callback:function(t){e.$set(e.reissueForm,"taxNumber",t)},expression:"reissueForm.taxNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"地址电话"}},[t("el-input",{attrs:{placeholder:"请输入地址和电话"},model:{value:e.reissueForm.address,callback:function(t){e.$set(e.reissueForm,"address",t)},expression:"reissueForm.address"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"开户行"}},[t("el-input",{attrs:{placeholder:"请输入开户行"},model:{value:e.reissueForm.bankName,callback:function(t){e.$set(e.reissueForm,"bankName",t)},expression:"reissueForm.bankName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"银行账号"}},[t("el-input",{attrs:{placeholder:"请输入银行账号"},model:{value:e.reissueForm.bankAccount,callback:function(t){e.$set(e.reissueForm,"bankAccount",t)},expression:"reissueForm.bankAccount"}})],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.reissueDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.operating},on:{click:e.confirmReissue}},[e._v("确定换开")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:"部分红冲",visible:e.partialRedFlushDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.partialRedFlushDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"info-message"},[t("i",{staticClass:"el-icon-info"}),e._v("\n        请上传包含部分红冲信息的Excel文件（.xlsx格式）\n      ")]),e._v(" "),e.currentRecord?t("div",{staticClass:"record-info"},[t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("申请编号：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.applicationNo))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("发票类型：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.invoiceType))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("开票金额：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.formatAmount(e.currentRecord.amount)))])])]):e._e(),e._v(" "),t("el-form",{attrs:{model:e.partialRedFlushForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"上传文件",required:""}},[t("el-upload",{ref:"fileUpload",attrs:{"auto-upload":!1,"on-change":e.handleFileChange,"on-remove":e.handleFileRemove,limit:1,accept:".xlsx,.xls","file-list":e.fileList}},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[e._v("选择文件")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx/xls文件，且不超过10MB")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"红冲原因"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入部分红冲原因"},model:{value:e.partialRedFlushForm.reason,callback:function(t){e.$set(e.partialRedFlushForm,"reason",t)},expression:"partialRedFlushForm.reason"}})],1)],1),e._v(" "),t("p",{staticClass:"hint-message"},[e._v("部分红冲后，剩余金额仍可正常使用。")])],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.partialRedFlushDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"danger",loading:e.operating},on:{click:e.confirmPartialRedFlush}},[e._v("确定部分红冲")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.getItineraryRedFlushTitle(),visible:e.itineraryRedFlushDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.itineraryRedFlushDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"info-message"},[t("i",{staticClass:"el-icon-info"}),e._v("\n        请上传包含需要红冲的票号/订单信息的Excel文件（.xlsx格式）\n      ")]),e._v(" "),e.currentRecord?t("div",{staticClass:"record-info"},[t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("申请编号：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.applicationNo))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("发票类型：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.currentRecord.invoiceType))])]),e._v(" "),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("开票金额：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.formatAmount(e.currentRecord.amount)))])])]):e._e(),e._v(" "),t("el-form",{attrs:{model:e.itineraryRedFlushForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"上传文件",required:""}},[t("el-upload",{ref:"itineraryFileUpload",attrs:{"auto-upload":!1,"on-change":e.handleItineraryFileChange,"on-remove":e.handleItineraryFileRemove,limit:1,accept:".xlsx,.xls","file-list":e.itineraryFileList}},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[e._v("选择文件")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx/xls文件，且不超过10MB。文件需包含票号/订单号列")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"红冲原因"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入红冲原因"},model:{value:e.itineraryRedFlushForm.reason,callback:function(t){e.$set(e.itineraryRedFlushForm,"reason",t)},expression:"itineraryRedFlushForm.reason"}})],1)],1),e._v(" "),t("p",{staticClass:"hint-message"},[e._v("红冲后该发票将作废，可以进行换开操作。")])],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.itineraryRedFlushDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"warning",loading:e.operating},on:{click:e.confirmItineraryRedFlush}},[e._v("确定红冲")])],1)])],1)}),[],!1,null,"e0a3c4da",null).exports},props:{billNo:{type:String,required:!0}},data:()=>({loading:!1,activeTab:"unified",batchDownloadDialogVisible:!1,batchDownloadFilter:{invoiceType:"",titleName:"",submitter:""}}),computed:{...Object(a.c)("invoice",["invoiceSummary","applicationList","invoiceTitles"]),summary(){return{totalAmount:this.invoiceSummary.shouldInvoiceAmount||0,invoicedAmount:this.invoiceSummary.invoicedAmount||0,remainingAmount:this.invoiceSummary.remainingAmount||0,details:this.invoiceSummary.invoiceDetails||[]}},invoiceTypeOptions(){const e=new Set;return this.applicationList.forEach(t=>{t.invoiceType&&e.add(t.invoiceType)}),Array.from(e).map(e=>({label:e,value:e}))},titleNameOptions(){const e=new Set;return this.applicationList.forEach(t=>{t.titleName&&e.add(t.titleName)}),Array.from(e).map(e=>({label:e,value:e}))},submitterOptions(){const e=new Set;return this.applicationList.forEach(t=>{t.submitter&&e.add(t.submitter)}),Array.from(e).map(e=>({label:e,value:e}))},hasFilter(){return!!(this.batchDownloadFilter.invoiceType||this.batchDownloadFilter.titleName||this.batchDownloadFilter.submitter)}},created(){this.loadData()},methods:{...Object(a.b)("invoice",["fetchInvoiceSummary","fetchInvoiceApplications","downloadInvoice","redFlushInvoice","reissueInvoice"]),async loadData(){this.loading=!0;try{await Promise.all([this.fetchInvoiceSummary(this.billNo),this.fetchInvoiceApplications(this.billNo)])}catch(e){Object(s.a)(e,{customMessage:"加载开票数据失败"})}finally{this.loading=!1}},formatAmount:e=>Object(l.a)(e),formatDate:(e,t="YYYY-MM-DD HH:mm")=>Object(l.c)(e,t),getStatusName:e=>n.INVOICE_STATUS_NAMES[e]||"-",getStatusType:e=>n.INVOICE_STATUS_COLORS[e]||"",async handleDownload(e){try{this.loading=!0;const t=await this.downloadInvoice(e.applicationNo);t&&t.data&&t.data.fileUrl&&(Object(s.b)("发票下载成功！\n申请编号："+e.applicationNo),this.$message.info({message:"Demo环境：实际环境中将自动下载PDF文件到本地",duration:3e3}))}catch(e){Object(s.a)(e,{customMessage:"下载发票失败"})}finally{this.loading=!1}},async handleRedFlush(e){const{record:t,reason:i}=e;try{this.loading=!0,await this.redFlushInvoice({applicationNo:t.applicationNo,reason:i}),Object(s.b)("红冲操作成功"),await this.loadData()}catch(e){throw Object(s.a)(e,{customMessage:"红冲操作失败"}),e}finally{this.loading=!1}},async handleReissue(e){const{record:t,newTitle:i}=e;try{this.loading=!0,await this.reissueInvoice({applicationNo:t.applicationNo,newTitle:i}),Object(s.b)("换开操作成功"),await this.loadData()}catch(e){throw Object(s.a)(e,{customMessage:"换开操作失败"}),e}finally{this.loading=!1}},handleViewElectronicTickets(){Object(s.c)("查看数电票功能开发中")},handleBatchDownload(){this.batchDownloadFilter={invoiceType:"",titleName:"",submitter:""},this.batchDownloadDialogVisible=!0},async confirmBatchDownload(){try{const e=this.applicationList.filter(e=>(!this.batchDownloadFilter.invoiceType||e.invoiceType===this.batchDownloadFilter.invoiceType)&&((!this.batchDownloadFilter.titleName||e.titleName===this.batchDownloadFilter.titleName)&&(!this.batchDownloadFilter.submitter||e.submitter===this.batchDownloadFilter.submitter)));if(0===e.length)return void Object(s.c)("没有符合条件的发票可下载");this.loading=!0,console.log("批量下载筛选条件:",this.batchDownloadFilter),console.log("符合条件的记录数:",e.length),console.log("符合条件的记录:",e),await new Promise(e=>setTimeout(e,1e3)),Object(s.b)(`已选择 ${e.length} 条发票，开始批量下载`),this.batchDownloadDialogVisible=!1}catch(e){Object(s.a)(e,{customMessage:"批量下载失败"})}finally{this.loading=!1}},getFilteredCount(){return this.applicationList.filter(e=>(!this.batchDownloadFilter.invoiceType||e.invoiceType===this.batchDownloadFilter.invoiceType)&&((!this.batchDownloadFilter.titleName||e.titleName===this.batchDownloadFilter.titleName)&&(!this.batchDownloadFilter.submitter||e.submitter===this.batchDownloadFilter.submitter))).length}}}),C=(i(331),Object(r.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"invoice-summary-content"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._m(0),e._v(" "),t("div",{staticClass:"invoice-amount-summary"},[t("div",{staticClass:"amount-cards"},[t("div",{staticClass:"amount-card"},[t("div",{staticClass:"amount-label"},[e._v("应开票金额")]),e._v(" "),t("div",{staticClass:"amount-value"},[e._v(e._s(e.formatAmount(e.summary.totalAmount)))])]),e._v(" "),t("div",{staticClass:"amount-card"},[t("div",{staticClass:"amount-label"},[e._v("已开票金额")]),e._v(" "),t("div",{staticClass:"amount-value"},[e._v(e._s(e.formatAmount(e.summary.invoicedAmount)))])]),e._v(" "),t("div",{staticClass:"amount-card remaining-amount-card"},[t("div",{staticClass:"amount-label"},[e._v("还可提交金额")]),e._v(" "),t("div",{staticClass:"amount-value"},[e._v(e._s(e.formatAmount(e.summary.remainingAmount)))])])]),e._v(" "),t("div",{staticClass:"amount-details-table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.summary.details,border:"",size:"small"}},[t("el-table-column",{attrs:{prop:"type",label:"发票种类",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"summary",label:"发票摘要",width:"150"}}),e._v(" "),t("el-table-column",{attrs:{prop:"shouldAmount",label:"应开票金额",width:"130",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n              "+e._s(e.formatAmount(t.shouldAmount))+"\n            ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"invoicedAmount",label:"已开票金额",width:"130",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n              "+e._s(e.formatAmount(t.invoicedAmount))+"\n            ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"remainingAmount",label:"还可提交金额",width:"130",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n              "+e._s(e.formatAmount(t.remainingAmount))+"\n            ")]}}])})],1)],1)]),e._v(" "),t("div",{staticClass:"invoice-applications"},[t("div",{staticClass:"applications-header"},[t("h3",{staticClass:"section-title"},[e._v("开票申请记录")]),e._v(" "),t("div",{staticClass:"header-actions"},[t("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.handleBatchDownload}},[e._v("\n            批量下载发票\n          ")])],1)]),e._v(" "),t("invoice-record-table",{attrs:{records:e.applicationList,loading:e.loading},on:{download:e.handleDownload,"red-flush":e.handleRedFlush,reissue:e.handleReissue,refresh:e.loadData}})],1)]),e._v(" "),t("el-dialog",{attrs:{title:"批量下载发票",visible:e.batchDownloadDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){e.batchDownloadDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("p",{staticClass:"info-message"},[t("i",{staticClass:"el-icon-info"}),e._v("\n        请选择筛选条件，系统将下载符合条件的发票\n      ")]),e._v(" "),t("el-form",{attrs:{model:e.batchDownloadFilter,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"发票种类"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:e.batchDownloadFilter.invoiceType,callback:function(t){e.$set(e.batchDownloadFilter,"invoiceType",t)},expression:"batchDownloadFilter.invoiceType"}},e._l(e.invoiceTypeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"发票抬头"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:e.batchDownloadFilter.titleName,callback:function(t){e.$set(e.batchDownloadFilter,"titleName",t)},expression:"batchDownloadFilter.titleName"}},e._l(e.titleNameOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"申请人"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:e.batchDownloadFilter.submitter,callback:function(t){e.$set(e.batchDownloadFilter,"submitter",t)},expression:"batchDownloadFilter.submitter"}},e._l(e.submitterOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),e.hasFilter?t("div",{staticClass:"filter-preview"},[t("div",{staticClass:"preview-title"},[e._v("筛选结果预览")]),e._v(" "),t("div",{staticClass:"preview-content"},[t("p",[e._v("符合条件的发票数量："),t("strong",[e._v(e._s(e.getFilteredCount()))]),e._v(" 条")])])]):e._e()],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.batchDownloadDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmBatchDownload}},[e._v("确定下载")])],1)])],1)}),[function(){var e=this._self._c;return e("div",{staticClass:"summary-header"},[e("h2",{staticClass:"page-title"},[this._v("开票汇总")])])}],!1,null,"d059509a",null).exports),F=i(314),S=i(315),k={name:"BillDetail",components:{BillSummaryContent:d,BillOrdersTab:_,InvoiceSummaryContent:C,InvoiceForm:F.a,InvoiceSplitConfig:S.a},data(){return{billNo:this.$route.params.billNo,activeTab:"summary",confirmDialogVisible:!1,cancelDialogVisible:!1,submitting:!1,BILL_STATUS:n.BILL_STATUS,showInvoiceForm:!1,invoiceFormLoading:!1,invoiceRows:[],invoiceTitles:[],invoiceTotalAmount:0,invoiceRowCount:0,splitConfigVisible:!1,splitConfig:{dimensions:[]}}},computed:{...Object(a.c)("bill",["currentBill","loading"]),...Object(a.c)("order",["orderList"]),splitConfigured(){const e=this.$store.state.config.splitConfig;return e&&e.dimensions&&e.dimensions.length>0},billSummary(){return this.currentBill&&this.currentBill.summary},checkedOrderCount(){return this.billSummary&&this.billSummary.businessLineSummary?this.billSummary.businessLineSummary.reduce((e,t)=>e+(t.checkedCount||0),0):0},currentStep(){if(!this.currentBill)return 0;return{[n.BILL_STATUS.PENDING_CONFIRM]:0,[n.BILL_STATUS.ADJUSTING]:0,[n.BILL_STATUS.INVOICING]:1,[n.BILL_STATUS.PENDING_PAYMENT]:2,[n.BILL_STATUS.SETTLED]:3}[this.currentBill.billStatus]||0},invoicingSubStatus(){return this.showInvoiceForm?"填写开票信息":"invoice"===this.activeTab?"开票汇总":""},canSubmitInvoice(){if(0===this.invoiceRowCount||0===this.invoiceTotalAmount)return!1;return this.invoiceRows.filter(e=>{if(e.isGroup)return!0;const t=!(!e.invoiceType&&!e.invoiceTypeName),i=!(!e.titleId||!e.titleName),a=!!(e.receiverId&&e.receiverName&&e.receiverPhone&&e.receiverEmail&&e.receiverAddress),n=e.quantity>=1&&e.quantity<=99999;return t&&i&&a&&n}).length===this.invoiceRowCount}},async created(){await this.loadBillDetail(),await this.checkAndRestoreInvoicingState(),this.initActiveTab(),this.initSplitConfig()},methods:{...Object(a.b)("bill",["fetchBillDetail","confirmBill","cancelConfirm"]),...Object(a.b)("order",["fetchOrderList"]),async loadBillDetail(){try{await this.fetchBillDetail(this.billNo),await this.fetchOrderList(this.billNo)}catch(e){Object(s.a)(e,{customMessage:"加载账单详情失败"})}},async checkAndRestoreInvoicingState(){if(this.currentBill&&this.currentBill.billStatus===n.BILL_STATUS.INVOICING)try{const e=i(2).default,t=await e.getInvoiceApplications(this.billNo),a=t&&t.data&&t.data.list&&t.data.list.length>0;console.log("检查开票状态 - billStatus:",this.currentBill.billStatus),console.log("检查开票状态 - hasApplications:",a),a?(console.log("检测到开票中状态且有开票记录，显示开票汇总"),this.activeTab="invoice"):(console.log("检测到开票中状态且无开票记录，恢复开票信息表"),await this.proceedToInvoiceForm())}catch(e){console.warn("检查开票状态失败:",e)}},initSplitConfig(){const e=this.$store.state.config.splitConfig;if(e&&e.dimensions&&Array.isArray(e.dimensions)&&e.dimensions.length>0)this.splitConfig={dimension1:e.dimension1,dimension2:e.dimension2,dimensions:[...e.dimensions]};else if(e&&(e.dimension1||e.dimension2)){const t=[];e.dimension1&&t.push(e.dimension1),e.dimension2&&t.push(e.dimension2),this.splitConfig={dimension1:e.dimension1,dimension2:e.dimension2,dimensions:t}}else{const{SPLIT_DIMENSION:e}=i(0);this.splitConfig={dimension1:e.BUSINESS_LINE,dimension2:null,dimensions:[e.BUSINESS_LINE]}}console.log("初始化拆分汇总配置:",this.splitConfig)},initActiveTab(){this.currentBill&&(this.showInvoiceForm?this.activeTab="summary":this.$route.query.tab?this.activeTab=this.$route.query.tab:this.currentBill&&this.currentBill.billStatus>=n.BILL_STATUS.INVOICING?this.activeTab="invoice":this.activeTab="summary")},handleConfirmBill(){this.confirmDialogVisible=!0},async confirmBillAction(){this.submitting=!0;try{await this.confirmBill(this.billNo),Object(s.b)("账单确认成功，所有订单已标记为已核对"),this.confirmDialogVisible=!1,await new Promise(e=>setTimeout(e,100)),await this.loadBillDetail(),this.$forceUpdate(),await this.handleApplyInvoice()}catch(e){Object(s.a)(e,{customMessage:"账单确认失败"})}finally{this.submitting=!1}},handleCancelConfirm(){this.cancelDialogVisible=!0},async cancelConfirmAction(){this.submitting=!0;try{this.showInvoiceForm&&this.exitInvoiceForm(),await this.cancelConfirm(this.billNo),Object(s.b)("账单确认已撤销"),this.cancelDialogVisible=!1,await new Promise(e=>setTimeout(e,100)),await this.loadBillDetail(),this.$forceUpdate(),this.activeTab="summary"}catch(e){Object(s.a)(e,{customMessage:"撤销确认失败"})}finally{this.submitting=!1}},async handleApplyInvoice(){if(this.splitConfig||(this.splitConfig={dimensions:[]}),this.splitConfig.dimensions&&Array.isArray(this.splitConfig.dimensions)||(this.splitConfig.dimensions=[]),0===this.splitConfig.dimensions.length){const{SPLIT_DIMENSION:e}=i(0);this.splitConfig={dimensions:[e.BUSINESS_LINE]},await this.$store.dispatch("config/saveSplitConfig",{dimension1:e.BUSINESS_LINE,dimension2:null,dimensions:[e.BUSINESS_LINE]})}if(console.log("handleApplyInvoice - splitConfig:",this.splitConfig),this.currentBill.billStatus===n.BILL_STATUS.PENDING_INVOICE)try{const e=i(2).default;await e.startInvoicing(this.billNo),await this.loadBillDetail()}catch(e){console.error("开始开票失败:",e)}await this.proceedToInvoiceForm()},async proceedToInvoiceForm(){this.invoiceFormLoading=!0,this.showInvoiceForm=!0;try{await this.loadInvoiceData()}catch(e){Object(s.a)(e,{customMessage:"加载开票数据失败"}),this.showInvoiceForm=!1}finally{this.invoiceFormLoading=!1}},exitInvoiceForm(){this.showInvoiceForm=!1,this.invoiceRows=[]},handleCancelConfirmFromInvoice(){this.exitInvoiceForm(),this.handleCancelConfirm()},async loadInvoiceData(){try{const e=i(2).default,t=await e.getInvoiceTitles();if(!t||!t.data)throw new Error("获取发票抬头失败");this.invoiceTitles=t.data.list||[],console.log("loadInvoiceData - invoiceTitles:",this.invoiceTitles);const a=await e.getInvoiceSummary(this.billNo);if(!a||!a.data)throw new Error("获取开票汇总失败");const n=a.data;let l=this.splitConfig;if(l||(l={dimensions:[]}),!l.dimensions||!Array.isArray(l.dimensions))if(l.dimension1||l.dimension2){const e=[];l.dimension1&&e.push(l.dimension1),l.dimension2&&e.push(l.dimension2),l={...l,dimensions:e}}else{const{SPLIT_DIMENSION:e}=i(0);l={dimensions:[e.BUSINESS_LINE]}}const s=await e.generateInvoiceRows(this.billNo,l);if(!s||!s.data)throw new Error("生成开票行失败");let o=s.data||[];Array.isArray(o)||(console.warn("开票行数据格式不正确，使用空数组"),o=[]),console.log("loadInvoiceData - 原始 invoiceRows:",o.slice(0,2)),o=o.map((e,t)=>{let i=e.titleId||"",a=e.titleName||"",n=e.taxNumber||"";e.invoiceTitle&&"object"==typeof e.invoiceTitle&&(i=e.invoiceTitle.titleId||i,a=e.invoiceTitle.titleName||a,n=e.invoiceTitle.taxNumber||n);let l=e.receiverId||"",s=e.receiverName||"",o=e.receiverPhone||"",r=e.receiverEmail||"",c=e.receiverAddress||"";e.recipient&&"object"==typeof e.recipient&&(l=e.recipient.id||l,s=e.recipient.name||s,o=e.recipient.phone||o,r=e.recipient.email||r,c=e.recipient.address||c);return{id:e.id||"invoice_row_"+t,invoiceType:e.invoiceType||e.invoiceTypeName||"",invoiceTypeName:e.invoiceTypeName||e.invoiceType||"",summary:e.summary||e.invoiceSummary||"",invoiceSummary:e.invoiceSummary||e.summary||"",amount:e.amount||0,orderCount:e.orderCount||0,quantity:e.quantity||1,unit:e.unit||"元",titleId:i,titleName:a,taxNumber:n,receiverId:l,receiverName:s,receiverPhone:o,receiverEmail:r,receiverAddress:c,splitDimension1:e.splitDimension1||e.businessLine||"",splitDimension2:e.splitDimension2||e.legalEntity||"",businessLine:e.businessLine||e.splitDimension1||"",legalEntity:e.legalEntity||e.splitDimension2||"",paymentAccount:e.paymentAccount||e.splitDimension1||"",department:e.department||e.splitDimension2||"",isValid:void 0!==e.isValid&&e.isValid}}),n&&n.invoiceDetails&&n.invoiceDetails.length>0&&(o=o.map(e=>{const t=e.invoiceType||e.invoiceTypeName||"",i=e.invoiceSummary||e.summary||"",a=n.invoiceDetails.find(a=>{const n=t===a.type||String(t).includes(a.type)||a.type.includes(String(t))||e.invoiceTypeName===a.type,l=i===a.summary||i.includes(a.summary)||a.summary.includes(i);return n&&l});return a&&a.remainingAmount>0?{...e,amount:a.remainingAmount,orderCount:a.orderCount||e.orderCount}:e})),this.invoiceRows=o,console.log("loadInvoiceData - 最终 invoiceRows:",this.invoiceRows.slice(0,2)),this.updateInvoiceStats(),console.log("loadInvoiceData - 统计信息:",{rowCount:this.invoiceRowCount,totalAmount:this.invoiceTotalAmount})}catch(e){throw console.error("加载开票数据错误:",e),e}},updateInvoiceStats(){this.invoiceRowCount=this.invoiceRows.length,this.invoiceTotalAmount=this.invoiceRows.reduce((e,t)=>e+(t.amount||0),0)},handleInvoiceFormUpdate(e){e&&e.invoiceRows?this.invoiceRows=e.invoiceRows:Array.isArray(e)&&(this.invoiceRows=e),this.updateInvoiceStats()},async handleSubmitInvoice(e){try{await this.$confirm("请确认当期开票信息无误","确认提交",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch(e){return}this.submitting=!0;try{const t=i(2).default;await t.applyInvoice({billNo:this.billNo,invoiceRows:e||this.invoiceRows}),Object(s.b)("开票申请提交成功"),this.exitInvoiceForm(),await new Promise(e=>setTimeout(e,100)),await Promise.all([this.loadBillDetail(),this.$store.dispatch("invoice/fetchInvoiceSummary",this.billNo),this.$store.dispatch("invoice/fetchInvoiceApplications",this.billNo)]),this.$forceUpdate(),this.activeTab="invoice"}catch(e){Object(s.a)(e,{customMessage:"提交开票申请失败"})}finally{this.submitting=!1}},handleDetailSettings(){this.splitConfigVisible=!0},openSplitConfig(){this.splitConfigVisible=!0},async handleSaveSplitConfig(e){try{const t=[];e.dimension1&&t.push(e.dimension1),e.dimension2&&t.push(e.dimension2),await this.$store.dispatch("config/saveSplitConfig",e),this.splitConfig={...e,dimensions:t},this.splitConfigVisible=!1,Object(s.b)("拆分汇总配置已保存"),this.currentBill&&this.currentBill.billStatus===n.BILL_STATUS.INVOICING?await this.proceedToInvoiceForm():this.showInvoiceForm||await this.loadBillDetail()}catch(e){Object(s.a)(e,{customMessage:"保存拆分汇总配置失败"})}},handleExportExcel(){Object(s.c)("导出Excel功能将在User Story 4实现")},handleExportPDF(){Object(s.c)("导出PDF功能将在User Story 4实现")},handleExportInvoiceInfo(){},formatBillCycleRange(e){return e?Object(l.b)(e,this.currentBill):"-"},formatAmount:e=>Object(l.a)(e),getBillStatusName:e=>n.BILL_STATUS_NAMES[e]||"-",getBillStatusType:e=>n.BILL_STATUS_COLORS[e]||"",formatDate:(e,t="YYYY-MM-DD")=>Object(l.c)(e,t)}},T=(i(339),Object(r.a)(k,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bill-detail-page"},[t("div",{staticClass:"breadcrumb-container"},[t("span",{staticClass:"breadcrumb-item",on:{click:function(t){return e.$router.back()}}},[e._v("账单列表")]),e._v(" "),t("span",{staticClass:"breadcrumb-separator"},[e._v(">")]),e._v(" "),t("span",{staticClass:"breadcrumb-item active"},[e._v("账单详情")])]),e._v(" "),e.loading?t("div",{staticClass:"loading-container"},[t("el-skeleton",{attrs:{rows:8,animated:""}})],1):e.currentBill?t("div",{staticClass:"bill-content"},[t("el-card",{staticClass:"steps-card",attrs:{shadow:"never"}},[t("el-steps",{attrs:{active:e.currentStep,"finish-status":"success","align-center":""}},[t("el-step",{attrs:{title:"确认账单"}},[e.currentBill&&e.currentBill.confirmTime?[t("div",{staticClass:"step-description",attrs:{slot:"description"},slot:"description"},[e._v("\n              确认日期: "+e._s(e.formatDate(e.currentBill.confirmTime,"YYYY-MM-DD"))+"\n            ")])]:e._e()],2),e._v(" "),t("el-step",{attrs:{title:"开票"}},[e.currentBill&&e.currentBill.billStatus===e.BILL_STATUS.INVOICING?[t("div",{staticClass:"step-description",attrs:{slot:"description"},slot:"description"},[e._v("\n              "+e._s(e.invoicingSubStatus)+"\n            ")])]:e._e()],2),e._v(" "),t("el-step",{attrs:{title:"付款"}}),e._v(" "),t("el-step",{attrs:{title:"已结清"}})],1)],1),e._v(" "),e.splitConfigured?e._e():t("div",{staticClass:"split-config-banner"},[t("span",[e._v("建议配置拆分汇总维度以更准确地生成开票信息")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openSplitConfig}},[e._v("立即配置")])],1),e._v(" "),t("el-card",{staticClass:"action-card",attrs:{shadow:"never"}},[t("div",{staticClass:"action-header"},[t("div",{staticClass:"date-range"},[t("i",{staticClass:"el-icon-date"}),e._v("\n          "+e._s(e.formatBillCycleRange(e.currentBill.settlementCycle))+"\n        ")]),e._v(" "),t("div",{staticClass:"action-buttons"},[e.currentBill.billStatus===e.BILL_STATUS.PENDING_CONFIRM?t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.handleConfirmBill}},[e._v("\n            确认账单\n          ")]):e.showInvoiceForm?[t("el-button",{on:{click:e.handleCancelConfirm}},[e._v("撤销确认")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.handleExportInvoiceInfo}},[e._v("导出开票信息")])]:e.currentBill.billStatus===e.BILL_STATUS.PENDING_PAYMENT?[t("el-tag",{attrs:{type:"success"}},[e._v("开票完成")])]:e._e(),e._v(" "),t("el-button",{attrs:{icon:"el-icon-folder-opened"},on:{click:e.handleDetailSettings}},[e._v("拆分汇总")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.handleExportExcel}},[e._v("导出全部Excel")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.handleExportPDF}},[e._v("导出全部PDF")])],2)])]),e._v(" "),e.showInvoiceForm?t("el-card",{staticClass:"tabs-card",attrs:{shadow:"never"}},[t("div",{staticClass:"invoice-apply-header"},[t("h3",{staticClass:"section-title"},[e._v("开票信息表")])]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.invoiceFormLoading,expression:"invoiceFormLoading"}],staticClass:"invoice-apply-content"},[t("invoice-form",{ref:"invoiceForm",attrs:{"bill-no":e.billNo,"invoice-rows":e.invoiceRows,titles:e.invoiceTitles,"split-config":e.splitConfig},on:{update:e.handleInvoiceFormUpdate,cancel:e.handleCancelConfirmFromInvoice,submit:e.handleSubmitInvoice}})],1)]):t("el-card",{staticClass:"tabs-card",attrs:{shadow:"never"}},[t("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.currentBill.billStatus>=e.BILL_STATUS.INVOICING?t("el-tab-pane",{attrs:{label:"开票汇总",name:"invoice"}},[t("invoice-summary-content",{attrs:{"bill-no":e.billNo}})],1):e._e(),e._v(" "),e.currentBill.billStatus<e.BILL_STATUS.PENDING_PAYMENT?t("el-tab-pane",{attrs:{label:"账单汇总",name:"summary"}},[t("bill-summary-content",{attrs:{bill:e.currentBill}})],1):e._e(),e._v(" "),e.currentBill.billStatus<e.BILL_STATUS.PENDING_PAYMENT?t("el-tab-pane",{attrs:{label:"账单明细",name:"orders"}},[t("bill-orders-tab",{attrs:{"bill-no":e.billNo,"bill-status":e.currentBill.billStatus}})],1):e._e()],1)],1)],1):e._e(),e._v(" "),t("el-dialog",{attrs:{title:"确认账单",visible:e.confirmDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.confirmDialogVisible=t}}},[t("div",{staticClass:"confirm-dialog-content"},[t("p",{staticClass:"confirm-message"},[e._v("\n        是否确认 "),t("strong",[e._v(e._s(e.formatBillCycleRange(e.currentBill&&e.currentBill.settlementCycle)))]),e._v(" 账单金额无误？\n      ")]),e._v(" "),t("div",{staticClass:"confirm-amount"},[t("div",{staticClass:"amount-item"},[t("span",{staticClass:"label"},[e._v("账单总额：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.formatAmount(e.currentBill&&e.currentBill.totalAmount)))])]),e._v(" "),t("div",{staticClass:"amount-item"},[t("span",{staticClass:"label"},[e._v("订单数量：")]),e._v(" "),t("span",{staticClass:"value"},[e._v(e._s(e.billSummary&&e.billSummary.totalCount)+"笔")])])]),e._v(" "),t("p",{staticClass:"confirm-hint"},[e._v("确认后账单将进入开票流程，请仔细核对数据。")])]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.confirmDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.confirmBillAction}},[e._v("确定")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:"撤销确认",visible:e.cancelDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.cancelDialogVisible=t}}},[t("div",{staticClass:"confirm-dialog-content"},[t("p",{staticClass:"confirm-message"},[e._v("\n        撤销确认后，账单状态将回退到 "),t("strong",[e._v("待确认")]),e._v("，是否继续？\n      ")]),e._v(" "),t("p",{staticClass:"confirm-hint warn"},[e._v("此操作不可恢复，请谨慎操作。")])]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.cancelDialogVisible=!1}}},[e._v("取消")]),e._v(" "),t("el-button",{attrs:{type:"warning",loading:e.submitting},on:{click:e.cancelConfirmAction}},[e._v("确定")])],1)]),e._v(" "),t("invoice-split-config",{attrs:{"current-config":e.splitConfig},on:{save:e.handleSaveSplitConfig},model:{value:e.splitConfigVisible,callback:function(t){e.splitConfigVisible=t},expression:"splitConfigVisible"}})],1)}),[],!1,null,"c1442712",null));t.default=T.exports},344:function(e,t,i){"use strict";i.r(t);var a=i(33),n=i(0),l=i(160),s=(i(161),{name:"BillList",data:()=>({filterForm:{dateRange:null,status:null,billNo:""},companyInfo:{id:"C001",name:"示例科技有限公司",fullName:"北京示例科技有限公司"}}),computed:{...Object(a.c)("bill",["billList","loading","pagination"]),billStatusNames:()=>n.BILL_STATUS_NAMES},created(){this.initDefaultDateRange(),this.loadBillList()},methods:{...Object(a.b)("bill",["fetchBillList"]),initDefaultDateRange(){const e=new Date,t=new Date;t.setMonth(t.getMonth()-3),this.filterForm.dateRange=[this.formatMonthString(t),this.formatMonthString(e)]},formatMonthString:e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`,async loadBillList(){const e={page:this.pagination.page,pageSize:this.pagination.pageSize};this.filterForm.dateRange&&2===this.filterForm.dateRange.length&&(e.startCycle=this.filterForm.dateRange[0],e.endCycle=this.filterForm.dateRange[1]),null!==this.filterForm.status&&void 0!==this.filterForm.status&&(e.status=this.filterForm.status),this.filterForm.billNo&&this.filterForm.billNo.trim()&&(e.billNo=this.filterForm.billNo.trim()),await this.fetchBillList(e)},handleSearch(){this.$store.commit("bill/SET_PAGINATION",{page:1}),this.loadBillList()},handleReset(){this.filterForm.status=null,this.filterForm.billNo="",this.initDefaultDateRange(),this.handleSearch()},handleRowClick(e){this.handleViewDetail(e)},handleViewDetail(e){this.$router.push({name:"BillDetail",params:{billNo:e.billNo}})},handleSizeChange(e){this.$store.commit("bill/SET_PAGINATION",{pageSize:e,page:1}),this.loadBillList()},handleCurrentChange(e){this.$store.commit("bill/SET_PAGINATION",{page:e}),this.loadBillList()},formatCycle:e=>Object(l.b)(e.settlementCycle,e),formatAmountValue:e=>Object(l.a)(e),formatDate:e=>Object(l.c)(e,"YYYY-MM-DD"),getBillStatusName:e=>n.BILL_STATUS_NAMES[e]||"-",getBillStatusType:e=>n.BILL_STATUS_COLORS[e]||""}}),o=(i(317),i(12)),r=Object(o.a)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"bill-list-page"},[t("div",{staticClass:"page-header"},[t("h1",{staticClass:"page-title"},[e._v("账单列表")]),e._v(" "),t("div",{staticClass:"company-info"},[t("span",{staticClass:"company-name"},[e._v(e._s(e.companyInfo.name))]),e._v(" "),t("span",{staticClass:"company-divider"},[e._v("|")]),e._v(" "),t("span",{staticClass:"company-id"},[e._v("企业ID: "+e._s(e.companyInfo.id))])])]),e._v(" "),t("el-card",{staticClass:"filter-card",attrs:{shadow:"never"}},[t("el-form",{attrs:{inline:!0,model:e.filterForm,size:"small","label-width":"80px"}},[t("el-form-item",{attrs:{label:"结算周期"}},[t("el-date-picker",{attrs:{type:"monthrange","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份",format:"yyyy-MM","value-format":"yyyy-MM"},on:{change:e.handleSearch},model:{value:e.filterForm.dateRange,callback:function(t){e.$set(e.filterForm,"dateRange",t)},expression:"filterForm.dateRange"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"账单状态"}},[t("el-select",{attrs:{placeholder:"全部状态",clearable:""},on:{change:e.handleSearch},model:{value:e.filterForm.status,callback:function(t){e.$set(e.filterForm,"status",t)},expression:"filterForm.status"}},e._l(e.billStatusNames,(function(e,i){return t("el-option",{key:i,attrs:{label:e,value:parseInt(i)}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"账单号"}},[t("el-input",{attrs:{placeholder:"请输入账单号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.filterForm.billNo,callback:function(t){e.$set(e.filterForm,"billNo",t)},expression:"filterForm.billNo"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("\n          查询\n        ")]),e._v(" "),t("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:e.handleReset}},[e._v("\n          重置\n        ")])],1)],1)],1),e._v(" "),t("el-card",{staticClass:"table-card",attrs:{shadow:"never"}},[t("div",{staticClass:"table-header"},[t("div",{staticClass:"result-info"},[e._v("\n        共 "),t("span",{staticClass:"highlight"},[e._v(e._s(e.pagination.total))]),e._v(" 条账单\n      ")])]),e._v(" "),!e.loading&&e.billList.length>0?t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"bill-table",staticStyle:{width:"100%"},attrs:{data:e.billList,border:""},on:{"row-click":e.handleRowClick}},[t("el-table-column",{attrs:{prop:"billNo",label:"账单号",width:"180",fixed:"left"}}),e._v(" "),t("el-table-column",{attrs:{prop:"settlementCycle",label:"结算周期",formatter:e.formatCycle}}),e._v(" "),t("el-table-column",{attrs:{prop:"billStatus",label:"账单状态",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tag",{attrs:{type:e.getBillStatusType(i.billStatus),size:"small"}},[e._v("\n            "+e._s(e.getBillStatusName(i.billStatus))+"\n          ")])]}}],null,!1,1790112285)}),e._v(" "),t("el-table-column",{attrs:{prop:"totalAmount",label:"账单总额",width:"140",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("span",{staticClass:"amount-text"},[e._v(e._s(e.formatAmountValue(i.totalAmount)))])]}}],null,!1,3636474133)}),e._v(" "),t("el-table-column",{attrs:{prop:"invoicedAmount",label:"已开票金额",width:"140",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("span",{staticClass:"amount-text"},[e._v(e._s(e.formatAmountValue(i.invoicedAmount||0)))])]}}],null,!1,2917599026)}),e._v(" "),t("el-table-column",{attrs:{prop:"pendingInvoiceAmount",label:"待开票金额",width:"140",align:"right"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("span",{staticClass:"amount-text"},[e._v(e._s(e.formatAmountValue(i.pendingInvoiceAmount||i.totalAmount)))])]}}],null,!1,2372410995)}),e._v(" "),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function({row:t}){return[e._v("\n          "+e._s(e.formatDate(t.createTime))+"\n        ")]}}],null,!1,294772984)}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return t.stopPropagation(),e.handleViewDetail(i)}}},[e._v("\n            查看\n          ")])]}}],null,!1,3883020325)})],1):e._e(),e._v(" "),e.loading||0!==e.billList.length?e._e():t("div",{staticClass:"empty-state"},[t("i",{staticClass:"el-icon-document"}),e._v(" "),t("p",[e._v("暂无账单数据")]),e._v(" "),t("p",{staticClass:"empty-hint"},[e._v("\n        "+e._s(e.filterForm.dateRange||null!==e.filterForm.status?"请尝试调整筛选条件":"还没有生成账单包")+"\n      ")])]),e._v(" "),!e.loading&&e.billList.length>0?t("div",{staticClass:"pagination-wrapper"},[t("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.pageSize,"page-sizes":[10,20,50,100],total:e.pagination.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)}),[],!1,null,"2ff261ab",null);t.default=r.exports}}]);