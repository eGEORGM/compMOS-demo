(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{300:function(t,e,i){var a=i(18),n=i(319);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},301:function(t,e,i){var a=i(18),n=i(321);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},302:function(t,e,i){var a=i(18),n=i(323);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},303:function(t,e,i){var a=i(18),n=i(325);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},304:function(t,e,i){var a=i(18),n=i(327);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},305:function(t,e,i){var a=i(18),n=i(329);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},307:function(t,e,i){var a=i(18),n=i(331);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},308:function(t,e,i){var a=i(18),n=i(333);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},309:function(t,e,i){var a=i(18),n=i(335);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},313:function(t,e,i){var a=i(18),n=i(343);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var l={insert:"head",singleton:!1};a(n,l);t.exports=n.locals||{}},318:function(t,e,i){"use strict";i(300)},319:function(t,e,i){(e=i(19)(!1)).push([t.i,".bill-list-page[data-v-f8f5f072] {\n  padding: 24px;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n.bill-list-page .page-header[data-v-f8f5f072] {\n  background: #ffffff;\n  padding: 24px 32px;\n  border-radius: 4px;\n  margin-bottom: 16px;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.08);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.bill-list-page .page-header .page-title[data-v-f8f5f072] {\n  font-size: 24px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.bill-list-page .page-header .company-info[data-v-f8f5f072] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 14px;\n}\n.bill-list-page .page-header .company-info .company-name[data-v-f8f5f072] {\n  color: #303133;\n  font-weight: 500;\n}\n.bill-list-page .page-header .company-info .company-divider[data-v-f8f5f072] {\n  color: #c0c4cc;\n}\n.bill-list-page .page-header .company-info .company-id[data-v-f8f5f072] {\n  color: #909399;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] {\n  margin-bottom: 16px;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-card__body {\n  padding: 16px 24px;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-form {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: flex-start;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-form-item {\n  margin-bottom: 8px;\n  margin-right: 40px;\n  margin-left: 0;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-date-editor {\n  width: 300px;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-date-editor.el-range-editor .el-range-separator {\n  flex-shrink: 0;\n  min-width: 32px;\n  padding: 0 6px;\n  text-align: center;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-select {\n  width: 150px;\n}\n.bill-list-page .filter-card[data-v-f8f5f072] .el-input {\n  width: 200px;\n}\n.bill-list-page .table-card[data-v-f8f5f072] .el-card__body {\n  padding: 24px;\n}\n.bill-list-page .table-card .table-header[data-v-f8f5f072] {\n  margin-bottom: 16px;\n}\n.bill-list-page .table-card .table-header .result-info[data-v-f8f5f072] {\n  font-size: 14px;\n  color: #909399;\n}\n.bill-list-page .table-card .table-header .result-info .highlight[data-v-f8f5f072] {\n  color: #2555FF;\n  font-weight: 600;\n  font-size: 16px;\n}\n.bill-list-page .table-card .bill-table[data-v-f8f5f072] .el-table__row {\n  cursor: pointer;\n}\n.bill-list-page .table-card .bill-table[data-v-f8f5f072] .el-table__row:hover {\n  background-color: #f5f7fa;\n}\n.bill-list-page .table-card .bill-table .amount-text[data-v-f8f5f072] {\n  font-weight: 500;\n  color: #303133;\n}\n.bill-list-page .table-card .bill-table[data-v-f8f5f072] .el-button--text {\n  font-size: 14px;\n  font-weight: normal;\n}\n.bill-list-page .table-card .empty-state[data-v-f8f5f072] {\n  text-align: center;\n  padding: 48px 0;\n}\n.bill-list-page .table-card .empty-state i[data-v-f8f5f072] {\n  font-size: 64px;\n  color: #c0c4cc;\n  margin-bottom: 24px;\n}\n.bill-list-page .table-card .empty-state p[data-v-f8f5f072] {\n  font-size: 16px;\n  color: #909399;\n  margin: 8px 0;\n}\n.bill-list-page .table-card .empty-state p.empty-hint[data-v-f8f5f072] {\n  font-size: 14px;\n  color: #c0c4cc;\n}\n.bill-list-page .table-card .pagination-wrapper[data-v-f8f5f072] {\n  margin-top: 24px;\n  display: flex;\n  justify-content: flex-end;\n}\n",""]),t.exports=e},320:function(t,e,i){"use strict";i(301)},321:function(t,e,i){(e=i(19)(!1)).push([t.i,".detail-settings-content .settings-description[data-v-11cf980b] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #909399;\n  font-size: 13px;\n}\n.detail-settings-content .settings-description i[data-v-11cf980b] {\n  color: #2555FF;\n  font-size: 16px;\n}\n.detail-settings-content .settings-form[data-v-11cf980b] {\n  margin-bottom: 24px;\n}\n.detail-settings-content .settings-form .form-hint[data-v-11cf980b] {\n  color: #c0c4cc;\n  font-size: 13px;\n  margin-top: 4px;\n}\n.detail-settings-content .settings-form .dimension-order[data-v-11cf980b] {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  min-height: 32px;\n  align-items: center;\n}\n.detail-settings-content .settings-form .dimension-order .el-tag[data-v-11cf980b] {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n.detail-settings-content .settings-form .dimension-order .el-tag .order-number[data-v-11cf980b] {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  background: #2555FF;\n  color: #ffffff;\n  border-radius: 50%;\n  font-size: 13px;\n  margin-left: 4px;\n}\n.detail-settings-content .settings-form .dimension-order .empty-hint[data-v-11cf980b] {\n  color: #c0c4cc;\n  font-size: 13px;\n}\n.detail-settings-content .settings-preview[data-v-11cf980b] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n}\n.detail-settings-content .settings-preview .preview-title[data-v-11cf980b] {\n  font-weight: 600;\n  color: #303133;\n  margin-bottom: 16px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node[data-v-11cf980b] {\n  padding: 8px 16px;\n  margin-bottom: 4px;\n  background: #ffffff;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node i[data-v-11cf980b] {\n  color: #2555FF;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-0[data-v-11cf980b] {\n  font-weight: 600;\n  color: #303133;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-1[data-v-11cf980b] {\n  margin-left: 24px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-2[data-v-11cf980b] {\n  margin-left: 32px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-3[data-v-11cf980b] {\n  margin-left: 48px;\n}\n.detail-settings-content .settings-preview .preview-content .preview-tree .tree-node.level-4[data-v-11cf980b] {\n  margin-left: calc(48px + 24px);\n}\n.detail-settings-content .settings-preview .preview-content .preview-empty[data-v-11cf980b] {\n  text-align: center;\n  padding: 32px;\n  color: #c0c4cc;\n}\n",""]),t.exports=e},322:function(t,e,i){"use strict";i(302)},323:function(t,e,i){(e=i(19)(!1)).push([t.i,'.bill-summary-content .amount-header[data-v-85907336] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #2555FF 0%, #5580FF 100%);\n  color: #ffffff;\n  border-radius: 8px;\n  margin-bottom: 24px;\n}\n.bill-summary-content .amount-header .amount-info[data-v-85907336] {\n  display: flex;\n  align-items: baseline;\n  gap: 8px;\n}\n.bill-summary-content .amount-header .amount-info .amount-label[data-v-85907336] {\n  font-size: 14px;\n  opacity: 0.95;\n}\n.bill-summary-content .amount-header .amount-info .amount-value[data-v-85907336] {\n  font-size: 20px;\n  font-weight: 600;\n  letter-spacing: 0.5px;\n}\n.bill-summary-content .amount-header[data-v-85907336] .el-button--text {\n  color: #ffffff;\n  font-size: 14px;\n}\n.bill-summary-content .amount-header[data-v-85907336] .el-button--text:hover {\n  color: #ffffff;\n  opacity: 0.9;\n}\n.bill-summary-content .detail-section[data-v-85907336],\n.bill-summary-content .order-stats-section[data-v-85907336] {\n  margin-bottom: 24px;\n}\n.bill-summary-content .detail-section .detail-header[data-v-85907336],\n.bill-summary-content .order-stats-section .detail-header[data-v-85907336] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.bill-summary-content .detail-section .detail-header .section-title[data-v-85907336],\n.bill-summary-content .order-stats-section .detail-header .section-title[data-v-85907336] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #333333;\n  margin: 0;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336],\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] {\n  background: #ffffff;\n  border: 1px solid #e8e8e8;\n  border-radius: 8px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree {\n  background: #ffffff;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__content {\n  height: 48px;\n  border-bottom: 1px solid #f0f0f0;\n  padding-right: 16px;\n  background: #ffffff;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__content:hover,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__content:hover {\n  background: #fafafa;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__expand-icon,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__expand-icon {\n  color: #999999;\n  font-size: 12px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__expand-icon.is-leaf,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node__expand-icon.is-leaf {\n  visibility: hidden;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node {\n  flex: 1;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-label,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-label .node-name,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-label .node-name {\n  font-weight: 400;\n  color: #333333;\n  font-size: 14px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats {\n  display: flex;\n  align-items: center;\n  gap: 24px;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats .node-amount,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats .node-amount {\n  font-weight: 500;\n  color: #333333;\n  font-size: 14px;\n  min-width: 120px;\n  text-align: right;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats .node-count,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .custom-tree-node .node-stats .node-count {\n  color: #999999;\n  font-size: 12px;\n  min-width: 60px;\n  text-align: right;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="2"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="2"] > .el-tree-node__content {\n  padding-left: 32px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="3"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="3"] > .el-tree-node__content {\n  padding-left: 64px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="4"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="4"] > .el-tree-node__content {\n  padding-left: 96px !important;\n}\n.bill-summary-content .detail-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="5"] > .el-tree-node__content,\n.bill-summary-content .order-stats-section .detail-tree[data-v-85907336] .custom-tree .el-tree-node[aria-level="5"] > .el-tree-node__content {\n  padding-left: 128px !important;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card[data-v-85907336],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card[data-v-85907336] {\n  background: #ffffff;\n  border: 1px solid #e8e8e8;\n  border-radius: 8px;\n  padding: 16px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-header[data-v-85907336],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-header[data-v-85907336] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-header .stat-name[data-v-85907336],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-header .stat-name[data-v-85907336] {\n  font-size: 14px;\n  color: #666666;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-amount[data-v-85907336],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-amount[data-v-85907336] {\n  font-size: 20px;\n  font-weight: 600;\n  color: #333333;\n  margin-bottom: 4px;\n}\n.bill-summary-content .detail-section .business-stats-default .stat-card .stat-count[data-v-85907336],\n.bill-summary-content .order-stats-section .business-stats-default .stat-card .stat-count[data-v-85907336] {\n  font-size: 12px;\n  color: #999999;\n}\n.bill-summary-content .detail-section .section-title[data-v-85907336],\n.bill-summary-content .order-stats-section .section-title[data-v-85907336] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #333333;\n  margin-bottom: 16px;\n  padding-bottom: 8px;\n  border-bottom: 2px solid #e8e8e8;\n}\n.bill-summary-content .detail-section .stat-item[data-v-85907336],\n.bill-summary-content .order-stats-section .stat-item[data-v-85907336] {\n  background: #fafafa;\n  padding: 16px;\n  border-radius: 8px;\n  text-align: center;\n}\n.bill-summary-content .detail-section .stat-item .stat-label[data-v-85907336],\n.bill-summary-content .order-stats-section .stat-item .stat-label[data-v-85907336] {\n  font-size: 12px;\n  color: #666666;\n  margin-bottom: 4px;\n}\n.bill-summary-content .detail-section .stat-item .stat-number[data-v-85907336],\n.bill-summary-content .order-stats-section .stat-item .stat-number[data-v-85907336] {\n  font-size: 24px;\n  font-weight: 600;\n  color: #2555FF;\n}\n',""]),t.exports=e},324:function(t,e,i){"use strict";i(303)},325:function(t,e,i){(e=i(19)(!1)).push([t.i,".field-config-content .config-section[data-v-5fd71556] {\n  padding: 16px 0;\n}\n.field-config-content .config-section .section-description[data-v-5fd71556] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  margin-bottom: 24px;\n  color: #909399;\n  font-size: 13px;\n}\n.field-config-content .config-section .section-description i[data-v-5fd71556] {\n  font-size: 16px;\n}\n.field-config-content .config-section .section-description i.el-icon-info[data-v-5fd71556] {\n  color: #2555FF;\n}\n.field-config-content .config-section .section-description i.el-icon-warning[data-v-5fd71556] {\n  color: #e6a23c;\n}\n.field-config-content .config-section[data-v-5fd71556] .el-transfer {\n  display: flex;\n  justify-content: center;\n}\n.field-config-content .config-section[data-v-5fd71556] .el-transfer .el-transfer-panel {\n  width: 300px;\n}\n.field-config-content .config-section .error-hint[data-v-5fd71556] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-top: 16px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  color: #909399;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.field-config-content .config-section .error-hint i[data-v-5fd71556] {\n  color: #2555FF;\n  font-size: 18px;\n}\n",""]),t.exports=e},326:function(t,e,i){"use strict";i(304)},327:function(t,e,i){(e=i(19)(!1)).push([t.i,".order-list-content .filter-section[data-v-59975cce] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 16px;\n}\n.order-list-content .filter-section[data-v-59975cce] .el-form-item {\n  margin-bottom: 0;\n}\n.order-list-content .toolbar-section[data-v-59975cce] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n.order-list-content .toolbar-section .toolbar-left[data-v-59975cce] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n.order-list-content .toolbar-section .toolbar-left .selection-info[data-v-59975cce] {\n  color: #909399;\n  font-size: 13px;\n}\n.order-list-content .toolbar-section .toolbar-actions[data-v-59975cce] {\n  display: flex;\n  gap: 8px;\n}\n.order-list-content .toolbar-section .toolbar-actions[data-v-59975cce] .el-button.is-disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n.order-list-content[data-v-59975cce] .el-table {\n  border: none;\n}\n.order-list-content[data-v-59975cce] .el-table::before {\n  display: none;\n}\n.order-list-content[data-v-59975cce] .el-table::after {\n  display: none;\n}\n.order-list-content[data-v-59975cce] .el-table th,\n.order-list-content[data-v-59975cce] .el-table td {\n  border-right: none;\n}\n.order-list-content[data-v-59975cce] .el-table th.el-table__cell {\n  background: #fafafa;\n  color: #303133;\n  font-weight: 600;\n  border-bottom: 1px solid #e8e8e8;\n}\n.order-list-content[data-v-59975cce] .el-table .el-table__body tr:hover > td {\n  background-color: #f5f7fa;\n}\n.order-list-content[data-v-59975cce] .el-table .el-table__body td {\n  border-bottom: 1px solid #f0f0f0;\n}\n.order-list-content[data-v-59975cce] .el-table .el-table__row--striped td {\n  background: #fafafa;\n}\n.order-list-content .summary-footer[data-v-59975cce] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-top: 16px;\n}\n.order-list-content .summary-footer .summary-item[data-v-59975cce] {\n  text-align: center;\n}\n.order-list-content .summary-footer .summary-item .label[data-v-59975cce] {\n  font-size: 13px;\n  color: #909399;\n  margin-right: 4px;\n}\n.order-list-content .summary-footer .summary-item .value[data-v-59975cce] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n}\n.order-list-content .summary-footer .summary-item .value.primary[data-v-59975cce] {\n  color: #2555FF;\n}\n.order-list-content .summary-footer .summary-item .value.success[data-v-59975cce] {\n  color: #67c23a;\n}\n.order-list-content .summary-footer .summary-item .value.warning[data-v-59975cce] {\n  color: #e6a23c;\n}\n.order-list-content .dialog-content .info-message[data-v-59975cce] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  color: #909399;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.order-list-content .dialog-content .info-message i[data-v-59975cce] {\n  color: #2555FF;\n  font-size: 18px;\n}\n.order-list-content .dialog-content .el-upload__tip[data-v-59975cce] {\n  color: #c0c4cc;\n  font-size: 13px;\n  margin-top: 4px;\n}\n",""]),t.exports=e},328:function(t,e,i){"use strict";i(305)},329:function(t,e,i){(e=i(19)(!1)).push([t.i,".bill-orders-tab[data-v-040b150f] .el-tabs__header {\n  margin-bottom: 24px;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header {\n  border-bottom: 1px solid #dcdfe6;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item {\n  border-left: 1px solid #dcdfe6;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item:first-child {\n  border-left: none;\n}\n.bill-orders-tab[data-v-040b150f] .el-tabs--card > .el-tabs__header .el-tabs__item.is-active {\n  color: #2555FF;\n  background-color: #ffffff;\n}\n.bill-orders-tab .empty-state[data-v-040b150f] {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  min-height: 400px;\n  color: #909399;\n}\n.bill-orders-tab .empty-state i[data-v-040b150f] {\n  font-size: 64px;\n  margin-bottom: 16px;\n  color: #c0c4cc;\n}\n.bill-orders-tab .empty-state p[data-v-040b150f] {\n  font-size: 14px;\n  margin: 0;\n}\n",""]),t.exports=e},330:function(t,e,i){"use strict";i(307)},331:function(t,e,i){(e=i(19)(!1)).push([t.i,".custom-tag[data-v-b9c886a4] {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 2px 8px;\n  border-radius: 4px;\n  font-family: 'PingFang SC', sans-serif;\n  font-weight: 400;\n  line-height: 20px;\n  white-space: nowrap;\n}\n.custom-tag--medium[data-v-b9c886a4] {\n  font-size: 14px;\n  padding: 2px 8px;\n}\n.custom-tag--small[data-v-b9c886a4] {\n  font-size: 12px;\n  padding: 1px 6px;\n  line-height: 18px;\n}\n.custom-tag--mini[data-v-b9c886a4] {\n  font-size: 12px;\n  padding: 0px 4px;\n  line-height: 16px;\n}\n.custom-tag--warning[data-v-b9c886a4] {\n  background-color: #FFE4BA;\n  color: #D25F00;\n}\n.custom-tag--primary[data-v-b9c886a4] {\n  background-color: #C3E7FE;\n  color: #206CCF;\n}\n.custom-tag--default[data-v-b9c886a4] {\n  background-color: rgba(29, 33, 41, 0.1);\n  color: #6B7785;\n}\n.custom-tag--info[data-v-b9c886a4] {\n  background-color: rgba(29, 33, 41, 0.1);\n  color: #6B7785;\n}\n.custom-tag--success[data-v-b9c886a4] {\n  background-color: #AFF0B5;\n  color: #009A29;\n}\n.custom-tag--danger[data-v-b9c886a4] {\n  background-color: #FFCCC7;\n  color: #CF1322;\n}\n.custom-tag--purple[data-v-b9c886a4] {\n  background-color: #E8D8F5;\n  color: #9b59b6;\n}\n",""]),t.exports=e},332:function(t,e,i){"use strict";i(308)},333:function(t,e,i){(e=i(19)(!1)).push([t.i,".invoice-record-table .table-header[data-v-c20efa32] {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.invoice-record-table .table-header .header-actions[data-v-c20efa32] {\n  display: flex;\n  gap: 8px;\n}\n.invoice-record-table .pagination-container[data-v-c20efa32] {\n  margin-top: 16px;\n  display: flex;\n  justify-content: flex-end;\n}\n.invoice-record-table[data-v-c20efa32] .el-table .el-link {\n  font-size: 14px;\n  font-weight: normal;\n}\n.invoice-record-table .text-ellipsis[data-v-c20efa32] {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.invoice-record-table .dialog-content .warning-message[data-v-c20efa32],\n.invoice-record-table .dialog-content .info-message[data-v-c20efa32] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  color: #909399;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.invoice-record-table .dialog-content .warning-message i[data-v-c20efa32],\n.invoice-record-table .dialog-content .info-message i[data-v-c20efa32] {\n  color: #2555FF;\n  font-size: 18px;\n}\n.invoice-record-table .dialog-content .record-info[data-v-c20efa32] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n}\n.invoice-record-table .dialog-content .record-info .info-row[data-v-c20efa32] {\n  display: flex;\n  padding: 4px 0;\n}\n.invoice-record-table .dialog-content .record-info .info-row .label[data-v-c20efa32] {\n  color: #909399;\n  min-width: 90px;\n}\n.invoice-record-table .dialog-content .record-info .info-row .value[data-v-c20efa32] {\n  flex: 1;\n  color: #303133;\n  font-weight: 500;\n}\n.invoice-record-table .dialog-content .hint-message[data-v-c20efa32] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  color: #909399;\n  font-size: 14px;\n  margin: 16px 0 0;\n}\n.invoice-record-table .dialog-content .hint-message i[data-v-c20efa32] {\n  color: #2555FF;\n  font-size: 18px;\n}\n",""]),t.exports=e},334:function(t,e,i){"use strict";i(309)},335:function(t,e,i){(e=i(19)(!1)).push([t.i,".invoice-summary-content .summary-header[data-v-089bbc18] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .summary-header .page-title[data-v-089bbc18] {\n  font-size: 18px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.invoice-summary-content .invoice-amount-summary[data-v-089bbc18] {\n  background: #ffffff;\n  border-radius: 4px;\n  padding: 24px;\n  margin-bottom: 32px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards[data-v-089bbc18] {\n  display: flex;\n  align-items: center;\n  gap: 24px;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card[data-v-089bbc18] {\n  flex: 1;\n  padding: 24px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  text-align: center;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card .amount-label[data-v-089bbc18] {\n  font-size: 14px;\n  color: #909399;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .amount-card .amount-value[data-v-089bbc18] {\n  font-size: 28px;\n  font-weight: 600;\n  color: #303133;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card[data-v-089bbc18] {\n  background: #2555FF;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card .amount-label[data-v-089bbc18] {\n  color: #ffffff;\n}\n.invoice-summary-content .invoice-amount-summary .amount-cards .remaining-amount-card .amount-value[data-v-089bbc18] {\n  color: #ffffff;\n}\n.invoice-summary-content .invoice-amount-summary .amount-details-table[data-v-089bbc18] {\n  margin-top: 24px;\n}\n.invoice-summary-content .invoice-applications[data-v-089bbc18] {\n  background: #ffffff;\n  border-radius: 4px;\n  padding: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invoice-summary-content .invoice-applications .applications-header[data-v-089bbc18] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .invoice-applications .applications-header .section-title[data-v-089bbc18] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.invoice-summary-content .invoice-applications .applications-header .header-actions[data-v-089bbc18] {\n  display: flex;\n  gap: 8px;\n}\n.invoice-summary-content .dialog-content .info-message[data-v-089bbc18] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 16px;\n  background: #f5f7fa;\n  border-radius: 4px;\n  color: #909399;\n  font-size: 14px;\n  margin-bottom: 24px;\n}\n.invoice-summary-content .dialog-content .info-message i[data-v-089bbc18] {\n  color: #2555FF;\n  font-size: 18px;\n}\n.invoice-summary-content .dialog-content .filter-preview[data-v-089bbc18] {\n  margin-top: 24px;\n  padding: 16px;\n  background: #E8EEFF;\n  border: 1px solid #B3C5FF;\n  border-radius: 4px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-title[data-v-089bbc18] {\n  font-size: 13px;\n  color: #909399;\n  margin-bottom: 8px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-content p[data-v-089bbc18] {\n  margin: 0;\n  color: #303133;\n  font-size: 14px;\n}\n.invoice-summary-content .dialog-content .filter-preview .preview-content p strong[data-v-089bbc18] {\n  color: #2555FF;\n  font-weight: 600;\n  font-size: 16px;\n}\n",""]),t.exports=e},342:function(t,e,i){"use strict";i(313)},343:function(t,e,i){(e=i(19)(!1)).push([t.i,".bill-detail-page[data-v-c5a58808] {\n  padding: 24px;\n  background: #f5f7fa;\n  min-height: 100vh;\n}\n.bill-detail-page .breadcrumb-container[data-v-c5a58808] {\n  margin-bottom: 16px;\n  font-size: 14px;\n  color: #909399;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item[data-v-c5a58808] {\n  cursor: pointer;\n  transition: color 0.3s;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item[data-v-c5a58808]:hover {\n  color: #2555FF;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-item.active[data-v-c5a58808] {\n  color: #303133;\n  cursor: default;\n}\n.bill-detail-page .breadcrumb-container .breadcrumb-separator[data-v-c5a58808] {\n  margin: 0 8px;\n}\n.bill-detail-page .loading-container[data-v-c5a58808] {\n  background: #ffffff;\n  padding: 32px;\n  border-radius: 4px;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] {\n  margin-bottom: 16px;\n}\n.bill-detail-page .bill-content .steps-card .step-description[data-v-c5a58808] {\n  color: #e6a23c;\n  font-size: 13px;\n  margin-top: 4px;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-process .el-step__icon {\n  background-color: #2555FF;\n  border-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-process .el-step__icon .el-step__icon-inner {\n  color: #ffffff;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-process .el-step__line {\n  background-color: #e4e7ed;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-wait .el-step__icon {\n  background-color: #ffffff;\n  border-color: #c0c4cc;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-wait .el-step__icon .el-step__icon-inner {\n  color: #c0c4cc;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-wait .el-step__line {\n  background-color: #e4e7ed;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-success .el-step__icon,\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-finish .el-step__icon {\n  background-color: #2555FF;\n  border-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-success .el-step__icon .el-step__icon-inner,\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-finish .el-step__icon .el-step__icon-inner {\n  color: #ffffff;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-success .el-step__line,\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__head.is-finish .el-step__line {\n  background-color: #2555FF;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__title.is-process {\n  color: #303133;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__title.is-wait {\n  color: #c0c4cc;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__title.is-success,\n.bill-detail-page .bill-content .steps-card[data-v-c5a58808] .el-steps .el-step__title.is-finish {\n  color: #303133;\n  font-weight: normal;\n}\n.bill-detail-page .bill-content .action-card[data-v-c5a58808] {\n  margin-bottom: 16px;\n}\n.bill-detail-page .bill-content .action-card .action-header[data-v-c5a58808] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.bill-detail-page .bill-content .action-card .action-header .date-range[data-v-c5a58808] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n}\n.bill-detail-page .bill-content .action-card .action-header .date-range i[data-v-c5a58808] {\n  margin-right: 8px;\n  color: #2555FF;\n}\n.bill-detail-page .bill-content .action-card .action-header .action-buttons[data-v-c5a58808] {\n  display: flex;\n  gap: 8px;\n}\n.bill-detail-page .bill-content .tabs-card[data-v-c5a58808] {\n  min-height: 500px;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-header[data-v-c5a58808] {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #dcdfe6;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-header .section-title[data-v-c5a58808] {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0;\n}\n.bill-detail-page .bill-content .tabs-card .invoice-apply-content .action-section[data-v-c5a58808] {\n  margin-bottom: 24px;\n}\n.bill-detail-page .confirm-dialog-content .confirm-message[data-v-c5a58808] {\n  font-size: 16px;\n  color: #303133;\n  margin-bottom: 24px;\n  text-align: center;\n}\n.bill-detail-page .confirm-dialog-content .confirm-message strong[data-v-c5a58808] {\n  color: #2555FF;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount[data-v-c5a58808] {\n  background: #f5f7fa;\n  padding: 16px;\n  border-radius: 4px;\n  margin-bottom: 24px;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item[data-v-c5a58808] {\n  display: flex;\n  justify-content: space-between;\n  padding: 8px 0;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item .label[data-v-c5a58808] {\n  color: #909399;\n}\n.bill-detail-page .confirm-dialog-content .confirm-amount .amount-item .value[data-v-c5a58808] {\n  font-weight: 600;\n  color: #303133;\n}\n.bill-detail-page .confirm-dialog-content .confirm-hint[data-v-c5a58808] {\n  font-size: 13px;\n  color: #c0c4cc;\n  text-align: center;\n  margin: 0;\n}\n.bill-detail-page .confirm-dialog-content .confirm-hint.warn[data-v-c5a58808] {\n  color: #e6a23c;\n}\n.bill-detail-page .split-config-banner[data-v-c5a58808] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 8px;\n  background: #f5f7fa;\n  color: #909399;\n  padding: 16px;\n  border-radius: 4px;\n  margin: 8px 0 16px 0;\n}\n.bill-detail-page .split-config-banner i[data-v-c5a58808] {\n  color: #2555FF;\n  font-size: 18px;\n}\n",""]),t.exports=e},346:function(t,e,i){"use strict";i.r(e);var a=i(33),n=i(0),l=i(160),s=i(161),o={name:"BillDetailSettings",props:{visible:{type:Boolean,default:!1},currentSettings:{type:Object,default:()=>({dimensions:[]})},billTotal:{type:Number,default:0}},data:()=>({dialogVisible:!1,saving:!1,form:{dimensions:[]},dimensionNames:{businessLine:"业务线",legalEntity:"法人实体",paymentAccount:"支付账户",department:"部门",project:"项目"}}),computed:{previewTotal(){return this.billTotal}},watch:{visible:{immediate:!0,handler(t){this.dialogVisible=t,t&&this.initForm()}}},methods:{initForm(){this.form.dimensions=[...this.currentSettings.dimensions||[]]},getDimensionName(t){return this.dimensionNames[t]||t},removeDimension(t){const e=this.form.dimensions.indexOf(t);e>-1&&this.form.dimensions.splice(e,1)},formatAmount:t=>Object(l.a)(t),handleClose(){this.dialogVisible=!1,this.$emit("update:visible",!1)},async handleSave(){if(this.form.dimensions.length>5)this.$message.warning("最多只能选择5个拆分维度");else{this.saving=!0;try{await this.$emit("save",{dimensions:this.form.dimensions}),this.$message.success("明细设置保存成功"),this.handleClose()}catch(t){this.$message.error("保存失败："+t.message)}finally{this.saving=!1}}}}},r=(i(320),i(12)),c={name:"BillSummaryContent",components:{BillDetailSettings:Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"明细设置",visible:t.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[e("div",{staticClass:"detail-settings-content"},[e("div",{staticClass:"settings-description"},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("span",[t._v("选择拆分维度后，账单汇总将按照所选维度进行多层级展示")])]),t._v(" "),e("div",{staticClass:"settings-form"},[e("el-form",{attrs:{model:t.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"拆分维度"}},[e("el-checkbox-group",{model:{value:t.form.dimensions,callback:function(e){t.$set(t.form,"dimensions",e)},expression:"form.dimensions"}},[e("el-checkbox",{attrs:{label:"businessLine"}},[t._v("业务线")]),t._v(" "),e("el-checkbox",{attrs:{label:"legalEntity"}},[t._v("法人实体")]),t._v(" "),e("el-checkbox",{attrs:{label:"paymentAccount"}},[t._v("支付账户")]),t._v(" "),e("el-checkbox",{attrs:{label:"department"}},[t._v("部门")]),t._v(" "),e("el-checkbox",{attrs:{label:"project"}},[t._v("项目")])],1),t._v(" "),e("div",{staticClass:"form-hint"},[t._v("\n            可选择0-5个维度，将按选择顺序进行多层级拆分（选择0个则不拆分）\n          ")])],1),t._v(" "),e("el-form-item",{attrs:{label:"拆分顺序"}},[e("div",{staticClass:"dimension-order"},[t._l(t.form.dimensions,(function(i,a){return e("el-tag",{key:i,attrs:{closable:""},on:{close:function(e){return t.removeDimension(i)}}},[t._v("\n              "+t._s(t.getDimensionName(i))+"\n              "),e("span",{staticClass:"order-number"},[t._v(t._s(a+1))])])})),t._v(" "),0===t.form.dimensions.length?e("div",{staticClass:"empty-hint"},[t._v("\n              请勾选拆分维度\n            ")]):t._e()],2)])],1)],1),t._v(" "),e("div",{staticClass:"settings-preview"},[e("div",{staticClass:"preview-title"},[t._v("预览效果")]),t._v(" "),e("div",{staticClass:"preview-content"},[t.form.dimensions.length>0?e("div",{staticClass:"preview-tree"},[e("div",{staticClass:"tree-node level-0"},[e("i",{staticClass:"el-icon-folder"}),t._v(" "),e("span",[t._v("总计：¥"+t._s(t.formatAmount(t.previewTotal)))])]),t._v(" "),t._l(t.form.dimensions,(function(i,a){return e("div",{key:i,staticClass:"tree-node",class:"level-"+(a+1)},[e("i",{staticClass:"el-icon-folder-opened"}),t._v(" "),e("span",[t._v(t._s(t.getDimensionName(i))+" - 示例值")])])}))],2):e("div",{staticClass:"preview-empty"},[t._v("\n          选择拆分维度后将显示预览效果\n        ")])])])]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSave}},[t._v("保存")])],1)])}),[],!1,null,"11cf980b",null).exports},props:{bill:{type:Object,required:!0}},data:()=>({settingsVisible:!1,treeProps:{children:"children",label:"name"}}),computed:{...Object(a.c)("config",["detailSettings"]),...Object(a.c)("order",["orderList"]),billSummary(){return this.bill.summary||{}},businessLineSummary(){return this.billSummary.businessLineSummary||[]},averageOrderAmount(){return(this.bill.totalAmount||0)/(this.billSummary.totalCount||1)},checkedOrderCount(){return this.orderList&&0!==this.orderList.length?this.orderList.filter(t=>1===t.checkStatus).length:0},treeData(){return this.detailSettings&&this.detailSettings.dimensions&&0!==this.detailSettings.dimensions.length?this.buildTreeData():[]}},methods:{...Object(a.b)("config",["updateDetailSettings"]),formatAmount:t=>Object(l.a)(t),formatCycle:t=>Object(l.b)(t),formatDateRange:(t,e)=>Object(l.d)(t,e),calculatePercent:(t,e)=>e?(t/e*100).toFixed(1)+"%":"0%",handleDetailSettings(){this.settingsVisible=!0},async handleSaveSettings(t){try{await this.updateDetailSettings(t),this.$message.success("明细设置已保存")}catch(t){throw this.$message.error("保存失败："+t.message),t}},getNodeIcon:t=>0===t.level?"el-icon-folder":"el-icon-folder-opened",buildTreeData(){const t=this.detailSettings.dimensions,e=this.orderList||[],i={id:"root",name:"本期结算周期主汇总",amount:this.bill.totalAmount||0,count:e.length,level:0,children:[]};return this.buildTreeLevel(i,e,t,0),[i]},buildTreeLevel(t,e,i,a){if(a>=i.length||0===e.length)return;const n=i[a],l=this.groupBy(e,n);t.children=Object.keys(l).map((e,s)=>{const o=l[e],r=a===i.length-1,c={id:`${t.id}-${n}-${e}`,name:this.getDimensionValueName(n,e),amount:o.reduce((t,e)=>t+(e.amount||0),0),count:o.length,level:a+1};if(r||(c.children=[]),r&&o.length>0){const t=o[0];c.department=t.department||"首页-机酒住宿部"}return this.buildTreeLevel(c,o,i,a+1),c})},groupBy(t,e){const i={};return t.forEach(t=>{let a;switch(e){case"businessLine":a=t.businessType||"未知";break;case"legalEntity":a=t.legalEntity||"未知";break;case"paymentAccount":a=t.paymentAccount||"未知";break;case"department":a=t.department||"未知";break;case"project":a=t.project||"未知";break;default:a="未知"}i[a]||(i[a]=[]),i[a].push(t)}),i},getDimensionValueName:(t,e)=>"businessLine"===t&&n.BUSINESS_TYPE_NAMES[e]||e}},d=(i(322),Object(r.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bill-summary-content"},[e("div",{staticClass:"amount-header"},[e("div",{staticClass:"amount-info"},[e("span",{staticClass:"amount-label"},[t._v("消费金额：")]),t._v(" "),e("span",{staticClass:"amount-value"},[t._v(t._s(t.formatAmount(t.bill.totalAmount)))])]),t._v(" "),e("el-button",{attrs:{size:"small",type:"text"},on:{click:t.handleDetailSettings}},[t._v("\n      明细设置\n    ")])],1),t._v(" "),e("div",{staticClass:"detail-section"},[t.detailSettings&&t.detailSettings.dimensions.length>0?e("div",{staticClass:"detail-tree"},[e("el-tree",{staticClass:"custom-tree",attrs:{data:t.treeData,props:t.treeProps,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function({node:i,data:a}){return e("span",{staticClass:"custom-tree-node"},[e("span",{staticClass:"node-label"},[e("span",{staticClass:"node-name"},[t._v(t._s(a.name))])]),t._v(" "),e("span",{staticClass:"node-stats"},[e("span",{staticClass:"node-amount"},[t._v(t._s(t.formatAmount(a.amount)))]),t._v(" "),e("span",{staticClass:"node-count"},[t._v(t._s(a.count)+"笔")])])])}}],null,!1,1745745915)})],1):e("div",{staticClass:"business-stats-default"},[e("el-row",{attrs:{gutter:16}},t._l(t.businessLineSummary,(function(i){return e("el-col",{key:i.businessType,attrs:{span:6}},[e("div",{staticClass:"stat-card"},[e("div",{staticClass:"stat-header"},[e("span",{staticClass:"stat-name"},[t._v(t._s(i.businessTypeName))]),t._v(" "),e("el-tag",{attrs:{size:"small"}},[t._v(t._s(t.calculatePercent(i.totalAmount,t.bill.totalAmount)))])],1),t._v(" "),e("div",{staticClass:"stat-amount"},[t._v(t._s(t.formatAmount(i.totalAmount)))]),t._v(" "),e("div",{staticClass:"stat-count"},[t._v(t._s(i.count)+"笔订单")])])])})),1)],1)]),t._v(" "),e("div",{staticClass:"order-stats-section"},[e("h4",{staticClass:"section-title"},[t._v("订单统计")]),t._v(" "),e("el-row",{attrs:{gutter:16}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"stat-item"},[e("div",{staticClass:"stat-label"},[t._v("总订单数")]),t._v(" "),e("div",{staticClass:"stat-number"},[t._v(t._s(t.billSummary.totalCount))])])]),t._v(" "),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"stat-item"},[e("div",{staticClass:"stat-label"},[t._v("平均订单金额")]),t._v(" "),e("div",{staticClass:"stat-number"},[t._v(t._s(t.formatAmount(t.averageOrderAmount)))])])]),t._v(" "),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"stat-item"},[e("div",{staticClass:"stat-label"},[t._v("已核对订单")]),t._v(" "),e("div",{staticClass:"stat-number"},[t._v(t._s(t.checkedOrderCount))])])])],1)],1),t._v(" "),e("bill-detail-settings",{attrs:{visible:t.settingsVisible,"current-settings":t.detailSettings,"bill-total":t.bill.totalAmount},on:{"update:visible":function(e){t.settingsVisible=e},save:t.handleSaveSettings}})],1)}),[],!1,null,"85907336",null).exports);function u(){try{return i(162),!0}catch(t){return!1}}const m={orderNo:"订单号",bookingTime:"预订日期",departDate:"出行日期",bookingPerson:"预订人",travelerName:"出行人/入住人",amount:"支付金额",checkStatus:"核对状态",flightNo:"航班号",route:"航线",departTime:"起飞时间",cabin:"舱位等级",ticketNo:"电子客票号",hotelName:"酒店名称",checkInDate:"入住日期",checkOutDate:"离店日期",nights:"房间数量",roomType:"房型",trainNo:"车次",seatType:"座位等级",idCardLast4:"身份证后四位",useTime:"用车时间",startLocation:"起点",endLocation:"终点",carType:"车型",mileage:"行驶里程",legalEntity:"法人实体",paymentAccount:"支付账户",costCenter:"成本中心",department:"项目部门",expenseType:"费用类型"};function p(t,e,i){if(null==e)return"";switch(t){case"bookingTime":case"departTime":case"useTime":return Object(l.c)(e,"YYYY-MM-DD HH:mm");case"departDate":case"checkInDate":case"checkOutDate":return Object(l.c)(e,"YYYY-MM-DD");case"amount":return Object(l.a)(e);case"checkStatus":return n.CHECK_STATUS_NAMES[e]||e;case"businessType":return n.BUSINESS_TYPE_NAMES[e]||e;default:return e}}function b(t){const{data:e=[],fields:a=[],fileName:n="导出数据",sheetName:s="Sheet1"}=t;if(!u())throw new Error("Excel导出功能需要安装xlsx库。\n请运行以下命令安装：\nnpm install xlsx --save");const o=i(162);if(!e||0===e.length)throw new Error("没有可导出的数据");if(!a||0===a.length)throw new Error("请先配置导出字段");const r=[a.map(t=>m[t]||t),...e.map(t=>a.map(e=>p(e,t[e])))],c=o.utils.aoa_to_sheet(r),d=a.map(t=>{const e=m[t]||t,i=Math.max(2*e.length,10);return"orderNo"===t?{wch:20}:"bookingTime"===t||"departTime"===t?{wch:18}:"amount"===t?{wch:12}:"route"===t?{wch:20}:"hotelName"===t?{wch:25}:{wch:i}});c["!cols"]=d;const b=o.utils.book_new();o.utils.book_append_sheet(b,c,s);const f=`${n}_${Object(l.c)(new Date,"YYYYMMDD_HHmmss")}.xlsx`;return o.writeFile(b,f),{fileName:f,rowCount:e.length,fieldCount:a.length}}function f(t){const{orders:e=[],fields:i=[],businessType:a="",billNo:l=""}=t,s=n.BUSINESS_TYPE_NAMES[a]||"订单";return b({data:e,fields:i,fileName:`账单${l}_${s}明细`,sheetName:s})}var v={name:"FieldConfigDialog",props:{visible:{type:Boolean,default:!1},currentConfig:{type:Object,default:()=>({display:[],excelExport:[],pdfExport:[]})}},data:()=>({dialogVisible:!1,activeConfigTab:"display",saving:!1,localConfig:{display:[],excelExport:[],pdfExport:[]},availableFields:[{label:"订单号",value:"orderNo"},{label:"预订日期",value:"bookingTime"},{label:"出行日期",value:"departDate"},{label:"预订人",value:"bookingPerson"},{label:"出行人/入住人",value:"travelerName"},{label:"支付金额",value:"amount"},{label:"核对状态",value:"checkStatus"},{label:"航班号",value:"flightNo"},{label:"航线",value:"route"},{label:"起飞时间",value:"departTime"},{label:"舱位等级",value:"cabin"},{label:"电子客票号",value:"ticketNo"},{label:"酒店名称",value:"hotelName"},{label:"入住日期",value:"checkInDate"},{label:"离店日期",value:"checkOutDate"},{label:"房间数量",value:"nights"},{label:"房型",value:"roomType"},{label:"车次",value:"trainNo"},{label:"出发时间",value:"departTime"},{label:"座位等级",value:"seatType"},{label:"身份证后四位",value:"idCardLast4"},{label:"用车时间",value:"useTime"},{label:"起点",value:"startLocation"},{label:"终点",value:"endLocation"},{label:"车型",value:"carType"},{label:"行驶里程",value:"mileage"},{label:"法人实体",value:"legalEntity"},{label:"支付账户",value:"paymentAccount"},{label:"成本中心",value:"costCenter"},{label:"项目部门",value:"department"},{label:"项目名称",value:"projectName"},{label:"费用类型",value:"expenseType"}]}),watch:{visible:{immediate:!0,handler(t){this.dialogVisible=t,t&&this.initForm()}}},methods:{initForm(){this.localConfig={display:[...this.currentConfig.display||[]],excelExport:[...this.currentConfig.excelExport||[]],pdfExport:[...this.currentConfig.pdfExport||[]]},0===this.localConfig.display.length&&(this.localConfig.display=["orderNo","bookingTime","departDate","bookingPerson","travelerName","amount","checkStatus"]),0===this.localConfig.excelExport.length&&(this.localConfig.excelExport=[...this.localConfig.display]),0===this.localConfig.pdfExport.length&&(this.localConfig.pdfExport=[...this.localConfig.display].slice(0,20))},handlePdfFieldChange(){this.localConfig.pdfExport.length>20&&this.$message.warning("PDF字段数量已达到上限（20个）")},handleClose(){this.dialogVisible=!1,this.$emit("update:visible",!1)},async handleSave(){if(this.localConfig.pdfExport.length>20)this.$message.error("PDF导出字段不能超过20个，请调整后再保存");else if(0!==this.localConfig.display.length){this.saving=!0;try{await this.$emit("save",this.localConfig),this.$message.success("字段配置保存成功"),this.handleClose()}catch(t){this.$message.error("保存失败："+t.message)}finally{this.saving=!1}}else this.$message.warning("请至少选择一个显示字段")}}},h=(i(324),{name:"OrderListContent",components:{FieldConfigDialog:Object(r.a)(v,(function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"对账单字段配置",visible:t.dialogVisible,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[e("div",{staticClass:"field-config-content"},[e("el-tabs",{attrs:{type:"card"},model:{value:t.activeConfigTab,callback:function(e){t.activeConfigTab=e},expression:"activeConfigTab"}},[e("el-tab-pane",{attrs:{label:"显示字段",name:"display"}},[e("div",{staticClass:"config-section"},[e("div",{staticClass:"section-description"},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("span",[t._v("配置在订单列表中显示的字段")])]),t._v(" "),e("el-transfer",{attrs:{data:t.availableFields,titles:["可选字段","已选字段"],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},model:{value:t.localConfig.display,callback:function(e){t.$set(t.localConfig,"display",e)},expression:"localConfig.display"}})],1)]),t._v(" "),e("el-tab-pane",{attrs:{label:"Excel导出字段",name:"excel"}},[e("div",{staticClass:"config-section"},[e("div",{staticClass:"section-description"},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("span",[t._v("配置导出Excel时包含的字段")])]),t._v(" "),e("el-transfer",{attrs:{data:t.availableFields,titles:["可选字段","已选字段"],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},model:{value:t.localConfig.excelExport,callback:function(e){t.$set(t.localConfig,"excelExport",e)},expression:"localConfig.excelExport"}})],1)]),t._v(" "),e("el-tab-pane",{attrs:{label:"PDF导出字段",name:"pdf"}},[e("div",{staticClass:"config-section"},[e("div",{staticClass:"section-description"},[e("i",{staticClass:"el-icon-warning"}),t._v(" "),e("span",[t._v("配置导出PDF时包含的字段（最多20个字段，受PDF宽度限制）")])]),t._v(" "),e("el-transfer",{attrs:{data:t.availableFields,titles:["可选字段",`已选字段 (${t.localConfig.pdfExport.length}/20)`],props:{key:"value",label:"label"},filterable:"","filter-placeholder":"搜索字段"},on:{change:t.handlePdfFieldChange},model:{value:t.localConfig.pdfExport,callback:function(e){t.$set(t.localConfig,"pdfExport",e)},expression:"localConfig.pdfExport"}}),t._v(" "),t.localConfig.pdfExport.length>20?e("div",{staticClass:"error-hint"},[e("i",{staticClass:"el-icon-info"}),t._v("\n            PDF字段数量超过限制，请调整至20个以内\n          ")]):t._e()],1)])],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.saving},on:{click:t.handleSave}},[t._v("保存配置")])],1)])}),[],!1,null,"5fd71556",null).exports},props:{billNo:{type:String,required:!0},businessType:{type:String,required:!0},billStatus:{type:Number,default:0}},data:()=>({filterForm:{orderNo:"",checkStatus:null,travelerName:"",legalEntity:null,bookingDateRange:null,businessType:null,paymentAccount:null,costCenter:null,project:null},legalEntityOptions:n.LEGAL_ENTITY_OPTIONS,departmentOptions:n.DEPARTMENT_OPTIONS||[],projectOptions:n.PROJECT_OPTIONS||[],businessTypeOptions:n.BUSINESS_TYPE_NAMES,paymentAccountOptions:n.PAYMENT_ACCOUNT_OPTIONS,costCenterOptions:n.COST_CENTER_OPTIONS,fieldConfigVisible:!1,exporting:!1,selectedOrders:[],allSelected:!1,batchUpdateVisible:!1,batchUpdateForm:{legalEntity:null,department:null,project:null},batchModifyVisible:!1,batchModifyForm:{},batchModifyFileList:[],batchModifying:!1}),computed:{isOperationsDisabled(){return this.billStatus>=n.BILL_STATUS.PENDING_INVOICE},...Object(a.c)("order",["orderList","loading"]),...Object(a.c)("config",["fieldConfig"]),filteredOrders(){let t=this.orderList.filter(t=>t.businessType===this.businessType);if(this.filterForm.orderNo&&(t=t.filter(t=>t.orderNo.includes(this.filterForm.orderNo))),null!==this.filterForm.checkStatus&&void 0!==this.filterForm.checkStatus&&(t=t.filter(t=>t.checkStatus===this.filterForm.checkStatus)),this.filterForm.travelerName&&(t=t.filter(t=>t.travelerName&&t.travelerName.includes(this.filterForm.travelerName))),this.filterForm.legalEntity&&(t=t.filter(t=>t.legalEntity===this.filterForm.legalEntity)),this.filterForm.bookingDateRange&&2===this.filterForm.bookingDateRange.length){const[e,i]=this.filterForm.bookingDateRange;t=t.filter(t=>{if(!t.bookingTime)return!1;const a=t.bookingTime.split(" ")[0];return a>=e&&a<=i})}return this.filterForm.businessType&&(t=t.filter(t=>t.businessType===this.filterForm.businessType)),this.filterForm.paymentAccount&&(t=t.filter(t=>t.paymentAccount===this.filterForm.paymentAccount)),this.filterForm.costCenter&&(t=t.filter(t=>t.costCenter===this.filterForm.costCenter)),this.filterForm.project&&(t=t.filter(t=>t.project===this.filterForm.project)),t},totalAmount(){return this.filteredOrders.reduce((t,e)=>t+(e.amount||0),0)},checkedCount(){return this.filteredOrders.filter(t=>1===t.checkStatus).length},uncheckedCount(){return this.filteredOrders.filter(t=>0===t.checkStatus).length},totalOrderCount(){return this.orderList.filter(t=>t.businessType===this.businessType).length}},methods:{...Object(a.b)("config",["updateFieldConfig"]),...Object(a.b)("order",["updateOrderCheckStatus","batchUpdateOrders"]),formatAmount:t=>Object(l.a)(t),formatDate:(t,e="YYYY-MM-DD HH:mm")=>Object(l.c)(t,e),getCheckStatusName:t=>n.CHECK_STATUS_NAMES[t]||"-",getCheckStatusType:t=>n.CHECK_STATUS_COLORS[t]||"",isFieldVisible(t){return!this.fieldConfig||!this.fieldConfig.display||0===this.fieldConfig.display.length||this.fieldConfig.display.includes(t)},handleSelectionChange(t){this.selectedOrders=t},handleSelectAll(){const t=this.orderList.filter(t=>t.businessType===this.businessType);this.$nextTick(()=>{t.forEach(t=>{this.$refs.orderTable.toggleRowSelection(t,!0)})}),Object(s.b)(`已选中全部 ${t.length} 笔订单`)},handleBatchUpdate(){0!==this.selectedOrders.length?(this.batchUpdateForm={legalEntity:null,department:null,project:null},this.batchUpdateVisible=!0):Object(s.c)("请先选择要更新的订单")},async confirmBatchUpdate(){const{legalEntity:t,department:e,project:i}=this.batchUpdateForm;if(t||e||i)try{const a={};t&&(a.legalEntity=t),e&&(a.department=e),i&&(a.project=i);const n=this.selectedOrders.map(t=>t.orderNo);await this.batchUpdateOrders({orderNos:n,updateData:a}),Object(s.b)(`成功更新 ${n.length} 笔订单数据`),this.batchUpdateVisible=!1,this.$refs.orderTable.clearSelection()}catch(t){Object(s.a)(t,{customMessage:"批量更新失败"})}else Object(s.c)("请至少选择一个字段进行更新")},handleBatchModify(){this.batchModifyForm={},this.batchModifyFileList=[],this.batchModifyVisible=!0},handleBatchModifyFileChange(t,e){if(!(t.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.batchModifyFileList=e.filter(e=>e.uid!==t.uid));const i=t.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.batchModifyFileList=e.filter(e=>e.uid!==t.uid));this.batchModifyFileList=e},handleBatchModifyFileRemove(t,e){this.batchModifyFileList=e},async confirmBatchModify(){if(this.batchModifyFileList&&0!==this.batchModifyFileList.length){this.batchModifying=!0;try{const t=this.batchModifyFileList[0].raw;console.log("批量修改文件:",t),console.log("可修改字段: 法人实体、部门、项目"),await new Promise(t=>setTimeout(t,1e3)),Object(s.b)("批量修改数据成功"),this.batchModifyVisible=!1,this.batchModifyFileList=[],this.batchModifyForm={},await this.$store.dispatch("order/fetchOrderList",this.billNo)}catch(t){Object(s.a)(t,{customMessage:"批量修改数据失败"})}finally{this.batchModifying=!1}}else Object(s.c)("请上传Excel文件")},async handleMarkAsChecked(){if(0!==this.selectedOrders.length)try{const t=this.selectedOrders.map(t=>t.orderNo);await this.updateOrderCheckStatus({orderNos:t,checkStatus:1}),Object(s.b)(`成功标记 ${t.length} 笔订单为已核对`),this.$refs.orderTable.clearSelection()}catch(t){Object(s.a)(t,{customMessage:"标记已核对失败"})}else Object(s.c)("请先选择要标记的订单")},async handleUnmarkChecked(){if(0!==this.selectedOrders.length)try{const t=this.selectedOrders.map(t=>t.orderNo);await this.updateOrderCheckStatus({orderNos:t,checkStatus:0}),Object(s.b)(`成功取消 ${t.length} 笔订单的已核对标记`),this.$refs.orderTable.clearSelection()}catch(t){Object(s.a)(t,{customMessage:"取消已核对标记失败"})}else Object(s.c)("请先选择要取消标记的订单")},handleSearch(){},handleReset(){this.filterForm={orderNo:"",checkStatus:null,travelerName:"",legalEntity:null,bookingDateRange:null,businessType:null,paymentAccount:null,costCenter:null,project:null}},handleFieldConfig(){this.fieldConfigVisible=!0},async handleSaveFieldConfig(t){try{await this.updateFieldConfig(t),Object(s.b)("字段配置已保存")}catch(t){throw Object(s.a)(t,{customMessage:"保存字段配置失败"}),t}},async handleExportExcel(){if(this.fieldConfig.excelExport&&0!==this.fieldConfig.excelExport.length)if(0!==this.filteredOrders.length){this.exporting=!0;try{const t=f({orders:this.filteredOrders,fields:this.fieldConfig.excelExport,businessType:this.businessType,billNo:this.billNo});Object(s.b)(`Excel导出成功！\n文件名：${t.fileName}\n导出数据：${t.rowCount}行`)}catch(t){t.message.includes("xlsx库")?this.$alert(t.message,"提示",{confirmButtonText:"知道了",type:"warning"}):Object(s.a)(t,{customMessage:"Excel导出失败"})}finally{this.exporting=!1}}else Object(s.c)("当前没有可导出的订单数据");else Object(s.c)("请先配置Excel导出字段")},async handleExportPDF(){if(this.fieldConfig.pdfExport&&0!==this.fieldConfig.pdfExport.length)if(this.fieldConfig.pdfExport.length>20)this.$message.error("PDF导出字段不能超过20个，请在字段配置中调整");else if(0!==this.filteredOrders.length){this.exporting=!0;try{const t=i(2).default,e=await t.exportBillToPDF({billNo:this.billNo,businessType:this.businessType,fields:this.fieldConfig.pdfExport,orderIds:this.filteredOrders.map(t=>t.orderId)});e.data&&e.data.pdfUrl&&(Object(s.b)(`PDF导出请求已提交！\n文件将在生成后自动下载\n导出数据：${this.filteredOrders.length}行`),this.$message.info({message:"Demo环境：PDF生成功能需要后端服务支持。在实际环境中，PDF将自动下载到本地。",duration:5e3}))}catch(t){Object(s.a)(t,{customMessage:"PDF导出失败"})}finally{this.exporting=!1}}else Object(s.c)("当前没有可导出的订单数据");else Object(s.c)("请先配置PDF导出字段")}}}),g=(i(326),{name:"BillOrdersTab",components:{OrderListContent:Object(r.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list-content"},[e("div",{staticClass:"filter-section"},[e("el-form",{attrs:{inline:!0,model:t.filterForm,size:"small"}},[e("el-form-item",{attrs:{label:"订单号"}},[e("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入订单号",clearable:""},model:{value:t.filterForm.orderNo,callback:function(e){t.$set(t.filterForm,"orderNo",e)},expression:"filterForm.orderNo"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"核对状态"}},[e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.filterForm.checkStatus,callback:function(e){t.$set(t.filterForm,"checkStatus",e)},expression:"filterForm.checkStatus"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),e("el-option",{attrs:{label:"未核对",value:0}}),t._v(" "),e("el-option",{attrs:{label:"已核对",value:1}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"出行人/入住人"}},[e("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入姓名",clearable:""},model:{value:t.filterForm.travelerName,callback:function(e){t.$set(t.filterForm,"travelerName",e)},expression:"filterForm.travelerName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"法人实体"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.filterForm.legalEntity,callback:function(e){t.$set(t.filterForm,"legalEntity",e)},expression:"filterForm.legalEntity"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.legalEntityOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1),t._v(" "),e("el-form-item",{attrs:{label:"下单日期"}},[e("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:t.filterForm.bookingDateRange,callback:function(e){t.$set(t.filterForm,"bookingDateRange",e)},expression:"filterForm.bookingDateRange"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"业务类型"}},[e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.filterForm.businessType,callback:function(e){t.$set(t.filterForm,"businessType",e)},expression:"filterForm.businessType"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.businessTypeOptions,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})}))],2)],1),t._v(" "),e("el-form-item",{attrs:{label:"支付方式"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.filterForm.paymentAccount,callback:function(e){t.$set(t.filterForm,"paymentAccount",e)},expression:"filterForm.paymentAccount"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.paymentAccountOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1),t._v(" "),e("el-form-item",{attrs:{label:"费用归属"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:""},model:{value:t.filterForm.costCenter,callback:function(e){t.$set(t.filterForm,"costCenter",e)},expression:"filterForm.costCenter"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.costCenterOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1),t._v(" "),e("el-form-item",{attrs:{label:"项目名称"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"全部",clearable:"",filterable:""},model:{value:t.filterForm.project,callback:function(e){t.$set(t.filterForm,"project",e)},expression:"filterForm.project"}},[e("el-option",{attrs:{label:"全部",value:null}}),t._v(" "),t._l(t.projectOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1),t._v(" "),e("div",{staticClass:"toolbar-section"},[e("div",{staticClass:"toolbar-left"},[e("el-button",{attrs:{size:"small",type:"primary",disabled:t.isOperationsDisabled||0===t.totalOrderCount},on:{click:t.handleSelectAll}},[t._v("\n        选中全部列表 ("+t._s(t.totalOrderCount)+"笔)\n      ")]),t._v(" "),t.selectedOrders.length>0?e("span",{staticClass:"selection-info"},[t._v("\n        已选择 "+t._s(t.selectedOrders.length)+" 笔订单\n      ")]):t._e()],1),t._v(" "),e("div",{staticClass:"toolbar-actions"},[e("el-button",{attrs:{size:"small",icon:"el-icon-edit",disabled:t.isOperationsDisabled||0===t.selectedOrders.length},on:{click:t.handleBatchUpdate}},[t._v("\n        更新数据\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-check",type:"success",disabled:t.isOperationsDisabled||0===t.selectedOrders.length},on:{click:t.handleMarkAsChecked}},[t._v("\n        标记为已核对\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-close",disabled:t.isOperationsDisabled||0===t.selectedOrders.length},on:{click:t.handleUnmarkChecked}},[t._v("\n        取消已核对标记\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-upload",disabled:t.isOperationsDisabled},on:{click:t.handleBatchModify}},[t._v("\n        批量修改数据\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-setting"},on:{click:t.handleFieldConfig}},[t._v("\n        对账单字段配置\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:t.handleExportExcel}},[t._v("\n        导出Excel\n      ")]),t._v(" "),e("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:t.handleExportPDF}},[t._v("\n        导出PDF\n      ")])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"orderTable",staticStyle:{width:"100%"},attrs:{data:t.filteredOrders,stripe:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",fixed:"left",selectable:()=>!t.isOperationsDisabled}}),t._v(" "),t.isFieldVisible("checkStatus")?e("el-table-column",{attrs:{prop:"checkStatus",label:"核对状态",width:"100",fixed:"left"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tag",{attrs:{type:t.getCheckStatusType(i.checkStatus),size:"small"}},[t._v("\n          "+t._s(t.getCheckStatusName(i.checkStatus))+"\n        ")])]}}],null,!1,2804614141)}):t._e(),t._v(" "),t.isFieldVisible("orderNo")?e("el-table-column",{attrs:{prop:"orderNo",label:"订单号",width:"170",fixed:"left"}}):t._e(),t._v(" "),t.isFieldVisible("bookingTime")?e("el-table-column",{attrs:{prop:"bookingTime",label:"预订日期",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(t.formatDate(e.bookingTime))+"\n      ")]}}],null,!1,2700849525)}):t._e(),t._v(" "),t.isFieldVisible("departDate")?e("el-table-column",{attrs:{prop:"departDate",label:"出行日期",width:"110"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(t.formatDate(e.departDate,"YYYY-MM-DD"))+"\n      ")]}}],null,!1,2576457223)}):t._e(),t._v(" "),t.isFieldVisible("bookingPerson")?e("el-table-column",{attrs:{prop:"bookingPerson",label:"预订人",width:"90"}}):t._e(),t._v(" "),t.isFieldVisible("travelerName")?e("el-table-column",{attrs:{prop:"travelerName",label:"出行人",width:"90"}}):t._e(),t._v(" "),"001"===t.businessType?[t.isFieldVisible("flightNo")?e("el-table-column",{attrs:{prop:"flightNo",label:"航班号",width:"100"}}):t._e(),t._v(" "),t.isFieldVisible("route")?e("el-table-column",{attrs:{prop:"route",label:"航线",width:"140"}}):t._e(),t._v(" "),t.isFieldVisible("cabin")?e("el-table-column",{attrs:{prop:"cabin",label:"舱位",width:"90"}}):t._e()]:"002"===t.businessType?[t.isFieldVisible("hotelName")?e("el-table-column",{attrs:{prop:"hotelName",label:"酒店名称",width:"180"}}):t._e(),t._v(" "),t.isFieldVisible("checkInDate")?e("el-table-column",{attrs:{prop:"checkInDate",label:"入住日期",width:"110"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n          "+t._s(t.formatDate(e.checkInDate,"YYYY-MM-DD"))+"\n        ")]}}],null,!1,1379708624)}):t._e(),t._v(" "),t.isFieldVisible("checkOutDate")?e("el-table-column",{attrs:{prop:"checkOutDate",label:"离店日期",width:"110"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n          "+t._s(t.formatDate(e.checkOutDate,"YYYY-MM-DD"))+"\n        ")]}}],null,!1,2477558585)}):t._e(),t._v(" "),t.isFieldVisible("nights")?e("el-table-column",{attrs:{prop:"nights",label:"房间数",width:"80"}}):t._e(),t._v(" "),t.isFieldVisible("roomType")?e("el-table-column",{attrs:{prop:"roomType",label:"房型",width:"100"}}):t._e()]:"003"===t.businessType?[t.isFieldVisible("trainNo")?e("el-table-column",{attrs:{prop:"trainNo",label:"车次",width:"90"}}):t._e(),t._v(" "),t.isFieldVisible("route")?e("el-table-column",{attrs:{prop:"route",label:"线路",width:"140"}}):t._e(),t._v(" "),t.isFieldVisible("seatType")?e("el-table-column",{attrs:{prop:"seatType",label:"座位等级",width:"100"}}):t._e()]:"004"===t.businessType?[t.isFieldVisible("route")?e("el-table-column",{attrs:{prop:"route",label:"起终点",width:"160"}}):t._e()]:t._e(),t._v(" "),t.isFieldVisible("legalEntity")?e("el-table-column",{attrs:{prop:"legalEntity",label:"法人实体",width:"160"}}):t._e(),t._v(" "),t.isFieldVisible("paymentAccount")?e("el-table-column",{attrs:{prop:"paymentAccount",label:"支付账户",width:"110"}}):t._e(),t._v(" "),t.isFieldVisible("costCenter")?e("el-table-column",{attrs:{prop:"costCenter",label:"成本中心",width:"90"}}):t._e(),t._v(" "),t.isFieldVisible("department")?e("el-table-column",{attrs:{prop:"department",label:"部门",width:"120"}}):t._e(),t._v(" "),t.isFieldVisible("project")?e("el-table-column",{attrs:{prop:"project",label:"项目",width:"120"}}):t._e(),t._v(" "),t.isFieldVisible("amount")?e("el-table-column",{attrs:{prop:"amount",label:"支付金额",width:"110",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(t.formatAmount(e.amount))+"\n      ")]}}],null,!1,1666599005)}):t._e()],2),t._v(" "),t.filteredOrders.length>0?e("div",{staticClass:"summary-footer"},[e("el-row",{attrs:{gutter:16}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"summary-item"},[e("span",{staticClass:"label"},[t._v("当前查看：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.filteredOrders.length)+"笔")])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"summary-item"},[e("span",{staticClass:"label"},[t._v("总金额：")]),t._v(" "),e("span",{staticClass:"value primary"},[t._v(t._s(t.formatAmount(t.totalAmount)))])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"summary-item"},[e("span",{staticClass:"label"},[t._v("已核对：")]),t._v(" "),e("span",{staticClass:"value success"},[t._v(t._s(t.checkedCount)+"笔")])])]),t._v(" "),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"summary-item"},[e("span",{staticClass:"label"},[t._v("未核对：")]),t._v(" "),e("span",{staticClass:"value warning"},[t._v(t._s(t.uncheckedCount)+"笔")])])])],1)],1):t._e(),t._v(" "),e("field-config-dialog",{attrs:{visible:t.fieldConfigVisible,"current-config":t.fieldConfig},on:{"update:visible":function(e){t.fieldConfigVisible=e},save:t.handleSaveFieldConfig}}),t._v(" "),e("el-dialog",{attrs:{title:"更新数据",visible:t.batchUpdateVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.batchUpdateVisible=e}}},[e("el-form",{attrs:{model:t.batchUpdateForm,"label-width":"100px"}},[e("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"批量更新提示",description:`即将更新 ${t.selectedOrders.length} 笔订单的数据，请选择要修改的字段`,type:"info",closable:!1}}),t._v(" "),e("el-form-item",{attrs:{label:"法人实体"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择法人实体",clearable:""},model:{value:t.batchUpdateForm.legalEntity,callback:function(e){t.$set(t.batchUpdateForm,"legalEntity",e)},expression:"batchUpdateForm.legalEntity"}},t._l(t.legalEntityOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"部门"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门",clearable:"",filterable:""},model:{value:t.batchUpdateForm.department,callback:function(e){t.$set(t.batchUpdateForm,"department",e)},expression:"batchUpdateForm.department"}},t._l(t.departmentOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"项目"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目",clearable:"",filterable:""},model:{value:t.batchUpdateForm.project,callback:function(e){t.$set(t.batchUpdateForm,"project",e)},expression:"batchUpdateForm.project"}},t._l(t.projectOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),e("el-alert",{attrs:{title:"只会更新您选择的字段，未选择的字段不会被修改",type:"warning",closable:!1}})],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.batchUpdateVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.confirmBatchUpdate}},[t._v("确定更新")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"批量修改数据",visible:t.batchModifyVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.batchModifyVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"info-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        请上传包含修改数据的Excel文件（.xlsx格式），可修改字段：法人实体、部门、项目\n      ")]),t._v(" "),e("el-form",{attrs:{model:t.batchModifyForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"上传文件",required:""}},[e("el-upload",{ref:"batchModifyFileUpload",attrs:{"auto-upload":!1,"on-change":t.handleBatchModifyFileChange,"on-remove":t.handleBatchModifyFileRemove,limit:1,accept:".xlsx,.xls","file-list":t.batchModifyFileList}},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v("选择文件")]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xlsx/xls文件，且不超过10MB。文件需包含订单号和要修改的字段列")])],1)],1)],1),t._v(" "),e("el-alert",{staticStyle:{"margin-top":"20px"},attrs:{title:"提示",description:"文件需包含订单号列，以及要修改的字段列（法人实体、部门、项目）。只会更新文件中指定的字段，未指定的字段不会被修改。",type:"info",closable:!1}})],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.batchModifyVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.batchModifying},on:{click:t.confirmBatchModify}},[t._v("确定修改")])],1)])],1)}),[],!1,null,"59975cce",null).exports},props:{billNo:{type:String,required:!0},billStatus:{type:Number,default:0}},data:()=>({activeBusinessType:""}),computed:{...Object(a.c)("order",["orderList"]),availableBusinessTypes(){if(!this.orderList||0===this.orderList.length)return[];const t=new Set;return this.orderList.forEach(e=>{e.businessType&&t.add(e.businessType)}),Array.from(t).sort()}},watch:{availableBusinessTypes:{immediate:!0,handler(t){t.length>0?this.activeBusinessType&&t.includes(this.activeBusinessType)||(this.activeBusinessType=t[0]):this.activeBusinessType=""}}},methods:{getBusinessTypeName:t=>n.BUSINESS_TYPE_NAMES[t]||"未知"}}),_=(i(328),Object(r.a)(g,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bill-orders-tab"},[e("el-tabs",{attrs:{type:"card"},model:{value:t.activeBusinessType,callback:function(e){t.activeBusinessType=e},expression:"activeBusinessType"}},[t._l(t.availableBusinessTypes,(function(i){return e("el-tab-pane",{key:i,attrs:{label:t.getBusinessTypeName(i),name:i}},[e("order-list-content",{attrs:{"bill-no":t.billNo,"business-type":i,"bill-status":t.billStatus}})],1)})),t._v(" "),0===t.availableBusinessTypes.length?e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),t._v(" "),e("p",[t._v("暂无订单数据")])]):t._e()],2)],1)}),[],!1,null,"040b150f",null).exports),y=i(306),x={name:"StatusTag",props:{type:{type:String,required:!0,validator:t=>["bill","invoice","business","invoice-status"].includes(t)},status:{type:[String,Number],required:!0},size:{type:String,default:"medium",validator:t=>["medium","small","mini"].includes(t)}},computed:{statusText(){switch(this.type){case"bill":return n.BILL_STATUS_NAMES[this.status]||"未知状态";case"invoice":return n.INVOICE_TYPE_SHORT_NAMES[this.status]||"未知类型";case"business":return n.BUSINESS_TYPE_NAMES[this.status]||"未知类型";case"invoice-status":return n.INVOICE_RECORD_STATUS_NAMES[this.status]||"未知状态";default:return""}},customTagClass(){switch(this.type){case"bill":return this.getBillStatusClass(this.status);case"invoice":return this.getInvoiceTypeClass(this.status);case"business":return this.getBusinessTypeClass(this.status);case"invoice-status":return this.getInvoiceStatusClass(this.status);default:return""}}},methods:{getBillStatusClass:t=>"custom-tag--"+n.BILL_STATUS_COLORS[t],getInvoiceTypeClass:t=>"custom-tag--"+({"#67c23a":"success","#2555FF":"primary","#9b59b6":"purple","#e6a23c":"warning"}[n.INVOICE_TYPE_COLORS[t]]||"info"),getBusinessTypeClass:t=>"custom-tag--"+({"#67c23a":"success","#2555FF":"primary","#e6a23c":"warning","#909399":"info"}[n.BUSINESS_TYPE_COLORS[t]]||"info"),getInvoiceStatusClass:t=>"custom-tag--"+n.INVOICE_RECORD_STATUS_COLORS[t]}},C=(i(330),{name:"InvoiceRecordTable",components:{StatusTag:Object(r.a)(x,(function(){return(0,this._self._c)("span",{class:["custom-tag","custom-tag--"+this.size,this.customTagClass]},[this._v("\n  "+this._s(this.statusText)+"\n")])}),[],!1,null,"b9c886a4",null).exports},props:{records:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},data(){return{selectedRecords:[],currentRecord:null,operating:!1,currentPage:1,pageSize:10,redFlushDialogVisible:!1,redFlushForm:{reason:""},reissueDialogVisible:!1,reissueForm:{titleName:"",taxNumber:"",address:"",bankName:"",bankAccount:""},reissueRules:{titleName:[{required:!0,message:"请输入发票抬头",trigger:"blur"}],taxNumber:[{required:!0,message:"请输入税号",trigger:"blur"},{validator:this.validateTaxNumberRule,trigger:"blur"}]},partialRedFlushDialogVisible:!1,partialRedFlushForm:{reason:""},fileList:[],itineraryRedFlushDialogVisible:!1,itineraryRedFlushForm:{reason:""},itineraryFileList:[],statusMap:{pending:"待处理",processing:"处理中",completed:"已开票",failed:"失败",flushed:"已红冲"},statusColorMap:{pending:"info",processing:"primary",completed:"success",failed:"danger",flushed:"warning"}}},computed:{total(){return this.records.length},paginatedRecords(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.records.slice(t,e)}},methods:{formatAmount:t=>Object(l.a)(t),formatDate:t=>Object(l.c)(t,"YYYY-MM-DD HH:mm"),getInvoiceTypeColor:t=>t.includes("专用")?"warning":t.includes("行程单")?"primary":"",getStatusName(t){return this.statusMap[t]||t},getStatusType(t){return this.statusColorMap[t]||""},handleSelectionChange(t){this.selectedRecords=t},handleBatchDownload(){0!==this.selectedRecords.length?Object(s.c)(`批量下载功能开发中，已选择 ${this.selectedRecords.length} 条记录`):Object(s.c)("请选择要下载的发票")},handleDownload(t){this.$emit("download",t)},handleRedFlush(t){this.currentRecord=t,this.isItineraryInvoice(t)?(this.itineraryRedFlushForm.reason="",this.itineraryFileList=[],this.itineraryRedFlushDialogVisible=!0):(this.redFlushForm.reason="",this.redFlushDialogVisible=!0)},async confirmRedFlush(){if(this.redFlushForm.reason&&""!==this.redFlushForm.reason.trim()){this.operating=!0;try{await this.$emit("red-flush",{record:this.currentRecord,reason:this.redFlushForm.reason}),Object(s.b)("红冲操作成功"),this.redFlushDialogVisible=!1}catch(t){}finally{this.operating=!1}}else Object(s.c)("请输入红冲原因")},handleReissue(t){this.currentRecord=t,this.reissueForm={titleName:"",taxNumber:"",address:"",bankName:"",bankAccount:""},this.reissueDialogVisible=!0},async confirmReissue(){try{await this.$refs.reissueForm.validate()}catch(t){return}this.operating=!0;try{await this.$emit("reissue",{record:this.currentRecord,newTitle:this.reissueForm}),Object(s.b)("换开操作成功"),this.reissueDialogVisible=!1}catch(t){}finally{this.operating=!1}},validateTaxNumberRule(t,e,i){e?Object(y.c)(e)?i():i(new Error("请输入正确的税号格式")):i(new Error("请输入税号"))},handleSizeChange(t){this.pageSize=t,this.currentPage=1},handleCurrentChange(t){this.currentPage=t},isVATInvoice(t){if(!t||!t.invoiceType)return!1;const e=String(t.invoiceType);return e.includes("增值税")&&!e.includes("行程单")},isItineraryInvoice(t){if(!t||!t.invoiceType)return!1;const e=String(t.invoiceType);return e.includes("行程单")||e.includes("火车票")},getItineraryRedFlushTitle(){if(!this.currentRecord)return"红冲";const t=String(this.currentRecord.invoiceType);return t.includes("机票")?"机票行程单红冲":t.includes("火车票")?"火车票行程单红冲":"行程单红冲"},handlePartialRedFlush(t){this.currentRecord=t,this.partialRedFlushForm.reason="",this.fileList=[],this.partialRedFlushDialogVisible=!0},handleFileChange(t,e){if(!(t.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.fileList=e.filter(e=>e.uid!==t.uid));const i=t.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.fileList=e.filter(e=>e.uid!==t.uid));this.fileList=e},handleFileRemove(t,e){this.fileList=e},async confirmPartialRedFlush(){if(this.fileList&&0!==this.fileList.length)if(this.partialRedFlushForm.reason&&""!==this.partialRedFlushForm.reason.trim()){this.operating=!0;try{const t=this.fileList[0].raw;console.log("部分红冲文件:",t),console.log("部分红冲原因:",this.partialRedFlushForm.reason),console.log("申请编号:",this.currentRecord.applicationNo),await new Promise(t=>setTimeout(t,1e3)),Object(s.b)("部分红冲操作成功"),this.partialRedFlushDialogVisible=!1,this.fileList=[],this.partialRedFlushForm.reason="",this.$emit("refresh")}catch(t){Object(s.a)(t,{customMessage:"部分红冲操作失败"})}finally{this.operating=!1}}else Object(s.c)("请输入部分红冲原因");else Object(s.c)("请上传Excel文件")},handleItineraryFileChange(t,e){if(!(t.raw.size/1024/1024<10))return Object(s.c)("上传文件大小不能超过 10MB!"),void(this.itineraryFileList=e.filter(e=>e.uid!==t.uid));const i=t.name.toLowerCase();if(!i.endsWith(".xlsx")&&!i.endsWith(".xls"))return Object(s.c)("只能上传 xlsx 或 xls 格式的文件!"),void(this.itineraryFileList=e.filter(e=>e.uid!==t.uid));this.itineraryFileList=e},handleItineraryFileRemove(t,e){this.itineraryFileList=e},async confirmItineraryRedFlush(){if(this.itineraryFileList&&0!==this.itineraryFileList.length)if(this.itineraryRedFlushForm.reason&&""!==this.itineraryRedFlushForm.reason.trim()){this.operating=!0;try{const t=this.itineraryFileList[0].raw;console.log("行程单/火车票红冲文件:",t),console.log("红冲原因:",this.itineraryRedFlushForm.reason),console.log("申请编号:",this.currentRecord.applicationNo),console.log("发票类型:",this.currentRecord.invoiceType),await new Promise(t=>setTimeout(t,1e3)),Object(s.b)("红冲操作成功"),this.itineraryRedFlushDialogVisible=!1,this.itineraryFileList=[],this.itineraryRedFlushForm.reason="",this.$emit("refresh")}catch(t){Object(s.a)(t,{customMessage:"红冲操作失败"})}finally{this.operating=!1}}else Object(s.c)("请输入红冲原因");else Object(s.c)("请上传包含票号/订单信息的Excel文件")}}}),w=(i(332),{name:"InvoiceSummaryContent",components:{InvoiceRecordTable:Object(r.a)(C,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"invoice-record-table"},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"header-actions"},[t.selectedRecords.length>0?e("el-button",{attrs:{size:"small",icon:"el-icon-download"},on:{click:t.handleBatchDownload}},[t._v("\n        批量下载\n      ")]):t._e()],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.paginatedRecords,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),e("el-table-column",{attrs:{prop:"invoiceType",label:"发票类型",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(e.invoiceType)+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"content",label:"发票内容","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tooltip",{attrs:{content:i.content,placement:"top"}},[e("div",{staticClass:"text-ellipsis"},[t._v(t._s(i.content))])])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"amount",label:"开票金额",width:"120",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(t.formatAmount(e.amount))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"titleName",label:"发票抬头",width:"200"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tooltip",{attrs:{content:"税号："+i.taxNumber,placement:"top"}},[e("div",{staticClass:"text-ellipsis"},[t._v(t._s(i.titleName))])])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"submitter",label:"提交人",width:"180"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(e.submitter)+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"applyTime",label:"申请时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n        "+t._s(t.formatDate(e.applyTime))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:t}){return[e("StatusTag",{attrs:{type:"invoice-status",status:t.status||(t.isFlushed?"flushed":"completed"),size:"small"}})]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return["completed"===i.status||"flushed"===i.status?e("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.handleDownload(i)}}},[t._v("\n          下载\n        ")]):t._e(),t._v(" "),"completed"!==i.status||i.isFlushed?t._e():e("el-link",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",underline:!1},on:{click:function(e){return t.handleRedFlush(i)}}},[t._v("\n          红冲\n        ")]),t._v(" "),t.isVATInvoice(i)&&"completed"===i.status&&!i.isFlushed?e("el-link",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",underline:!1},on:{click:function(e){return t.handlePartialRedFlush(i)}}},[t._v("\n          部分红冲\n        ")]):t._e()]}}])})],1),t._v(" "),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{title:"确认红冲",visible:t.redFlushDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.redFlushDialogVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"warning-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        确认要对以下发票进行红冲操作吗？\n      ")]),t._v(" "),t.currentRecord?e("div",{staticClass:"record-info"},[e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("申请编号：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.applicationNo))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("发票类型：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.invoiceType))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("开票金额：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.formatAmount(t.currentRecord.amount)))])])]):t._e(),t._v(" "),e("el-form",{attrs:{model:t.redFlushForm,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"红冲原因"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入红冲原因"},model:{value:t.redFlushForm.reason,callback:function(e){t.$set(t.redFlushForm,"reason",e)},expression:"redFlushForm.reason"}})],1)],1),t._v(" "),e("p",{staticClass:"hint-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        红冲后该发票将作废，可以进行换开操作。\n      ")])],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.redFlushDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"warning",loading:t.operating},on:{click:t.confirmRedFlush}},[t._v("确定红冲")])],1)]),t._v(" "),e("el-dialog",{attrs:{title:"换开发票",visible:t.reissueDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.reissueDialogVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"info-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        请填写新的发票抬头信息\n      ")]),t._v(" "),e("el-form",{ref:"reissueForm",attrs:{model:t.reissueForm,rules:t.reissueRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"发票抬头",prop:"titleName"}},[e("el-input",{attrs:{placeholder:"请输入发票抬头"},model:{value:t.reissueForm.titleName,callback:function(e){t.$set(t.reissueForm,"titleName",e)},expression:"reissueForm.titleName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"税号",prop:"taxNumber"}},[e("el-input",{attrs:{placeholder:"请输入税号"},model:{value:t.reissueForm.taxNumber,callback:function(e){t.$set(t.reissueForm,"taxNumber",e)},expression:"reissueForm.taxNumber"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"地址电话"}},[e("el-input",{attrs:{placeholder:"请输入地址和电话"},model:{value:t.reissueForm.address,callback:function(e){t.$set(t.reissueForm,"address",e)},expression:"reissueForm.address"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"开户行"}},[e("el-input",{attrs:{placeholder:"请输入开户行"},model:{value:t.reissueForm.bankName,callback:function(e){t.$set(t.reissueForm,"bankName",e)},expression:"reissueForm.bankName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"银行账号"}},[e("el-input",{attrs:{placeholder:"请输入银行账号"},model:{value:t.reissueForm.bankAccount,callback:function(e){t.$set(t.reissueForm,"bankAccount",e)},expression:"reissueForm.bankAccount"}})],1)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.reissueDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.operating},on:{click:t.confirmReissue}},[t._v("确定换开")])],1)]),t._v(" "),e("el-dialog",{attrs:{title:"部分红冲",visible:t.partialRedFlushDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.partialRedFlushDialogVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"info-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        请上传包含部分红冲信息的Excel文件（.xlsx格式）\n      ")]),t._v(" "),t.currentRecord?e("div",{staticClass:"record-info"},[e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("申请编号：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.applicationNo))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("发票类型：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.invoiceType))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("开票金额：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.formatAmount(t.currentRecord.amount)))])])]):t._e(),t._v(" "),e("el-form",{attrs:{model:t.partialRedFlushForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"上传文件",required:""}},[e("el-upload",{ref:"fileUpload",attrs:{"auto-upload":!1,"on-change":t.handleFileChange,"on-remove":t.handleFileRemove,limit:1,accept:".xlsx,.xls","file-list":t.fileList}},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v("选择文件")]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xlsx/xls文件，且不超过10MB")])],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"红冲原因"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入部分红冲原因"},model:{value:t.partialRedFlushForm.reason,callback:function(e){t.$set(t.partialRedFlushForm,"reason",e)},expression:"partialRedFlushForm.reason"}})],1)],1),t._v(" "),e("p",{staticClass:"hint-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        部分红冲后，剩余金额仍可正常使用。\n      ")])],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.partialRedFlushDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"danger",loading:t.operating},on:{click:t.confirmPartialRedFlush}},[t._v("确定部分红冲")])],1)]),t._v(" "),e("el-dialog",{attrs:{title:t.getItineraryRedFlushTitle(),visible:t.itineraryRedFlushDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.itineraryRedFlushDialogVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"info-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        请上传包含需要红冲的票号/订单信息的Excel文件（.xlsx格式）\n      ")]),t._v(" "),t.currentRecord?e("div",{staticClass:"record-info"},[e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("申请编号：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.applicationNo))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("发票类型：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.currentRecord.invoiceType))])]),t._v(" "),e("div",{staticClass:"info-row"},[e("span",{staticClass:"label"},[t._v("开票金额：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.formatAmount(t.currentRecord.amount)))])])]):t._e(),t._v(" "),e("el-form",{attrs:{model:t.itineraryRedFlushForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"上传文件",required:""}},[e("el-upload",{ref:"itineraryFileUpload",attrs:{"auto-upload":!1,"on-change":t.handleItineraryFileChange,"on-remove":t.handleItineraryFileRemove,limit:1,accept:".xlsx,.xls","file-list":t.itineraryFileList}},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v("选择文件")]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xlsx/xls文件，且不超过10MB。文件需包含票号/订单号列")])],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"红冲原因"}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入红冲原因"},model:{value:t.itineraryRedFlushForm.reason,callback:function(e){t.$set(t.itineraryRedFlushForm,"reason",e)},expression:"itineraryRedFlushForm.reason"}})],1)],1),t._v(" "),e("p",{staticClass:"hint-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        红冲后该发票将作废，可以进行换开操作。\n      ")])],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.itineraryRedFlushDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"warning",loading:t.operating},on:{click:t.confirmItineraryRedFlush}},[t._v("确定红冲")])],1)])],1)}),[],!1,null,"c20efa32",null).exports},props:{billNo:{type:String,required:!0}},data:()=>({loading:!1,activeTab:"unified",batchDownloadDialogVisible:!1,batchDownloadFilter:{invoiceType:"",titleName:"",submitter:""}}),computed:{...Object(a.c)("invoice",["invoiceSummary","applicationList","invoiceTitles"]),summary(){return{totalAmount:this.invoiceSummary.shouldInvoiceAmount||0,invoicedAmount:this.invoiceSummary.invoicedAmount||0,remainingAmount:this.invoiceSummary.remainingAmount||0,details:this.invoiceSummary.invoiceDetails||[]}},invoiceTypeOptions(){const t=new Set;return this.applicationList.forEach(e=>{e.invoiceType&&t.add(e.invoiceType)}),Array.from(t).map(t=>({label:t,value:t}))},titleNameOptions(){const t=new Set;return this.applicationList.forEach(e=>{e.titleName&&t.add(e.titleName)}),Array.from(t).map(t=>({label:t,value:t}))},submitterOptions(){const t=new Set;return this.applicationList.forEach(e=>{e.submitter&&t.add(e.submitter)}),Array.from(t).map(t=>({label:t,value:t}))},hasFilter(){return!!(this.batchDownloadFilter.invoiceType||this.batchDownloadFilter.titleName||this.batchDownloadFilter.submitter)}},created(){this.loadData()},methods:{...Object(a.b)("invoice",["fetchInvoiceSummary","fetchInvoiceApplications","downloadInvoice","redFlushInvoice","reissueInvoice"]),async loadData(){this.loading=!0;try{await Promise.all([this.fetchInvoiceSummary(this.billNo),this.fetchInvoiceApplications(this.billNo)])}catch(t){Object(s.a)(t,{customMessage:"加载开票数据失败"})}finally{this.loading=!1}},formatAmount:t=>Object(l.a)(t),formatDate:(t,e="YYYY-MM-DD HH:mm")=>Object(l.c)(t,e),getStatusName:t=>n.INVOICE_STATUS_NAMES[t]||"-",getStatusType:t=>n.INVOICE_STATUS_COLORS[t]||"",async handleDownload(t){try{this.loading=!0;const e=await this.downloadInvoice(t.applicationNo);e&&e.data&&e.data.fileUrl&&(Object(s.b)("发票下载成功！\n申请编号："+t.applicationNo),this.$message.info({message:"Demo环境：实际环境中将自动下载PDF文件到本地",duration:3e3}))}catch(t){Object(s.a)(t,{customMessage:"下载发票失败"})}finally{this.loading=!1}},async handleRedFlush(t){const{record:e,reason:i}=t;try{this.loading=!0,await this.redFlushInvoice({applicationNo:e.applicationNo,reason:i}),Object(s.b)("红冲操作成功"),await this.loadData()}catch(t){throw Object(s.a)(t,{customMessage:"红冲操作失败"}),t}finally{this.loading=!1}},async handleReissue(t){const{record:e,newTitle:i}=t;try{this.loading=!0,await this.reissueInvoice({applicationNo:e.applicationNo,newTitle:i}),Object(s.b)("换开操作成功"),await this.loadData()}catch(t){throw Object(s.a)(t,{customMessage:"换开操作失败"}),t}finally{this.loading=!1}},handleViewElectronicTickets(){Object(s.c)("查看数电票功能开发中")},handleBatchDownload(){this.batchDownloadFilter={invoiceType:"",titleName:"",submitter:""},this.batchDownloadDialogVisible=!0},async confirmBatchDownload(){try{const t=this.applicationList.filter(t=>(!this.batchDownloadFilter.invoiceType||t.invoiceType===this.batchDownloadFilter.invoiceType)&&((!this.batchDownloadFilter.titleName||t.titleName===this.batchDownloadFilter.titleName)&&(!this.batchDownloadFilter.submitter||t.submitter===this.batchDownloadFilter.submitter)));if(0===t.length)return void Object(s.c)("没有符合条件的发票可下载");this.loading=!0,console.log("批量下载筛选条件:",this.batchDownloadFilter),console.log("符合条件的记录数:",t.length),console.log("符合条件的记录:",t),await new Promise(t=>setTimeout(t,1e3)),Object(s.b)(`已选择 ${t.length} 条发票，开始批量下载`),this.batchDownloadDialogVisible=!1}catch(t){Object(s.a)(t,{customMessage:"批量下载失败"})}finally{this.loading=!1}},getFilteredCount(){return this.applicationList.filter(t=>(!this.batchDownloadFilter.invoiceType||t.invoiceType===this.batchDownloadFilter.invoiceType)&&((!this.batchDownloadFilter.titleName||t.titleName===this.batchDownloadFilter.titleName)&&(!this.batchDownloadFilter.submitter||t.submitter===this.batchDownloadFilter.submitter))).length}}}),F=(i(334),Object(r.a)(w,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"invoice-summary-content"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[t._m(0),t._v(" "),e("div",{staticClass:"invoice-amount-summary"},[e("div",{staticClass:"amount-cards"},[e("div",{staticClass:"amount-card"},[e("div",{staticClass:"amount-label"},[t._v("应开票金额")]),t._v(" "),e("div",{staticClass:"amount-value"},[t._v(t._s(t.formatAmount(t.summary.totalAmount)))])]),t._v(" "),e("div",{staticClass:"amount-card"},[e("div",{staticClass:"amount-label"},[t._v("已开票金额")]),t._v(" "),e("div",{staticClass:"amount-value"},[t._v(t._s(t.formatAmount(t.summary.invoicedAmount)))])]),t._v(" "),e("div",{staticClass:"amount-card remaining-amount-card"},[e("div",{staticClass:"amount-label"},[t._v("还可提交金额")]),t._v(" "),e("div",{staticClass:"amount-value"},[t._v(t._s(t.formatAmount(t.summary.remainingAmount)))])])]),t._v(" "),e("div",{staticClass:"amount-details-table"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.summary.details,border:"",size:"small"}},[e("el-table-column",{attrs:{prop:"type",label:"发票种类",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{prop:"summary",label:"发票摘要",width:"150"}}),t._v(" "),e("el-table-column",{attrs:{prop:"shouldAmount",label:"应开票金额",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n              "+t._s(t.formatAmount(e.shouldAmount))+"\n            ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"invoicedAmount",label:"已开票金额",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n              "+t._s(t.formatAmount(e.invoicedAmount))+"\n            ")]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"remainingAmount",label:"还可提交金额",width:"130",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n              "+t._s(t.formatAmount(e.remainingAmount))+"\n            ")]}}])})],1)],1)]),t._v(" "),e("div",{staticClass:"invoice-applications"},[e("div",{staticClass:"applications-header"},[e("h3",{staticClass:"section-title"},[t._v("开票申请记录")]),t._v(" "),e("div",{staticClass:"header-actions"},[e("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.handleBatchDownload}},[t._v("\n            批量下载发票\n          ")])],1)]),t._v(" "),e("invoice-record-table",{attrs:{records:t.applicationList,loading:t.loading},on:{download:t.handleDownload,"red-flush":t.handleRedFlush,reissue:t.handleReissue,refresh:t.loadData}})],1)]),t._v(" "),e("el-dialog",{attrs:{title:"批量下载发票",visible:t.batchDownloadDialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.batchDownloadDialogVisible=e}}},[e("div",{staticClass:"dialog-content"},[e("p",{staticClass:"info-message"},[e("i",{staticClass:"el-icon-info"}),t._v("\n        请选择筛选条件，系统将下载符合条件的发票\n      ")]),t._v(" "),e("el-form",{attrs:{model:t.batchDownloadFilter,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"发票种类"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:t.batchDownloadFilter.invoiceType,callback:function(e){t.$set(t.batchDownloadFilter,"invoiceType",e)},expression:"batchDownloadFilter.invoiceType"}},t._l(t.invoiceTypeOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"发票抬头"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:t.batchDownloadFilter.titleName,callback:function(e){t.$set(t.batchDownloadFilter,"titleName",e)},expression:"batchDownloadFilter.titleName"}},t._l(t.titleNameOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"申请人"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"全部",clearable:""},model:{value:t.batchDownloadFilter.submitter,callback:function(e){t.$set(t.batchDownloadFilter,"submitter",e)},expression:"batchDownloadFilter.submitter"}},t._l(t.submitterOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),t.hasFilter?e("div",{staticClass:"filter-preview"},[e("div",{staticClass:"preview-title"},[t._v("筛选结果预览")]),t._v(" "),e("div",{staticClass:"preview-content"},[e("p",[t._v("符合条件的发票数量："),e("strong",[t._v(t._s(t.getFilteredCount()))]),t._v(" 条")])])]):t._e()],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.batchDownloadDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.confirmBatchDownload}},[t._v("确定下载")])],1)])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"summary-header"},[t("h2",{staticClass:"page-title"},[this._v("开票汇总")])])}],!1,null,"089bbc18",null).exports),S=i(315),T=i(316),k={name:"BillDetail",components:{BillSummaryContent:d,BillOrdersTab:_,InvoiceSummaryContent:F,InvoiceForm:S.a,InvoiceSplitConfig:T.a},data(){return{billNo:this.$route.params.billNo,activeTab:"summary",confirmDialogVisible:!1,cancelDialogVisible:!1,submitting:!1,BILL_STATUS:n.BILL_STATUS,showInvoiceForm:!1,invoiceFormLoading:!1,invoiceRows:[],invoiceTitles:[],invoiceTotalAmount:0,invoiceRowCount:0,splitConfigVisible:!1,splitConfig:{dimensions:[]}}},computed:{...Object(a.c)("bill",["currentBill","loading"]),...Object(a.c)("order",["orderList"]),splitConfigured(){const t=this.$store.state.config.splitConfig;return t&&t.dimensions&&t.dimensions.length>0},billSummary(){return this.currentBill&&this.currentBill.summary},checkedOrderCount(){return this.billSummary&&this.billSummary.businessLineSummary?this.billSummary.businessLineSummary.reduce((t,e)=>t+(e.checkedCount||0),0):0},currentStep(){if(!this.currentBill)return 0;return{[n.BILL_STATUS.PENDING_CONFIRM]:0,[n.BILL_STATUS.ADJUSTING]:0,[n.BILL_STATUS.INVOICING]:1,[n.BILL_STATUS.PENDING_PAYMENT]:2,[n.BILL_STATUS.SETTLED]:3}[this.currentBill.billStatus]||0},invoicingSubStatus(){return this.showInvoiceForm?"填写开票信息":"invoice"===this.activeTab?"开票汇总":""},canSubmitInvoice(){if(0===this.invoiceRowCount||0===this.invoiceTotalAmount)return!1;return this.invoiceRows.filter(t=>{if(t.isGroup)return!0;const e=!(!t.invoiceType&&!t.invoiceTypeName),i=!(!t.titleId||!t.titleName),a=!!(t.receiverId&&t.receiverName&&t.receiverPhone&&t.receiverEmail&&t.receiverAddress),n=t.quantity>=1&&t.quantity<=99999;return e&&i&&a&&n}).length===this.invoiceRowCount}},async created(){await this.loadBillDetail(),await this.checkAndRestoreInvoicingState(),this.initActiveTab(),this.initSplitConfig()},methods:{...Object(a.b)("bill",["fetchBillDetail","confirmBill","cancelConfirm"]),...Object(a.b)("order",["fetchOrderList"]),async loadBillDetail(){try{await this.fetchBillDetail(this.billNo),await this.fetchOrderList(this.billNo)}catch(t){Object(s.a)(t,{customMessage:"加载账单详情失败"})}},async checkAndRestoreInvoicingState(){if(this.currentBill&&this.currentBill.billStatus===n.BILL_STATUS.INVOICING)try{const t=i(2).default,e=await t.getInvoiceApplications(this.billNo),a=e&&e.data&&e.data.list&&e.data.list.length>0;console.log("检查开票状态 - billStatus:",this.currentBill.billStatus),console.log("检查开票状态 - hasApplications:",a),a?(console.log("检测到开票中状态且有开票记录，显示开票汇总"),this.activeTab="invoice"):(console.log("检测到开票中状态且无开票记录，恢复开票信息表"),await this.proceedToInvoiceForm())}catch(t){console.warn("检查开票状态失败:",t)}},initSplitConfig(){const t=this.$store.state.config.splitConfig;if(t&&t.dimensions&&Array.isArray(t.dimensions)&&t.dimensions.length>0)this.splitConfig={dimension1:t.dimension1,dimension2:t.dimension2,dimensions:[...t.dimensions]};else if(t&&(t.dimension1||t.dimension2)){const e=[];t.dimension1&&e.push(t.dimension1),t.dimension2&&e.push(t.dimension2),this.splitConfig={dimension1:t.dimension1,dimension2:t.dimension2,dimensions:e}}else{const{SPLIT_DIMENSION:t}=i(0);this.splitConfig={dimension1:t.BUSINESS_LINE,dimension2:null,dimensions:[t.BUSINESS_LINE]}}console.log("初始化拆分汇总配置:",this.splitConfig)},initActiveTab(){this.currentBill&&(this.showInvoiceForm?this.activeTab="summary":this.$route.query.tab?this.activeTab=this.$route.query.tab:this.currentBill&&this.currentBill.billStatus>=n.BILL_STATUS.INVOICING?this.activeTab="invoice":this.activeTab="summary")},handleConfirmBill(){this.confirmDialogVisible=!0},async confirmBillAction(){this.submitting=!0;try{await this.confirmBill(this.billNo),Object(s.b)("账单确认成功，所有订单已标记为已核对"),this.confirmDialogVisible=!1,await new Promise(t=>setTimeout(t,100)),await this.loadBillDetail(),this.$forceUpdate(),await this.handleApplyInvoice()}catch(t){Object(s.a)(t,{customMessage:"账单确认失败"})}finally{this.submitting=!1}},handleCancelConfirm(){this.cancelDialogVisible=!0},async cancelConfirmAction(){this.submitting=!0;try{this.showInvoiceForm&&this.exitInvoiceForm(),await this.cancelConfirm(this.billNo),Object(s.b)("账单确认已撤销"),this.cancelDialogVisible=!1,await new Promise(t=>setTimeout(t,100)),await this.loadBillDetail(),this.$forceUpdate(),this.activeTab="summary"}catch(t){Object(s.a)(t,{customMessage:"撤销确认失败"})}finally{this.submitting=!1}},async handleApplyInvoice(){if(this.splitConfig||(this.splitConfig={dimensions:[]}),this.splitConfig.dimensions&&Array.isArray(this.splitConfig.dimensions)||(this.splitConfig.dimensions=[]),0===this.splitConfig.dimensions.length){const{SPLIT_DIMENSION:t}=i(0);this.splitConfig={dimensions:[t.BUSINESS_LINE]},await this.$store.dispatch("config/saveSplitConfig",{dimension1:t.BUSINESS_LINE,dimension2:null,dimensions:[t.BUSINESS_LINE]})}if(console.log("handleApplyInvoice - splitConfig:",this.splitConfig),this.currentBill.billStatus===n.BILL_STATUS.PENDING_INVOICE)try{const t=i(2).default;await t.startInvoicing(this.billNo),await this.loadBillDetail()}catch(t){console.error("开始开票失败:",t)}await this.proceedToInvoiceForm()},async proceedToInvoiceForm(){this.invoiceFormLoading=!0,this.showInvoiceForm=!0;try{await this.loadInvoiceData()}catch(t){Object(s.a)(t,{customMessage:"加载开票数据失败"}),this.showInvoiceForm=!1}finally{this.invoiceFormLoading=!1}},exitInvoiceForm(){this.showInvoiceForm=!1,this.invoiceRows=[]},handleCancelConfirmFromInvoice(){this.exitInvoiceForm(),this.handleCancelConfirm()},async loadInvoiceData(){try{const t=i(2).default,e=await t.getInvoiceTitles();if(!e||!e.data)throw new Error("获取发票抬头失败");this.invoiceTitles=e.data.list||[],console.log("loadInvoiceData - invoiceTitles:",this.invoiceTitles);const a=await t.getInvoiceSummary(this.billNo);if(!a||!a.data)throw new Error("获取开票汇总失败");const n=a.data;let l=this.splitConfig;if(l||(l={dimensions:[]}),!l.dimensions||!Array.isArray(l.dimensions))if(l.dimension1||l.dimension2){const t=[];l.dimension1&&t.push(l.dimension1),l.dimension2&&t.push(l.dimension2),l={...l,dimensions:t}}else{const{SPLIT_DIMENSION:t}=i(0);l={dimensions:[t.BUSINESS_LINE]}}const s=await t.generateInvoiceRows(this.billNo,l);if(!s||!s.data)throw new Error("生成开票行失败");let o=s.data||[];Array.isArray(o)||(console.warn("开票行数据格式不正确，使用空数组"),o=[]),console.log("loadInvoiceData - 原始 invoiceRows:",o.slice(0,2)),o=o.map((t,e)=>{let i=t.titleId||"",a=t.titleName||"",n=t.taxNumber||"";t.invoiceTitle&&"object"==typeof t.invoiceTitle&&(i=t.invoiceTitle.titleId||i,a=t.invoiceTitle.titleName||a,n=t.invoiceTitle.taxNumber||n);let l=t.receiverId||"",s=t.receiverName||"",o=t.receiverPhone||"",r=t.receiverEmail||"",c=t.receiverAddress||"";t.recipient&&"object"==typeof t.recipient&&(l=t.recipient.id||l,s=t.recipient.name||s,o=t.recipient.phone||o,r=t.recipient.email||r,c=t.recipient.address||c);return{id:t.id||"invoice_row_"+e,invoiceType:t.invoiceType||t.invoiceTypeName||"",invoiceTypeName:t.invoiceTypeName||t.invoiceType||"",summary:t.summary||t.invoiceSummary||"",invoiceSummary:t.invoiceSummary||t.summary||"",amount:t.amount||0,orderCount:t.orderCount||0,quantity:t.quantity||1,unit:t.unit||"元",titleId:i,titleName:a,taxNumber:n,receiverId:l,receiverName:s,receiverPhone:o,receiverEmail:r,receiverAddress:c,splitDimension1:t.splitDimension1||t.businessLine||"",splitDimension2:t.splitDimension2||t.legalEntity||"",businessLine:t.businessLine||t.splitDimension1||"",legalEntity:t.legalEntity||t.splitDimension2||"",paymentAccount:t.paymentAccount||t.splitDimension1||"",department:t.department||t.splitDimension2||"",isValid:void 0!==t.isValid&&t.isValid}}),n&&n.invoiceDetails&&n.invoiceDetails.length>0&&(o=o.map(t=>{const e=t.invoiceType||t.invoiceTypeName||"",i=t.invoiceSummary||t.summary||"",a=n.invoiceDetails.find(a=>{const n=e===a.type||String(e).includes(a.type)||a.type.includes(String(e))||t.invoiceTypeName===a.type,l=i===a.summary||i.includes(a.summary)||a.summary.includes(i);return n&&l});return a&&a.remainingAmount>0?{...t,amount:a.remainingAmount,orderCount:a.orderCount||t.orderCount}:t})),this.invoiceRows=o,console.log("loadInvoiceData - 最终 invoiceRows:",this.invoiceRows.slice(0,2)),this.updateInvoiceStats(),console.log("loadInvoiceData - 统计信息:",{rowCount:this.invoiceRowCount,totalAmount:this.invoiceTotalAmount})}catch(t){throw console.error("加载开票数据错误:",t),t}},updateInvoiceStats(){this.invoiceRowCount=this.invoiceRows.length,this.invoiceTotalAmount=this.invoiceRows.reduce((t,e)=>t+(e.amount||0),0)},handleInvoiceFormUpdate(t){t&&t.invoiceRows?this.invoiceRows=t.invoiceRows:Array.isArray(t)&&(this.invoiceRows=t),this.updateInvoiceStats()},async handleSubmitInvoice(t){try{await this.$confirm("请确认当期开票信息无误","确认提交",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}catch(t){return}this.submitting=!0;try{const e=i(2).default;await e.applyInvoice({billNo:this.billNo,invoiceRows:t||this.invoiceRows}),Object(s.b)("开票申请提交成功"),this.exitInvoiceForm(),await new Promise(t=>setTimeout(t,100)),await Promise.all([this.loadBillDetail(),this.$store.dispatch("invoice/fetchInvoiceSummary",this.billNo),this.$store.dispatch("invoice/fetchInvoiceApplications",this.billNo)]),this.$forceUpdate(),this.activeTab="invoice"}catch(t){Object(s.a)(t,{customMessage:"提交开票申请失败"})}finally{this.submitting=!1}},handleDetailSettings(){this.splitConfigVisible=!0},openSplitConfig(){this.splitConfigVisible=!0},async handleSaveSplitConfig(t){try{const e=[];t.dimension1&&e.push(t.dimension1),t.dimension2&&e.push(t.dimension2),await this.$store.dispatch("config/saveSplitConfig",t),this.splitConfig={...t,dimensions:e},this.splitConfigVisible=!1,Object(s.b)("拆分汇总配置已保存"),this.currentBill&&this.currentBill.billStatus===n.BILL_STATUS.INVOICING?await this.proceedToInvoiceForm():this.showInvoiceForm||await this.loadBillDetail()}catch(t){Object(s.a)(t,{customMessage:"保存拆分汇总配置失败"})}},handleExportExcel(){Object(s.c)("导出Excel功能将在User Story 4实现")},handleExportPDF(){Object(s.c)("导出PDF功能将在User Story 4实现")},handleExportInvoiceInfo(){},formatBillCycleRange(t){return t?Object(l.b)(t,this.currentBill):"-"},formatAmount:t=>Object(l.a)(t),getBillStatusName:t=>n.BILL_STATUS_NAMES[t]||"-",getBillStatusType:t=>n.BILL_STATUS_COLORS[t]||"",formatDate:(t,e="YYYY-MM-DD")=>Object(l.c)(t,e)}},N=(i(342),Object(r.a)(k,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bill-detail-page"},[e("div",{staticClass:"breadcrumb-container"},[e("span",{staticClass:"breadcrumb-item",on:{click:function(e){return t.$router.back()}}},[t._v("账单列表")]),t._v(" "),e("span",{staticClass:"breadcrumb-separator"},[t._v(">")]),t._v(" "),e("span",{staticClass:"breadcrumb-item active"},[t._v("账单详情")])]),t._v(" "),t.loading?e("div",{staticClass:"loading-container"},[e("el-skeleton",{attrs:{rows:8,animated:""}})],1):t.currentBill?e("div",{staticClass:"bill-content"},[e("el-card",{staticClass:"steps-card",attrs:{shadow:"never"}},[e("el-steps",{attrs:{active:t.currentStep,"finish-status":"success","align-center":""}},[e("el-step",{attrs:{title:"确认账单"}},[t.currentBill&&t.currentBill.confirmTime?[e("div",{staticClass:"step-description",attrs:{slot:"description"},slot:"description"},[t._v("\n              确认日期: "+t._s(t.formatDate(t.currentBill.confirmTime,"YYYY-MM-DD"))+"\n            ")])]:t._e()],2),t._v(" "),e("el-step",{attrs:{title:"开票"}},[t.currentBill&&t.currentBill.billStatus===t.BILL_STATUS.INVOICING?[e("div",{staticClass:"step-description",attrs:{slot:"description"},slot:"description"},[t._v("\n              "+t._s(t.invoicingSubStatus)+"\n            ")])]:t._e()],2),t._v(" "),e("el-step",{attrs:{title:"付款"}}),t._v(" "),e("el-step",{attrs:{title:"已结清"}})],1)],1),t._v(" "),t.splitConfigured?t._e():e("div",{staticClass:"split-config-banner"},[e("i",{staticClass:"el-icon-info"}),t._v(" "),e("span",[t._v("建议配置拆分汇总维度以更准确地生成开票信息")]),t._v(" "),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.openSplitConfig}},[t._v("立即配置")])],1),t._v(" "),e("el-card",{staticClass:"action-card",attrs:{shadow:"never"}},[e("div",{staticClass:"action-header"},[e("div",{staticClass:"date-range"},[e("i",{staticClass:"el-icon-date"}),t._v("\n          "+t._s(t.formatBillCycleRange(t.currentBill.settlementCycle))+"\n        ")]),t._v(" "),e("div",{staticClass:"action-buttons"},[t.currentBill.billStatus===t.BILL_STATUS.PENDING_CONFIRM?e("el-button",{attrs:{type:"primary",loading:t.submitting},on:{click:t.handleConfirmBill}},[t._v("\n            确认账单\n          ")]):t.showInvoiceForm?[e("el-button",{on:{click:t.handleCancelConfirm}},[t._v("撤销确认")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.handleExportInvoiceInfo}},[t._v("导出开票信息")])]:t.currentBill.billStatus===t.BILL_STATUS.PENDING_PAYMENT?[e("el-tag",{attrs:{type:"success"}},[t._v("开票完成")])]:t._e(),t._v(" "),e("el-button",{attrs:{icon:"el-icon-folder-opened"},on:{click:t.handleDetailSettings}},[t._v("拆分汇总")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.handleExportExcel}},[t._v("导出全部Excel")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-download"},on:{click:t.handleExportPDF}},[t._v("导出全部PDF")])],2)])]),t._v(" "),t.showInvoiceForm?e("el-card",{staticClass:"tabs-card",attrs:{shadow:"never"}},[e("div",{staticClass:"invoice-apply-header"},[e("h3",{staticClass:"section-title"},[t._v("开票信息表")])]),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.invoiceFormLoading,expression:"invoiceFormLoading"}],staticClass:"invoice-apply-content"},[e("invoice-form",{ref:"invoiceForm",attrs:{"bill-no":t.billNo,"invoice-rows":t.invoiceRows,titles:t.invoiceTitles,"split-config":t.splitConfig},on:{update:t.handleInvoiceFormUpdate,cancel:t.handleCancelConfirmFromInvoice,submit:t.handleSubmitInvoice}})],1)]):e("el-card",{staticClass:"tabs-card",attrs:{shadow:"never"}},[e("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[t.currentBill.billStatus>=t.BILL_STATUS.INVOICING?e("el-tab-pane",{attrs:{label:"开票汇总",name:"invoice"}},[e("invoice-summary-content",{attrs:{"bill-no":t.billNo}})],1):t._e(),t._v(" "),t.currentBill.billStatus<t.BILL_STATUS.PENDING_PAYMENT?e("el-tab-pane",{attrs:{label:"账单汇总",name:"summary"}},[e("bill-summary-content",{attrs:{bill:t.currentBill}})],1):t._e(),t._v(" "),t.currentBill.billStatus<t.BILL_STATUS.PENDING_PAYMENT?e("el-tab-pane",{attrs:{label:"账单明细",name:"orders"}},[e("bill-orders-tab",{attrs:{"bill-no":t.billNo,"bill-status":t.currentBill.billStatus}})],1):t._e()],1)],1)],1):t._e(),t._v(" "),e("el-dialog",{attrs:{title:"确认账单",visible:t.confirmDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.confirmDialogVisible=e}}},[e("div",{staticClass:"confirm-dialog-content"},[e("p",{staticClass:"confirm-message"},[t._v("\n        是否确认 "),e("strong",[t._v(t._s(t.formatBillCycleRange(t.currentBill&&t.currentBill.settlementCycle)))]),t._v(" 账单金额无误？\n      ")]),t._v(" "),e("div",{staticClass:"confirm-amount"},[e("div",{staticClass:"amount-item"},[e("span",{staticClass:"label"},[t._v("账单总额：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.formatAmount(t.currentBill&&t.currentBill.totalAmount)))])]),t._v(" "),e("div",{staticClass:"amount-item"},[e("span",{staticClass:"label"},[t._v("订单数量：")]),t._v(" "),e("span",{staticClass:"value"},[t._v(t._s(t.billSummary&&t.billSummary.totalCount)+"笔")])])]),t._v(" "),e("p",{staticClass:"confirm-hint"},[t._v("确认后账单将进入开票流程，请仔细核对数据。")])]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.confirmDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary",loading:t.submitting},on:{click:t.confirmBillAction}},[t._v("确定")])],1)]),t._v(" "),e("el-dialog",{attrs:{title:"撤销确认",visible:t.cancelDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.cancelDialogVisible=e}}},[e("div",{staticClass:"confirm-dialog-content"},[e("p",{staticClass:"confirm-message"},[t._v("\n        撤销确认后，账单状态将回退到 "),e("strong",[t._v("待确认")]),t._v("，是否继续？\n      ")]),t._v(" "),e("p",{staticClass:"confirm-hint warn"},[t._v("此操作不可恢复，请谨慎操作。")])]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.cancelDialogVisible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"warning",loading:t.submitting},on:{click:t.cancelConfirmAction}},[t._v("确定")])],1)]),t._v(" "),e("invoice-split-config",{attrs:{"current-config":t.splitConfig},on:{save:t.handleSaveSplitConfig},model:{value:t.splitConfigVisible,callback:function(e){t.splitConfigVisible=e},expression:"splitConfigVisible"}})],1)}),[],!1,null,"c5a58808",null));e.default=N.exports},347:function(t,e,i){"use strict";i.r(e);var a=i(33),n=i(0),l=i(160),s=(i(161),{name:"BillList",data:()=>({filterForm:{dateRange:null,status:null,billNo:""},companyInfo:{id:"C001",name:"示例科技有限公司",fullName:"北京示例科技有限公司"}}),computed:{...Object(a.c)("bill",["billList","loading","pagination"]),billStatusNames:()=>n.BILL_STATUS_NAMES},created(){this.initDefaultDateRange(),this.loadBillList()},methods:{...Object(a.b)("bill",["fetchBillList"]),initDefaultDateRange(){const t=new Date,e=new Date;e.setMonth(e.getMonth()-3),this.filterForm.dateRange=[this.formatMonthString(e),this.formatMonthString(t)]},formatMonthString:t=>`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,async loadBillList(){const t={page:this.pagination.page,pageSize:this.pagination.pageSize};this.filterForm.dateRange&&2===this.filterForm.dateRange.length&&(t.startCycle=this.filterForm.dateRange[0],t.endCycle=this.filterForm.dateRange[1]),null!==this.filterForm.status&&void 0!==this.filterForm.status&&(t.status=this.filterForm.status),this.filterForm.billNo&&this.filterForm.billNo.trim()&&(t.billNo=this.filterForm.billNo.trim()),await this.fetchBillList(t)},handleSearch(){this.$store.commit("bill/SET_PAGINATION",{page:1}),this.loadBillList()},handleReset(){this.filterForm.status=null,this.filterForm.billNo="",this.initDefaultDateRange(),this.handleSearch()},handleRowClick(t){this.handleViewDetail(t)},handleViewDetail(t){this.$router.push({name:"BillDetail",params:{billNo:t.billNo}})},handleSizeChange(t){this.$store.commit("bill/SET_PAGINATION",{pageSize:t,page:1}),this.loadBillList()},handleCurrentChange(t){this.$store.commit("bill/SET_PAGINATION",{page:t}),this.loadBillList()},formatCycle:t=>Object(l.b)(t.settlementCycle,t),formatAmountValue:t=>Object(l.a)(t),formatDate:t=>Object(l.c)(t,"YYYY-MM-DD"),getBillStatusName:t=>n.BILL_STATUS_NAMES[t]||"-",getBillStatusType:t=>n.BILL_STATUS_COLORS[t]||""}}),o=(i(318),i(12)),r=Object(o.a)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bill-list-page"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("账单列表")]),t._v(" "),e("div",{staticClass:"company-info"},[e("span",{staticClass:"company-name"},[t._v(t._s(t.companyInfo.name))]),t._v(" "),e("span",{staticClass:"company-divider"},[t._v("|")]),t._v(" "),e("span",{staticClass:"company-id"},[t._v("企业ID: "+t._s(t.companyInfo.id))])])]),t._v(" "),e("el-card",{staticClass:"filter-card",attrs:{shadow:"never"}},[e("el-form",{attrs:{inline:!0,model:t.filterForm,size:"small","label-width":"80px"}},[e("el-form-item",{attrs:{label:"结算周期"}},[e("el-date-picker",{attrs:{type:"monthrange","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份",format:"yyyy-MM","value-format":"yyyy-MM"},on:{change:t.handleSearch},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"账单状态"}},[e("el-select",{attrs:{placeholder:"全部状态",clearable:""},on:{change:t.handleSearch},model:{value:t.filterForm.status,callback:function(e){t.$set(t.filterForm,"status",e)},expression:"filterForm.status"}},t._l(t.billStatusNames,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:parseInt(i)}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{label:"账单号"}},[e("el-input",{attrs:{placeholder:"请输入账单号",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.filterForm.billNo,callback:function(e){t.$set(t.filterForm,"billNo",e)},expression:"filterForm.billNo"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("\n          查询\n        ")]),t._v(" "),e("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.handleReset}},[t._v("\n          重置\n        ")])],1)],1)],1),t._v(" "),e("el-card",{staticClass:"table-card",attrs:{shadow:"never"}},[e("div",{staticClass:"table-header"},[e("div",{staticClass:"result-info"},[t._v("\n        共 "),e("span",{staticClass:"highlight"},[t._v(t._s(t.pagination.total))]),t._v(" 条账单\n      ")])]),t._v(" "),!t.loading&&t.billList.length>0?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"bill-table",staticStyle:{width:"100%"},attrs:{data:t.billList,border:""},on:{"row-click":t.handleRowClick}},[e("el-table-column",{attrs:{prop:"billNo",label:"账单号",width:"180",fixed:"left"}}),t._v(" "),e("el-table-column",{attrs:{prop:"settlementCycle",label:"结算周期",formatter:t.formatCycle}}),t._v(" "),e("el-table-column",{attrs:{prop:"billStatus",label:"账单状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tag",{attrs:{type:t.getBillStatusType(i.billStatus),size:"small"}},[t._v("\n            "+t._s(t.getBillStatusName(i.billStatus))+"\n          ")])]}}],null,!1,1790112285)}),t._v(" "),e("el-table-column",{attrs:{prop:"totalAmount",label:"账单总额",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("span",{staticClass:"amount-text"},[t._v(t._s(t.formatAmountValue(i.totalAmount)))])]}}],null,!1,3636474133)}),t._v(" "),e("el-table-column",{attrs:{prop:"invoicedAmount",label:"已开票金额",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("span",{staticClass:"amount-text"},[t._v(t._s(t.formatAmountValue(i.invoicedAmount||0)))])]}}],null,!1,2917599026)}),t._v(" "),e("el-table-column",{attrs:{prop:"pendingInvoiceAmount",label:"待开票金额",width:"140",align:"right"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("span",{staticClass:"amount-text"},[t._v(t._s(t.formatAmountValue(i.pendingInvoiceAmount||i.totalAmount)))])]}}],null,!1,2372410995)}),t._v(" "),e("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v("\n          "+t._s(t.formatDate(e.createTime))+"\n        ")]}}],null,!1,294772984)}),t._v(" "),e("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleViewDetail(i)}}},[t._v("\n            查看\n          ")])]}}],null,!1,3883020325)})],1):t._e(),t._v(" "),t.loading||0!==t.billList.length?t._e():e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),t._v(" "),e("p",[t._v("暂无账单数据")]),t._v(" "),e("p",{staticClass:"empty-hint"},[t._v("\n        "+t._s(t.filterForm.dateRange||null!==t.filterForm.status?"请尝试调整筛选条件":"还没有生成账单包")+"\n      ")])]),t._v(" "),!t.loading&&t.billList.length>0?e("div",{staticClass:"pagination-wrapper"},[e("el-pagination",{attrs:{"current-page":t.pagination.page,"page-size":t.pagination.pageSize,"page-sizes":[10,20,50,100],total:t.pagination.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)],1)}),[],!1,null,"f8f5f072",null);e.default=r.exports}}]);